(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    521269,      13075]
NotebookOptionsPosition[    516608,      12941]
NotebookOutlinePosition[    519724,      13029]
CellTagsIndexPosition[    519681,      13026]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"setenv", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"e_Integer", " ", "/;", " ", 
      RowBox[{"0", " ", "<=", " ", "e", " ", "<=", " ", "4"}]}], ",", " ", 
     RowBox[{"f_Integer", " ", "/;", " ", "\n", "     ", 
      RowBox[{"0", " ", "<=", " ", "f", " ", "<=", " ", "11"}]}]}], "}"}], 
   "]"}], " ", ":=", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"esizesize", ",", " ", "fsizesize"}], "}"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"e", ",", " ", "f"}], "}"}]}], ";", " ", "\n", "   ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"esizemax", ",", " ", "fsizemax"}], "}"}], " ", "=", " ", 
     RowBox[{"2", "^", 
      RowBox[{"{", 
       RowBox[{"e", ",", " ", "f"}], "}"}]}]}], ";", " ", 
    RowBox[{"utagsize", " ", "=", " ", 
     RowBox[{"1", " ", "+", " ", "f", " ", "+", " ", "e"}]}], ";", " ", "\n", 
    "   ", 
    RowBox[{"maxubits", " ", "=", " ", 
     RowBox[{
     "1", " ", "+", " ", "esizemax", " ", "+", " ", "fsizemax", " ", "+", " ",
       "utagsize"}]}], ";", " ", "\n", "   ", 
    RowBox[{"ubitmask", " ", "=", " ", 
     RowBox[{"BitShiftLeft", "[", 
      RowBox[{"1", ",", " ", 
       RowBox[{"utagsize", " ", "-", " ", "1"}]}], "]"}]}], ";", " ", "\n", 
    "   ", 
    RowBox[{"fsizemask", " ", "=", " ", 
     RowBox[{
      RowBox[{"BitShiftLeft", "[", 
       RowBox[{"1", ",", " ", "f"}], "]"}], " ", "-", " ", "1"}]}], ";", " ", 
    "\n", "   ", 
    RowBox[{"esizemask", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ubitmask", " ", "-", " ", "1"}], ")"}], " ", "-", " ", 
      "fsizemask"}]}], ";", " ", "\n", "   ", 
    RowBox[{"efsizemask", " ", "=", " ", 
     RowBox[{"BitOr", "[", 
      RowBox[{"esizemask", ",", " ", "fsizemask"}], "]"}]}], ";", " ", "\n", 
    "   ", 
    RowBox[{"utagmask", " ", "=", " ", 
     RowBox[{"BitOr", "[", 
      RowBox[{"ubitmask", ",", " ", "efsizemask"}], "]"}]}], ";", " ", "\n", 
    "   ", 
    RowBox[{"ulpu", " ", "=", " ", 
     RowBox[{"BitShiftLeft", "[", 
      RowBox[{"1", ",", " ", "utagsize"}], "]"}]}], ";", " ", 
    RowBox[{"smallsubnormalu", " ", "=", " ", "\n", "    ", 
     RowBox[{"efsizemask", " ", "+", " ", "ulpu"}]}], ";", " ", 
    RowBox[{"smallnormalu", " ", "=", " ", "\n", "    ", 
     RowBox[{"efsizemask", " ", "+", " ", 
      RowBox[{"BitShiftLeft", "[", 
       RowBox[{"1", ",", " ", 
        RowBox[{"maxubits", " ", "-", " ", "1", " ", "-", " ", "esizemax"}]}],
        "]"}]}]}], ";", " ", "\n", "   ", 
    RowBox[{"signbigu", " ", "=", " ", 
     RowBox[{"BitShiftLeft", "[", 
      RowBox[{"1", ",", " ", 
       RowBox[{"maxubits", " ", "-", " ", "1"}]}], "]"}]}], ";", " ", "\n", 
    "   ", 
    RowBox[{"posinfu", " ", "=", " ", 
     RowBox[{"signbigu", " ", "-", " ", "1", " ", "-", " ", "ubitmask"}]}], 
    ";", " ", "\n", "   ", 
    RowBox[{"maxrealu", " ", "=", " ", 
     RowBox[{"posinfu", " ", "-", " ", "ulpu"}]}], ";", " ", 
    RowBox[{"minrealu", " ", "=", " ", 
     RowBox[{"maxrealu", " ", "+", " ", "signbigu"}]}], ";", " ", "\n", "   ", 
    RowBox[{"neginfu", " ", "=", " ", 
     RowBox[{"posinfu", " ", "+", " ", "signbigu"}]}], ";", " ", 
    RowBox[{"negbigu", " ", "=", " ", 
     RowBox[{"neginfu", " ", "-", " ", "ulpu"}]}], ";", " ", "\n", "   ", 
    RowBox[{"qNaNu", " ", "=", " ", 
     RowBox[{"posinfu", " ", "+", " ", "ubitmask"}]}], ";", " ", 
    RowBox[{"sNaNu", " ", "=", " ", 
     RowBox[{"neginfu", " ", "+", " ", "ubitmask"}]}], ";", " ", "\n", "   ", 
    
    RowBox[{"negopeninfu", " ", "=", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"utagsize", " ", "==", " ", "1"}], ",", " ", "13", ",", " ", 
       RowBox[{"BitShiftLeft", "[", 
        RowBox[{"15", ",", " ", "\n", "      ", 
         RowBox[{"utagsize", " ", "-", " ", "1"}]}], "]"}]}], "]"}]}], ";", 
    " ", 
    RowBox[{"posopeninfu", " ", "=", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"utagsize", " ", "==", " ", "1"}], ",", " ", "5", ",", " ", 
       "\n", "     ", 
       RowBox[{"BitShiftLeft", "[", 
        RowBox[{"7", ",", " ", 
         RowBox[{"utagsize", " ", "-", " ", "1"}]}], "]"}]}], "]"}]}], ";", 
    " ", 
    RowBox[{"negopenzerou", " ", "=", " ", "\n", "    ", 
     RowBox[{"BitShiftLeft", "[", 
      RowBox[{"9", ",", " ", 
       RowBox[{"utagsize", " ", "-", " ", "1"}]}], "]"}]}], ";", " ", "\n", 
    "   ", 
    RowBox[{"maxreal", " ", "=", " ", 
     RowBox[{
      RowBox[{"2", "^", 
       RowBox[{"2", "^", 
        RowBox[{"(", 
         RowBox[{"esizemax", " ", "-", " ", "1"}], ")"}]}]}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "^", "fsizemax"}], " ", "-", " ", "1"}], ")"}], "/", 
        "\n", "      ", 
        RowBox[{"2", "^", 
         RowBox[{"(", 
          RowBox[{"fsizemax", " ", "-", " ", "1"}], ")"}]}]}], ")"}]}]}], ";",
     " ", 
    RowBox[{"smallsubnormal", " ", "=", " ", "\n", "    ", 
     RowBox[{"2", "^", 
      RowBox[{"(", 
       RowBox[{"2", " ", "-", " ", 
        RowBox[{"2", "^", 
         RowBox[{"(", 
          RowBox[{"esizemax", " ", "-", " ", "1"}], ")"}]}], " ", "-", " ", 
        "fsizemax"}], ")"}]}]}], ";"}], " ", ")"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"setenv", "[", 
    RowBox[{"{", 
     RowBox[{"3", ",", " ", "4"}], "}"}], "]"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gogreen", " ", "=", " ", 
    RowBox[{"RGBColor", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0.75", ",", " ", "0.625"}], "}"}], "]"}]}], 
   ";"}], " "}], "\n", 
 RowBox[{"  ", 
  RowBox[{
   RowBox[{"cautionamber", " ", "=", " ", 
    RowBox[{"RGBColor", "[", 
     RowBox[{"{", 
      RowBox[{"0.96", ",", " ", "0.72", ",", " ", "0"}], "}"}], "]"}]}], 
   ";"}], " "}], "\n", 
 RowBox[{"  ", 
  RowBox[{
   RowBox[{"stopred", " ", "=", " ", 
    RowBox[{"RGBColor", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "0.125", ",", " ", "0"}], "}"}], "]"}]}], ";"}], 
  " "}], "\n", 
 RowBox[{"  ", 
  RowBox[{
   RowBox[{"brightblue", " ", "=", " ", 
    RowBox[{"RGBColor", "[", 
     RowBox[{"{", 
      RowBox[{"0.25", ",", " ", "0.5", ",", " ", "1"}], "}"}], "]"}]}], ";"}],
   " "}], "\n", 
 RowBox[{"  ", 
  RowBox[{
   RowBox[{"sanegreen", " ", "=", " ", 
    RowBox[{"RGBColor", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0.75", ",", " ", "0"}], "}"}], "]"}]}], ";"}], 
  " "}], "\n", 
 RowBox[{"  ", 
  RowBox[{
   RowBox[{"paleblue", " ", "=", " ", 
    RowBox[{"RGBColor", "[", 
     RowBox[{"{", 
      RowBox[{"0.9", ",", " ", "0.9", ",", " ", "1"}], "}"}], "]"}]}], ";"}], 
  " "}], "\n", 
 RowBox[{"  ", 
  RowBox[{
   RowBox[{"brightpurple", " ", "=", " ", 
    RowBox[{"RGBColor", "[", 
     RowBox[{"{", 
      RowBox[{"0.75", ",", " ", "0.5", ",", " ", "1"}], "}"}], "]"}]}], ";"}],
   " "}], "\n", 
 RowBox[{"  ", 
  RowBox[{
   RowBox[{"brightmagenta", " ", "=", " ", 
    RowBox[{"RGBColor", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "0.25", ",", " ", "1"}], "}"}], "]"}]}], ";"}], 
  " "}], "\n", 
 RowBox[{"  ", 
  RowBox[{
   RowBox[{"textamber", " ", "=", " ", 
    RowBox[{"RGBColor", "[", 
     RowBox[{"{", 
      RowBox[{"0.75", ",", " ", "0.5", ",", " ", "0"}], "}"}], "]"}]}], ";"}],
   " "}], "\n", 
 RowBox[{"  ", 
  RowBox[{
   RowBox[{"chartreuse", " ", "=", " ", 
    RowBox[{"RGBColor", "[", 
     RowBox[{"{", 
      RowBox[{"0.875", ",", " ", "1", ",", " ", "0.5"}], "}"}], "]"}]}], 
   ";"}], " "}], "\n", 
 RowBox[{"  ", 
  RowBox[{
   RowBox[{"utagview", "[", "u_Integer", "]"}], " ", ":=", " ", "\n", "   ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"e", " ", "=", " ", 
        RowBox[{"BitShiftRight", "[", 
         RowBox[{
          RowBox[{"BitAnd", "[", 
           RowBox[{"u", ",", " ", "esizemask"}], "]"}], ",", " ", 
          "fsizesize"}], "]"}]}], ",", " ", "\n", "     ", 
       RowBox[{"f", " ", "=", " ", 
        RowBox[{"BitAnd", "[", 
         RowBox[{"u", ",", " ", "fsizemask"}], "]"}]}], ",", " ", 
       RowBox[{"i", " ", "=", " ", 
        RowBox[{"BitShiftRight", "[", 
         RowBox[{"u", ",", " ", "\n", "       ", 
          RowBox[{"utagsize", " ", "-", " ", "1"}]}], "]"}]}]}], "}"}], ",", 
     " ", 
     RowBox[{"Grid", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"i", ",", " ", "Magenta", ",", " ", "\"\<Input\>\""}], 
            "]"}], ",", " ", "\n", "       ", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"IntegerString", "[", 
              RowBox[{"e", ",", " ", "2", ",", " ", "esizesize"}], "]"}], ",",
              " ", "sanegreen", ",", " ", "\n", "        ", "\"\<Input\>\""}],
             "]"}], ",", " ", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"IntegerString", "[", 
              RowBox[{"f", ",", " ", "2", ",", " ", "fsizesize"}], "]"}], ",",
              " ", "\n", "        ", 
             RowBox[{"FontColor", " ", "->", " ", "Gray"}], ",", " ", 
             "\"\<Input\>\""}], "]"}]}], "}"}], ",", " ", "\n", "      ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", " ", "==", " ", "1"}], ",", " ", 
             "\"\<\[NegativeThinSpace]\[CenterEllipsis]\>\"", ",", " ", 
             "\"\<\[DownArrow]\>\""}], "]"}], ",", " ", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"e", " ", "+", " ", "1"}], ",", " ", "\"\<Text\>\""}], 
            "]"}], ",", " ", "\n", "       ", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"f", " ", "+", " ", "1"}], ",", " ", "\"\<Text\>\""}], 
            "]"}]}], "}"}]}], "}"}], ",", " ", 
       RowBox[{"Frame", " ", "->", " ", 
        RowBox[{"{", 
         RowBox[{"None", ",", " ", "None", ",", " ", "\n", "       ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", " ", "1"}], "}"}], " ", "->", " ", "True"}], 
            ",", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", " ", "2"}], "}"}], " ", "->", " ", "True"}], 
            ",", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", " ", "3"}], "}"}], " ", "->", " ", "True"}]}],
            "}"}]}], "}"}]}]}], "]"}]}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"unumQ", "[", "x_", "]"}], " ", ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"IntegerQ", "[", "x", "]"}], ",", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"x", " ", ">=", " ", "0"}], " ", "&&", " ", 
       RowBox[{"x", " ", "<=", " ", "sNaNu"}]}], ",", " ", "True", ",", " ", 
      "\n", "    ", "False"}], "]"}], ",", " ", "False"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"fsizeminus1", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"BitAnd", "[", 
   RowBox[{"u", ",", " ", "fsizemask"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"fsize", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"1", " ", "+", " ", 
   RowBox[{"fsizeminus1", "[", "u", "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"esizeminus1", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"BitShiftRight", "[", "\n", "   ", 
   RowBox[{
    RowBox[{"BitAnd", "[", 
     RowBox[{"u", ",", " ", "esizemask"}], "]"}], ",", " ", "fsizesize"}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"esize", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"1", " ", "+", " ", 
   RowBox[{"esizeminus1", "[", "u", "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"utag", "[", 
   RowBox[{
    RowBox[{"esize_Integer", " ", "/;", " ", 
     RowBox[{"1", " ", "<=", " ", "esize", " ", "<=", " ", "esizemax"}]}], 
    ",", " ", "\n", "   ", 
    RowBox[{"fsize_Integer", " ", "/;", " ", 
     RowBox[{"1", " ", "<=", " ", "fsize", " ", "<=", " ", "fsizemax"}]}]}], 
   "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"BitOr", "[", 
   RowBox[{
    RowBox[{"fsize", " ", "-", " ", "1"}], ",", " ", 
    RowBox[{"BitShiftLeft", "[", 
     RowBox[{
      RowBox[{"esize", " ", "-", " ", "1"}], ",", " ", "fsizesize"}], "]"}]}],
    "]"}]}], "\n", 
 RowBox[{
  RowBox[{"numbits", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"1", " ", "+", " ", 
   RowBox[{"esize", "[", "u", "]"}], " ", "+", " ", 
   RowBox[{"fsize", "[", "u", "]"}], " ", "+", " ", "utagsize"}]}], "\n", 
 RowBox[{
  RowBox[{"signmask", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"BitShiftLeft", "[", 
   RowBox[{"1", ",", " ", 
    RowBox[{
     RowBox[{"numbits", "[", "u", "]"}], " ", "-", " ", "1"}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"hiddenmask", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"BitShiftLeft", "[", 
   RowBox[{"1", ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{"fsize", "[", "u", "]"}], " ", "+", " ", "utagsize"}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"fracmask", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"BitShiftLeft", "[", "\n", "   ", 
   RowBox[{
    RowBox[{
     RowBox[{"BitShiftLeft", "[", 
      RowBox[{"1", ",", " ", 
       RowBox[{"fsize", "[", "u", "]"}]}], "]"}], " ", "-", " ", "1"}], ",", 
    " ", "utagsize"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"expomask", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"BitShiftLeft", "[", "\n", "   ", 
   RowBox[{
    RowBox[{
     RowBox[{"BitShiftLeft", "[", 
      RowBox[{"1", ",", " ", 
       RowBox[{"esize", "[", "u", "]"}]}], "]"}], " ", "-", " ", "1"}], ",", 
    " ", 
    RowBox[{
     RowBox[{"fsize", "[", "u", "]"}], " ", "+", " ", "utagsize"}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"floatmask", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"signmask", "[", "u", "]"}], " ", "+", " ", 
   RowBox[{"expomask", "[", "u", "]"}], " ", "+", " ", "\n", "   ", 
   RowBox[{"fracmask", "[", "u", "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"bias", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"2", "^", 
    RowBox[{"esizeminus1", "[", "u", "]"}]}], " ", "-", " ", "1"}]}], "\n", 
 RowBox[{
  RowBox[{"sign", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Boole", "[", 
   RowBox[{
    RowBox[{"BitAnd", "[", 
     RowBox[{"u", ",", " ", 
      RowBox[{"signmask", "[", "u", "]"}]}], "]"}], " ", ">", " ", "0"}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"expo", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"BitShiftRight", "[", 
   RowBox[{
    RowBox[{"BitAnd", "[", 
     RowBox[{"u", ",", " ", 
      RowBox[{"expomask", "[", "u", "]"}]}], "]"}], ",", " ", "\n", "   ", 
    RowBox[{"utagsize", " ", "+", " ", 
     RowBox[{"fsize", "[", "u", "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"hidden", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Boole", "[", 
   RowBox[{
    RowBox[{"expo", "[", "u", "]"}], " ", ">", " ", "0"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"frac", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"BitShiftRight", "[", 
   RowBox[{
    RowBox[{"BitAnd", "[", 
     RowBox[{"u", ",", " ", 
      RowBox[{"fracmask", "[", "u", "]"}]}], "]"}], ",", " ", "\n", "   ", 
    "utagsize"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"inexQ", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"BitAnd", "[", 
    RowBox[{"ubitmask", ",", " ", "u"}], "]"}], " ", ">", " ", 
   "0"}]}], "\n", 
 RowBox[{
  RowBox[{"exQ", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"BitAnd", "[", 
    RowBox[{"ubitmask", ",", " ", "u"}], "]"}], " ", "==", " ", "0"}]}], "\n", 
 RowBox[{
  RowBox[{"exact", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"inexQ", "[", "u", "]"}], ",", " ", 
    RowBox[{"BitXor", "[", 
     RowBox[{"u", ",", " ", "ubitmask"}], "]"}], ",", " ", "u"}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"colorcode", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Row", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"sign", "[", "u", "]"}], ",", " ", "Red", ",", " ", "Bold"}], 
      "]"}], ",", " ", "\n", "    ", "\"\<\[ThinSpace]\>\"", ",", " ", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"expo", "[", "u", "]"}], ",", " ", "2", ",", " ", 
         RowBox[{"esize", "[", "u", "]"}]}], "]"}], ",", " ", "\n", "     ", 
       "brightblue", ",", " ", "Bold"}], "]"}], ",", " ", 
     "\"\<\[ThinSpace]\>\"", ",", " ", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"frac", "[", "u", "]"}], ",", " ", "2", ",", " ", "\n", 
         "      ", 
         RowBox[{"fsize", "[", "u", "]"}]}], "]"}], ",", " ", "Bold"}], "]"}],
      ",", " ", "\"\<\[ThinSpace]\>\"", ",", " ", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Boole", "[", 
        RowBox[{"inexQ", "[", "u", "]"}], "]"}], ",", " ", "Magenta"}], "]"}],
      ",", " ", "\n", "    ", "\"\<\[ThinSpace]\>\"", ",", " ", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"esizeminus1", "[", "u", "]"}], ",", " ", "2", ",", " ", 
         "esizesize"}], "]"}], ",", " ", "\n", "     ", "sanegreen"}], "]"}], 
     ",", " ", "\"\<\[ThinSpace]\>\"", ",", " ", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"fsizeminus1", "[", "u", "]"}], ",", " ", "2", ",", " ", 
         "\n", "      ", "fsizesize"}], "]"}], ",", " ", "Gray"}], "]"}]}], 
    "}"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"expovalue", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"expo", "[", "u", "]"}], " ", "-", " ", 
   RowBox[{"bias", "[", "u", "]"}], " ", "+", " ", "1", " ", "-", " ", 
   RowBox[{"hidden", "[", "u", "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"u2f", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{
     RowBox[{"unumQ", "[", "u", "]"}], " ", "&&", " ", 
     RowBox[{"exQ", "[", "u", "]"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Which", "[", 
   RowBox[{
    RowBox[{"u", " ", "==", " ", "posinfu"}], ",", " ", "\n", "   ", 
    RowBox[{"Plus", "[", "Infinity", "]"}], ",", " ", 
    RowBox[{"u", " ", "==", " ", "neginfu"}], ",", " ", 
    RowBox[{"-", "Infinity"}], ",", " ", "True", ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "^", 
      RowBox[{"sign", "[", "u", "]"}]}], "*", 
     RowBox[{"2", "^", 
      RowBox[{"expovalue", "[", "u", "]"}]}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"hidden", "[", "u", "]"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"frac", "[", "u", "]"}], "/", 
        RowBox[{"2", "^", 
         RowBox[{"fsize", "[", "u", "]"}]}]}]}], ")"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"bigu", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"expomask", "[", "u", "]"}], " ", "+", " ", 
   RowBox[{"fracmask", "[", "u", "]"}], " ", "+", " ", "\n", "   ", 
   RowBox[{"BitAnd", "[", 
    RowBox[{"efsizemask", ",", " ", "u"}], "]"}], " ", "-", " ", "\n", "   ", 
   
   RowBox[{"ulpu", "*", 
    RowBox[{"Boole", "[", 
     RowBox[{
      RowBox[{"BitAnd", "[", 
       RowBox[{"u", ",", " ", "efsizemask"}], "]"}], " ", "==", " ", 
      "efsizemask"}], "]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"big", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"u2f", "[", 
   RowBox[{"bigu", "[", "u", "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"open", ",", " ", "closed"}], "}"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"True", ",", " ", "False"}], "}"}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NaN", " ", "=", " ", "Indeterminate"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{"floatQ", "[", "x_", "]"}], " ", ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"NumericQ", "[", "x", "]"}], ",", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Head", "[", "x", "]"}], " ", "=!=", " ", "Complex"}], ",", 
      " ", "True", ",", " ", "\n", "    ", "False"}], "]"}], ",", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"x", " ", "===", " ", "Infinity"}], " ", "||", " ", 
       RowBox[{"x", " ", "===", " ", 
        RowBox[{"-", "Infinity"}]}], " ", "||", " ", 
       RowBox[{"x", " ", "===", " ", "NaN"}]}], ",", " ", "\n", "    ", 
      "True", ",", " ", "False"}], "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"gQ", "[", "x_", "]"}], " ", ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Head", "[", "x", "]"}], " ", "===", " ", "List"}], ",", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "x", "]"}], " ", "==", " ", "2"}], ",", " ", 
      "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", 
          RowBox[{"x", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "===", " ", "List"}], 
        ",", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"x", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "==", " ", "2"}], 
          ",", " ", "\n", "      ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", 
              RowBox[{"x", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], " ", "===", " ", 
             "List"}], ",", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"x", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], " ", "==", " ", "2"}],
               ",", " ", "\n", "        ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Element", "[", 
                  RowBox[{
                   RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", 
                   "Booleans"}], "]"}], " ", "&&", " ", 
                 RowBox[{"Element", "[", 
                  RowBox[{
                   RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", " ", "\n", 
                   "           ", "Booleans"}], "]"}], " ", "&&", " ", 
                 RowBox[{"floatQ", "[", 
                  RowBox[{"x", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], " ", "&&", 
                 " ", 
                 RowBox[{"floatQ", "[", 
                  RowBox[{"x", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ",", " ", 
                "\n", "         ", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "===", " ", 
                    "NaN"}], " ", "||", " ", 
                   RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "===", " ", 
                    "NaN"}]}], ",", " ", "True", ",", " ", "\n", "          ", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "==", " ", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", "&&", "  ", 
                    
                    RowBox[{"!", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], " ", "&&", " ", 
                    "\n", "              ", 
                    RowBox[{"!", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ")"}], " ", "||",
                     " ", 
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "<", " ", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ",", " ", 
                    "True", ",", " ", "False"}], "]"}], ",", " ", "\n", 
                  "          ", "False"}], "]"}], ",", " ", "False"}], "]"}], 
              ",", " ", "False"}], "]"}], ",", " ", "False"}], "]"}], ",", 
          " ", "False"}], "]"}], ",", " ", "False"}], "]"}], ",", " ", "\n", 
      "    ", "False"}], "]"}], ",", " ", "False"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"uboundQ", "[", "x_", "]"}], " ", ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Head", "[", "x", "]"}], " ", "===", " ", "List"}], ",", " ", 
    "\n", "   ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "x", "]"}], " ", "==", " ", "1"}], " ", "||", 
       " ", 
       RowBox[{
        RowBox[{"Length", "[", "x", "]"}], " ", "==", " ", "2"}]}], ",", " ", 
      "\n", "    ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xL", " ", "=", " ", 
           RowBox[{"x", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
          RowBox[{"xR", " ", "=", " ", 
           RowBox[{"x", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], ",", " ", "gL", ",", " ", 
          "gR"}], "}"}], ",", " ", "\n", "     ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"unumQ", "[", "xL", "]"}], " ", "&&", " ", 
           RowBox[{"unumQ", "[", "xR", "]"}]}], ",", " ", "\n", "      ", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"gL", ",", " ", "gR"}], "}"}], " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"unum2g", "[", "xL", "]"}], ",", " ", 
              RowBox[{"unum2g", "[", "xR", "]"}]}], "}"}]}], ";", " ", "\n", 
           "       ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "x", "]"}], " ", "==", " ", "1"}], " ", 
              "||", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"xL", " ", "==", " ", "qNaNu"}], " ", "||", " ", 
                RowBox[{"xL", " ", "==", " ", "sNaNu"}], " ", "||", " ", "\n",
                 "          ", 
                RowBox[{"xR", " ", "==", " ", "qNaNu"}], " ", "||", " ", 
                RowBox[{"xR", " ", "==", " ", "sNaNu"}]}], ")"}], " ", "||", 
              " ", "\n", "         ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"gL", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "<", " ", 
                 RowBox[{"gR", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", "||", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"gL", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "==", " ", 
                   RowBox[{"gR", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", "&&", " ", 
                  "\n", "           ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"exQ", "[", "xL", "]"}], " ", "&&", " ", 
                    RowBox[{"exQ", "[", "xR", "]"}]}], ")"}]}], ")"}]}], 
               ")"}]}], ",", " ", "True", ",", " ", "False"}], "]"}]}], ",", 
          " ", "False"}], "]"}]}], "]"}], ",", " ", "\n", "    ", "False"}], 
     "]"}], ",", " ", "False"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"uboundpairQ", "[", "x_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"uboundQ", "[", "x", "]"}], " ", "&&", " ", 
   RowBox[{
    RowBox[{"Length", "[", "x", "]"}], " ", "==", " ", "2"}]}]}], "\n", 
 RowBox[{
  RowBox[{"uQ", "[", "x_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"unumQ", "[", "x", "]"}], " ", "||", " ", 
   RowBox[{"uboundQ", "[", "x", "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"f2g", "[", 
   RowBox[{"x_", " ", "/;", " ", 
    RowBox[{"floatQ", "[", "x", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"x", " ", "===", " ", "NaN"}], ",", " ", "\n", "   ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"NaN", ",", " ", "NaN"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", " ", "x"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"closed", ",", " ", "closed"}], "}"}]}], "}"}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"unum2g", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"u", " ", "==", " ", "qNaNu"}], " ", "||", " ", 
     RowBox[{"u", " ", "==", " ", "sNaNu"}]}], ",", " ", "\n", "   ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"NaN", ",", " ", "NaN"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], ",", " ", "\n", 
    "   ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", " ", "=", " ", 
         RowBox[{"u2f", "[", 
          RowBox[{"exact", "[", "u", "]"}], "]"}]}], ",", " ", 
        RowBox[{"y", " ", "=", " ", 
         RowBox[{"u2f", "[", 
          RowBox[{
           RowBox[{"exact", "[", "u", "]"}], " ", "+", " ", "ulpu"}], 
          "]"}]}]}], "}"}], ",", " ", "\n", "    ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"exQ", "[", "u", "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", " ", "x"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"closed", ",", " ", "closed"}], "}"}]}], "}"}], ",", " ", 
        "\n", "     ", 
        RowBox[{"u", " ", "==", " ", 
         RowBox[{
          RowBox[{"bigu", "[", "u", "]"}], " ", "+", " ", "ubitmask"}]}], ",",
         " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"big", "[", "u", "]"}], ",", " ", "Infinity"}], "}"}], 
          ",", " ", "\n", "      ", 
          RowBox[{"{", 
           RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], ",", " ", 
        RowBox[{"u", " ", "==", " ", 
         RowBox[{
          RowBox[{"signmask", "[", "u", "]"}], " ", "+", " ", 
          RowBox[{"bigu", "[", "u", "]"}], " ", "+", " ", "ubitmask"}]}], ",",
         " ", "\n", "     ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "Infinity"}], ",", " ", 
            RowBox[{"-", 
             RowBox[{"big", "[", "u", "]"}]}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], ",", " ", 
        RowBox[{
         RowBox[{"sign", "[", "u", "]"}], " ", "==", " ", "1"}], ",", " ", 
        "\n", "     ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"y", ",", " ", "x"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], ",", " ", 
        "True", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", " ", "y"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}]}], "]"}]}], 
     "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ubound2g", "[", 
   RowBox[{"ub_", " ", "/;", " ", 
    RowBox[{"uboundQ", "[", "ub", "]"}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gL", ",", " ", "gR", ",", " ", 
      RowBox[{"uL", " ", "=", " ", 
       RowBox[{"ub", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
      RowBox[{"uR", " ", "=", " ", 
       RowBox[{"ub", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}]}]}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"uL", " ", "==", " ", "qNaNu"}], " ", "||", " ", 
       RowBox[{"uL", " ", "==", " ", "sNaNu"}], " ", "||", " ", 
       RowBox[{"uR", " ", "==", " ", "qNaNu"}], " ", "||", " ", 
       RowBox[{"uR", " ", "==", " ", "sNaNu"}]}], ",", " ", "\n", "    ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"NaN", ",", " ", "NaN"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], ",", " ", "\n", 
      "    ", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"gL", ",", " ", "gR"}], "}"}], " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"unum2g", "[", "uL", "]"}], ",", " ", 
          RowBox[{"unum2g", "[", "uR", "]"}]}], "}"}]}], ";", " ", "\n", 
       "     ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"gL", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
           RowBox[{"gR", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"gL", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", 
           RowBox[{"gR", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}]}], "}"}]}]}], 
     "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"u2g", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"uQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"unumQ", "[", "u", "]"}], ",", " ", 
    RowBox[{"unum2g", "[", "u", "]"}], ",", " ", 
    RowBox[{"ubound2g", "[", "u", "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"x2u", "[", 
   RowBox[{"x_", " ", "/;", " ", 
    RowBox[{"floatQ", "[", "x", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Which", "[", 
   RowBox[{
    RowBox[{"x", " ", "===", " ", "NaN"}], ",", " ", "qNaNu", ",", " ", "\n", 
    "   ", 
    RowBox[{"x", " ", "==", " ", 
     RowBox[{"Plus", "[", "Infinity", "]"}]}], ",", " ", "posinfu", ",", " ", 
    
    RowBox[{"x", " ", "==", " ", 
     RowBox[{"-", "Infinity"}]}], ",", " ", "neginfu", ",", " ", "\n", "   ", 
    
    RowBox[{
     RowBox[{"Abs", "[", "x", "]"}], " ", ">", " ", "maxreal"}], ",", " ", 
    RowBox[{
    "maxrealu", " ", "+", " ", "ubitmask", " ", "+", " ", "\n", "    ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"x", " ", "<", " ", "0"}], ",", " ", "signbigu", ",", " ", 
       "0"}], "]"}]}], ",", " ", 
    RowBox[{"x", " ", "==", " ", "0"}], ",", " ", "0", ",", " ", 
    RowBox[{
     RowBox[{"Abs", "[", "x", "]"}], " ", "<", " ", "smallsubnormal"}], ",", 
    " ", "\n", "   ", 
    RowBox[{"utagmask", " ", "+", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"x", " ", "<", " ", "0"}], ",", " ", "signbigu", ",", " ", 
       "0"}], "]"}]}], ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{"Abs", "[", "x", "]"}], " ", "<", " ", 
     RowBox[{"u2f", "[", "smallnormalu", "]"}]}], ",", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "y", "}"}], ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"y", " ", "=", " ", 
        RowBox[{
         RowBox[{"Abs", "[", "x", "]"}], "/", "smallsubnormal"}]}], ";", " ", 
       
       RowBox[{"y", " ", "=", " ", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"x", " ", "<", " ", "0"}], ",", " ", "signbigu", ",", " ", 
           "0"}], "]"}], " ", "+", " ", "\n", "       ", "efsizemask", " ", 
         "+", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"y", " ", "!=", " ", 
            RowBox[{"Floor", "[", "y", "]"}]}], ",", " ", "ubitmask", ",", 
           " ", "0"}], "]"}], " ", "+", " ", "\n", "       ", 
         RowBox[{"BitShiftLeft", "[", 
          RowBox[{
           RowBox[{"Floor", "[", "y", "]"}], ",", " ", "utagsize"}], 
          "]"}]}]}], ";", " ", "\n", "     ", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"BitAnd", "[", 
           RowBox[{
            RowBox[{"BitShiftLeft", "[", 
             RowBox[{"3", ",", " ", 
              RowBox[{"utagsize", " ", "-", " ", "1"}]}], "]"}], ",", " ", 
            "y"}], "]"}], " ", "==", " ", "0"}], ",", " ", "\n", "      ", 
         RowBox[{"y", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"y", " ", "-", " ", 
              RowBox[{"BitAnd", "[", 
               RowBox[{"efsizemask", ",", " ", "y"}], "]"}]}], ")"}], "/", 
            "2"}], " ", "+", " ", 
           RowBox[{"BitAnd", "[", 
            RowBox[{"efsizemask", ",", " ", "\n", "         ", "y"}], "]"}], 
           " ", "-", " ", "1"}]}]}], "]"}], ";", " ", "y"}]}], "]"}], ",", 
    " ", "True", ",", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", " ", "=", " ", "0"}], ",", " ", "y", ",", " ", "z"}], 
       "}"}], ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"y", " ", "=", " ", 
        RowBox[{
         RowBox[{"Abs", "[", "x", "]"}], "/", 
         RowBox[{"2", "^", 
          RowBox[{"scale", "[", "x", "]"}]}]}]}], ";", " ", 
       RowBox[{"n", " ", "=", " ", "0"}], ";", " ", "\n", "     ", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Floor", "[", "y", "]"}], " ", "!=", " ", "y"}], " ", "&&",
           " ", 
          RowBox[{"n", " ", "<", " ", "fsizemax"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"n", "++"}], ",", " ", 
           RowBox[{"y", " ", "*=", " ", "2"}]}], "}"}]}], "]"}], ";", " ", 
       "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"y", " ", "==", " ", 
          RowBox[{"Floor", "[", "y", "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{"y", " ", "=", " ", 
           RowBox[{"n", " ", "-", " ", 
            RowBox[{"Boole", "[", 
             RowBox[{"n", " ", ">", " ", "0"}], "]"}], " ", "+", " ", "\n", 
            "         ", 
            RowBox[{"BitShiftLeft", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ne", "[", "x", "]"}], " ", "-", " ", "1"}], ",", " ", 
              "fsizesize"}], "]"}], " ", "+", " ", "\n", "         ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"n", " ", "==", " ", "0"}], ",", " ", "0", ",", " ", 
              RowBox[{"BitShiftLeft", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Floor", "[", "y", "]"}], " ", "-", " ", 
                 RowBox[{"2", "^", 
                  RowBox[{"scale", "[", "y", "]"}]}]}], ",", " ", "\n", 
                "           ", "utagsize"}], "]"}]}], "]"}], " ", "+", " ", 
            RowBox[{"BitShiftLeft", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"scale", "[", "x", "]"}], " ", "+", " ", 
               RowBox[{"2", "^", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ne", "[", "x", "]"}], " ", "-", " ", "1"}], 
                 ")"}]}], " ", "-", " ", "\n", "           ", "1"}], ",", " ", 
              RowBox[{"utagsize", " ", "+", " ", "n", " ", "+", " ", 
               RowBox[{"Boole", "[", 
                RowBox[{"n", " ", "==", " ", "0"}], "]"}]}]}], "]"}], " ", 
            "+", " ", "\n", "         ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"x", " ", "<", " ", "0"}], ",", " ", 
              RowBox[{"BitShiftLeft", "[", 
               RowBox[{"1", ",", " ", 
                RowBox[{
                "utagsize", " ", "+", " ", "n", " ", "+", " ", "\n", 
                 "            ", 
                 RowBox[{"Boole", "[", 
                  RowBox[{"n", " ", "==", " ", "0"}], "]"}], " ", "+", " ", 
                 RowBox[{"ne", "[", "x", "]"}]}]}], "]"}], ",", " ", "0"}], 
             "]"}]}]}], ";", " ", "\n", "       ", 
          RowBox[{"z", " ", "=", " ", 
           RowBox[{"Log", "[", 
            RowBox[{"2", ",", " ", 
             RowBox[{"1", " ", "-", " ", 
              RowBox[{"Log", "[", 
               RowBox[{"2", ",", " ", 
                RowBox[{"Abs", "[", "x", "]"}]}], "]"}]}]}], "]"}]}], ";", 
          " ", "\n", "       ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"IntegerQ", "[", "z", "]"}], " ", "&&", " ", 
             RowBox[{"z", " ", ">=", " ", "0"}]}], ",", " ", 
            RowBox[{
             RowBox[{"BitShiftLeft", "[", 
              RowBox[{"z", ",", " ", "fsizesize"}], "]"}], " ", "+", " ", 
             "\n", "         ", "ulpu", " ", "+", " ", 
             RowBox[{
              RowBox[{"Boole", "[", 
               RowBox[{"x", " ", "<", " ", "0"}], "]"}], "*", 
              RowBox[{"signmask", "[", 
               RowBox[{"BitShiftLeft", "[", 
                RowBox[{"z", ",", " ", "\n", "            ", "fsizesize"}], 
                "]"}], "]"}]}]}], ",", " ", "y"}], "]"}]}], ",", " ", "\n", 
         "      ", 
         RowBox[{
          RowBox[{"z", " ", "=", " ", 
           RowBox[{
            RowBox[{"Ceiling", "[", 
             RowBox[{
              RowBox[{"Abs", "[", "x", "]"}], "/", 
              RowBox[{"2", "^", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"scale", "[", "x", "]"}], " ", "-", " ", 
                 "fsizemax"}], ")"}]}]}], "]"}], "*", "\n", "         ", 
            RowBox[{"2", "^", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"scale", "[", "x", "]"}], " ", "-", " ", "fsizemax"}], 
              ")"}]}]}]}], ";", " ", 
          RowBox[{"n", " ", "=", " ", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"ne", "[", "x", "]"}], ",", " ", 
             RowBox[{"ne", "[", "z", "]"}]}], "]"}]}], ";", " ", "\n", 
          "       ", 
          RowBox[{"y", " ", "=", " ", 
           RowBox[{"fsizemask", " ", "+", " ", 
            RowBox[{"BitShiftLeft", "[", 
             RowBox[{
              RowBox[{"n", " ", "-", " ", "1"}], ",", " ", "fsizesize"}], 
             "]"}], " ", "+", " ", "\n", "         ", "ubitmask", " ", "-", 
            " ", "ulpu", " ", "+", " ", 
            RowBox[{"BitShiftLeft", "[", "\n", "          ", 
             RowBox[{
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"z", "/", 
                   RowBox[{"2", "^", 
                    RowBox[{"scale", "[", "z", "]"}]}]}], " ", "-", " ", 
                  "1"}], ")"}], "*", 
                RowBox[{"2", "^", "fsizemax"}]}], "]"}], ",", " ", 
              "utagsize"}], "]"}], " ", "+", " ", "\n", "         ", 
            RowBox[{"BitShiftLeft", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"scale", "[", "z", "]"}], " ", "+", " ", 
               RowBox[{"2", "^", 
                RowBox[{"(", 
                 RowBox[{"n", " ", "-", " ", "1"}], ")"}]}], " ", "-", " ", 
               "1"}], ",", " ", "\n", "          ", 
              RowBox[{"utagsize", " ", "+", " ", "fsizemax"}]}], "]"}]}]}], 
          ";", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"x", " ", "<", " ", "0"}], ",", " ", 
            RowBox[{"y", " ", "+=", " ", 
             RowBox[{"signmask", "[", "y", "]"}]}], ",", " ", "\n", 
            "        ", "y"}], "]"}]}]}], "]"}]}]}], "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"autoN", "[", "x_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"y", ",", " ", "z"}], "}"}], ",", " ", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"x", " ", "===", " ", "NaN"}], " ", "||", " ", 
       RowBox[{"x", " ", "==", " ", "0"}], " ", "||", " ", "\n", "     ", 
       RowBox[{"x", " ", "==", " ", "Infinity"}]}], ",", " ", "x", ",", " ", 
      RowBox[{"x", " ", "<", " ", "0"}], ",", " ", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<\[Dash]\>\"", ",", " ", 
         RowBox[{"autoN", "[", 
          RowBox[{"-", "x"}], "]"}]}], "}"}], "]"}], ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"y", " ", "=", " ", 
        RowBox[{"Log", "[", 
         RowBox[{"2", ",", " ", 
          RowBox[{"Denominator", "[", "x", "]"}]}], "]"}]}], ";", " ", 
       RowBox[{"y", " ", "==", " ", "0"}]}], ",", " ", 
      RowBox[{"IntegerString", "[", 
       RowBox[{"x", ",", " ", "10", ",", " ", "\n", "     ", 
        RowBox[{"1", " ", "+", " ", 
         RowBox[{"Floor", "[", 
          RowBox[{"Log", "[", 
           RowBox[{"10", ",", " ", "x"}], "]"}], "]"}]}]}], "]"}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "x", "]"}], " ", "==", " ", "Rational"}], " ", "&&",
        " ", "\n", "     ", 
       RowBox[{"y", " ", "==", " ", 
        RowBox[{"Floor", "[", "y", "]"}]}]}], ",", " ", 
      RowBox[{
       RowBox[{"y", " ", "=", " ", 
        RowBox[{"x", " ", "-", " ", 
         RowBox[{"Floor", "[", "x", "]"}]}]}], ";", " ", "\n", "     ", 
       RowBox[{"z", " ", "=", " ", 
        RowBox[{"Floor", "[", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", " ", 
           RowBox[{"Denominator", "[", "y", "]"}]}], "]"}], "]"}]}], ";", " ",
        "\n", "     ", 
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Floor", "[", "x", "]"}], ",", " ", "\"\<.\>\"", ",", " ", 
          RowBox[{"IntegerString", "[", 
           RowBox[{
            RowBox[{"y", "*", 
             RowBox[{"10", "^", "z"}]}], ",", " ", "10", ",", " ", "z"}], 
           "]"}]}], "}"}], "]"}]}], ",", " ", "True", ",", " ", "\n", "    ", 
      "\"\<?\>\""}], "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"unumview", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"e", " ", "=", " ", 
       RowBox[{"expo", "[", "u", "]"}]}], ",", " ", 
      RowBox[{"es", " ", "=", " ", 
       RowBox[{"esizeminus1", "[", "u", "]"}]}], ",", " ", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"frac", "[", "u", "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"fs", " ", "=", " ", 
       RowBox[{"fsizeminus1", "[", "u", "]"}]}], ",", " ", 
      RowBox[{"g", " ", "=", " ", 
       RowBox[{"u2g", "[", "u", "]"}]}], ",", " ", 
      RowBox[{"i", " ", "=", " ", 
       RowBox[{"inexQ", "[", "u", "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"NaNQ", " ", "=", " ", 
       RowBox[{
        RowBox[{"u", " ", "==", " ", "sNaNu"}], " ", "||", " ", 
        RowBox[{"u", " ", "==", " ", "qNaNu"}]}]}], ",", " ", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{"sign", "[", "u", "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"specQ", " ", "=", " ", 
       RowBox[{
        RowBox[{"u", " ", "==", " ", "sNaNu"}], " ", "||", " ", 
        RowBox[{"u", " ", "==", " ", "qNaNu"}], " ", "||", " ", 
        RowBox[{"u", " ", "==", " ", "posinfu"}], " ", "||", " ", "\n", 
        "      ", 
        RowBox[{"u", " ", "==", " ", "neginfu"}]}]}]}], "}"}], ",", " ", "\n",
     "   ", 
    RowBox[{"Grid", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Item", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"s", ",", " ", "Red", ",", " ", "\"\<Input\>\""}], "]"}],
             ",", " ", 
            RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", "\n", 
            "       ", 
            RowBox[{"Alignment", " ", "->", " ", "\"\<Left\>\""}]}], "]"}], 
          ",", " ", 
          RowBox[{"Item", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"IntegerString", "[", 
               RowBox[{"e", ",", " ", "2", ",", " ", "\n", "         ", 
                RowBox[{"esize", "[", "u", "]"}]}], "]"}], ",", " ", 
              "brightblue", ",", " ", "\"\<Input\>\""}], "]"}], ",", " ", 
            RowBox[{"Frame", " ", "->", " ", "True"}]}], "]"}], ",", " ", 
          "\n", "      ", "\"\<\[ThinSpace]\>\"", ",", " ", 
          RowBox[{"Item", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"IntegerString", "[", 
               RowBox[{"f", ",", " ", "2", ",", " ", 
                RowBox[{"fsize", "[", "u", "]"}]}], "]"}], ",", " ", "\n", 
              "        ", "\"\<Input\>\""}], "]"}], ",", " ", 
            RowBox[{"Frame", " ", "->", " ", "\"\<True\>\""}]}], "]"}], ",", 
          " ", "\n", "      ", 
          RowBox[{"Item", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Boole", "[", "i", "]"}], ",", " ", "Magenta", ",", 
              " ", "\"\<Input\>\"", ",", " ", "Plain"}], "]"}], ",", " ", 
            "\n", "       ", 
            RowBox[{"Frame", " ", "->", " ", "\"\<True\>\""}]}], "]"}], ",", 
          " ", 
          RowBox[{"Item", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"IntegerString", "[", 
               RowBox[{
               "es", ",", " ", "2", ",", " ", "\n", "         ", 
                "esizesize"}], "]"}], ",", " ", "sanegreen", ",", " ", 
              "\"\<Input\>\"", ",", " ", "Plain"}], "]"}], ",", " ", "\n", 
            "       ", 
            RowBox[{"Frame", " ", "->", " ", "True"}]}], "]"}], ",", " ", 
          RowBox[{"Item", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"IntegerString", "[", 
               RowBox[{
               "fs", ",", " ", "2", ",", " ", "\n", "         ", 
                "fsizesize"}], "]"}], ",", " ", 
              RowBox[{"FontColor", " ", "->", " ", "Gray"}], ",", " ", 
              "\"\<Input\>\"", ",", " ", "Plain"}], "]"}], ",", " ", "\n", 
            "       ", 
            RowBox[{"Frame", " ", "->", " ", "True"}]}], "]"}], ",", " ", 
          "\"\<\[ThinSpace]\>\"", ",", " ", 
          RowBox[{"If", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"!", "NaNQ"}], " ", "&&", "  ", 
             RowBox[{"!", "i"}], " ", "&&", " ", "\n", "        ", 
             RowBox[{
              RowBox[{"u2f", "[", "u", "]"}], " ", "!=", " ", 
              RowBox[{"Floor", "[", 
               RowBox[{"u2f", "[", "u", "]"}], "]"}]}]}], ",", " ", 
            RowBox[{"u2f", "[", "u", "]"}], ",", " ", "\n", "       ", 
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Item", "[", 
                RowBox[{"Which", "[", 
                 RowBox[{"specQ", ",", " ", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                   "\"\<special case string\>\"", ",", " ", "\n", 
                    "            ", "Italic"}], "]"}], ",", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "==", " ", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], " ", "&&",
                    " ", "\n", "            ", 
                   RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "==", " ", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}]}]}], ",", 
                  " ", "\"\< \>\"", ",", " ", "True", ",", " ", "\n", 
                  "           ", 
                  RowBox[{"StringForm", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", 
                    "\"\<(``,\>\"", ",", " ", "\"\<[``,\>\""}], "]"}], ",", 
                    " ", "\n", "            ", 
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}]}], "]"}], 
                "]"}], ",", " ", 
               RowBox[{"Item", "[", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"NaNQ", " ", "||", " ", "\n", "            ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "==", " ", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], " ", "&&",
                     " ", 
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "==", " ", 
                    "\n", "              ", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}]}]}], ")"}]}],
                   ",", " ", "\"\< \>\"", ",", " ", 
                  RowBox[{"StringForm", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", " ", "\n", 
                    "             ", "\"\<``)\>\"", ",", " ", "\"\<``]\>\""}],
                     "]"}], ",", " ", 
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}]}], "]"}], 
                "]"}]}], "}"}], "]"}]}], "]"}]}], "}"}], ",", " ", "\n", 
        "     ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"s", " ", "==", " ", "0"}], ",", " ", "\"\<+\>\"", ",", 
              " ", "\"\<\[Dash]\>\""}], "]"}], ",", " ", "Red"}], "]"}], ",", 
          " ", "\n", "      ", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"StringForm", "[", 
             RowBox[{"\"\<``\[Times]\>\"", ",", " ", 
              RowBox[{"Superscript", "[", 
               RowBox[{"2", ",", " ", 
                RowBox[{"expovalue", "[", "u", "]"}]}], "]"}]}], "]"}], ",", 
            " ", "\n", "       ", "brightblue"}], "]"}], ",", " ", 
          RowBox[{"Style", "[", 
           RowBox[{"StringForm", "[", 
            RowBox[{
            "\"\<\[NegativeThickSpace]``+\[NegativeThickSpace]\
\[NegativeThickSpace]\>\"", ",", " ", "\n", "        ", 
             RowBox[{"hidden", "[", "u", "]"}]}], "]"}], "]"}], ",", " ", 
          RowBox[{"DisplayForm", "[", 
           RowBox[{"FractionBox", "[", 
            RowBox[{"f", ",", " ", 
             RowBox[{"2", "^", 
              RowBox[{"(", 
               RowBox[{"fs", " ", "+", " ", "1"}], ")"}]}]}], "]"}], "]"}], 
          ",", " ", "\n", "      ", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
             "i", ",", " ", "\"\<\[CenterEllipsis]\>\"", ",", " ", 
              "\"\<\[DownArrow]\>\""}], "]"}], ",", " ", "Magenta"}], "]"}], 
          ",", " ", "\n", "      ", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"es", " ", "+", " ", "1"}], ",", " ", "sanegreen"}], 
           "]"}], ",", " ", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"fs", " ", "+", " ", "1"}], ",", " ", "Gray"}], "]"}], 
          ",", " ", "\"\<\[ThinSpace]\>\"", ",", " ", "\n", "      ", 
          RowBox[{"If", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"!", "NaNQ"}], " ", "&&", "  ", 
             RowBox[{"!", "i"}]}], ",", " ", 
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"If", "[", " ", 
                RowBox[{
                 RowBox[{"!", "specQ"}], ",", " ", "\"\<= \>\""}], "]"}], ",",
                " ", "\n", "         ", 
               RowBox[{"autoN", "[", 
                RowBox[{"g", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], 
             "]"}], ",", " ", "\n", "       ", 
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Item", "[", 
                RowBox[{"If", "[", 
                 RowBox[{"NaNQ", ",", " ", "\"\< \>\"", ",", " ", 
                  RowBox[{"StringForm", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", "\n", 
                    "              ", "\"\<= (``,\>\"", ",", " ", 
                    "\"\<= [``,\>\""}], "]"}], ",", " ", 
                    RowBox[{"autoN", "[", 
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}]}], 
                 "]"}], "]"}], "*", "\n", "          ", 
               RowBox[{"Item", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{"NaNQ", ",", " ", "\"\<NaN\>\"", ",", " ", 
                   RowBox[{"StringForm", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", " ", 
                    "\"\<``)\>\"", ",", " ", "\n", "              ", 
                    "\"\<``]\>\""}], "]"}], ",", " ", 
                    RowBox[{"autoN", "[", 
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}]}], 
                  "]"}], ",", " ", 
                 RowBox[{
                 "Alignment", " ", "->", " ", "\n", "            ", 
                  "Left"}]}], "]"}]}], "}"}], "]"}]}], "]"}]}], "}"}]}], 
       "}"}], ",", " ", 
      RowBox[{"ItemStyle", " ", "->", " ", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", " ", "\n", "      ", 
         RowBox[{"2", " ", "->", " ", 
          RowBox[{"{", 
           RowBox[{"\"\<Text\>\"", ",", " ", "12"}], "}"}]}], ",", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", " ", "9"}], "}"}], " ", "->", " ", 
          "\"\<Text\>\""}]}], "}"}]}]}], "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"uboundview", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"uboundQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "u", "]"}], " ", "==", " ", "1"}], ",", " ", "\n",
     "   ", 
    RowBox[{"unumview", "[", 
     RowBox[{"u", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uL", " ", "=", " ", 
         RowBox[{"u", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
        RowBox[{"uR", " ", "=", " ", 
         RowBox[{"u", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", "eL", ",", " ", "eR", 
        ",", " ", "\n", "     ", "esL", ",", " ", "esR", ",", " ", "fL", ",", 
        " ", "fsL", ",", " ", "fsR", ",", " ", "fR", ",", " ", "iL", ",", " ",
         "iR", ",", " ", "NaNQ", ",", " ", "sL", ",", " ", "sR", ",", " ", 
        "t"}], "}"}], ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"eL", ",", " ", "eR", ",", " ", "fL", ",", " ", "fR"}], 
         "}"}], " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"expo", "[", "uL", "]"}], ",", " ", 
          RowBox[{"expo", "[", "uR", "]"}], ",", " ", 
          RowBox[{"frac", "[", "uL", "]"}], ",", " ", "\n", "       ", 
          RowBox[{"frac", "[", "uR", "]"}]}], "}"}]}], ";", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"esL", ",", " ", "esR", ",", " ", "fsL", ",", " ", "fsR"}], 
         "}"}], " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"esizeminus1", "[", "uL", "]"}], ",", " ", "\n", "       ", 
          
          RowBox[{"esizeminus1", "[", "uR", "]"}], ",", " ", 
          RowBox[{"fsizeminus1", "[", "uL", "]"}], ",", " ", 
          RowBox[{"fsizeminus1", "[", "uR", "]"}]}], "}"}]}], ";", " ", "\n", 
       "     ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"iL", ",", " ", "iR", ",", " ", "sL", ",", " ", "sR"}], 
         "}"}], " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"inexQ", "[", "uL", "]"}], ",", " ", 
          RowBox[{"inexQ", "[", "uR", "]"}], ",", " ", 
          RowBox[{"sign", "[", "uL", "]"}], ",", " ", "\n", "       ", 
          RowBox[{"sign", "[", "uR", "]"}]}], "}"}]}], ";", " ", 
       RowBox[{"NaNQ", " ", "=", " ", 
        RowBox[{
         RowBox[{"uL", " ", "==", " ", "qNaNu"}], " ", "||", " ", 
         RowBox[{"uL", " ", "==", " ", "sNaNu"}], " ", "||", " ", "\n", 
         "       ", 
         RowBox[{"uR", " ", "==", " ", "qNaNu"}], " ", "||", " ", 
         RowBox[{"uR", " ", "==", " ", "sNaNu"}]}]}], ";", " ", "\n", "     ", 
       RowBox[{"t", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Item", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
               "sL", ",", " ", "Red", ",", " ", "Bold", ",", " ", "9"}], 
               "]"}], ",", " ", 
              RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", "\n", 
              "         ", 
              RowBox[{"Alignment", " ", "->", " ", "\"\<Left\>\""}]}], "]"}], 
            ",", " ", 
            RowBox[{"Item", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"IntegerString", "[", 
                 RowBox[{"eL", ",", " ", "2", ",", " ", "\n", "           ", 
                  RowBox[{"esL", " ", "+", " ", "1"}]}], "]"}], ",", " ", 
                "Bold", ",", " ", "brightblue", ",", " ", "9"}], "]"}], ",", 
              " ", 
              RowBox[{"Frame", " ", "->", " ", "True"}]}], "]"}], ",", " ", 
            "\n", "        ", "\"\<\[ThinSpace]\>\"", ",", " ", 
            RowBox[{"Item", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"IntegerString", "[", 
                 RowBox[{"fL", ",", " ", "2", ",", " ", 
                  RowBox[{"fsL", " ", "+", " ", "1"}]}], "]"}], ",", " ", 
                "Bold", ",", " ", "\n", "          ", "9"}], "]"}], ",", " ", 
              
              RowBox[{"Frame", " ", "->", " ", "\"\<True\>\""}]}], "]"}], ",",
             " ", 
            RowBox[{"Item", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"Boole", "[", "iL", "]"}], ",", " ", "Magenta", ",", 
                " ", "\n", "          ", "9"}], "]"}], ",", " ", 
              RowBox[{"Frame", " ", "->", " ", "\"\<True\>\""}]}], "]"}], ",",
             " ", 
            RowBox[{"Item", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"IntegerString", "[", 
                 RowBox[{
                 "esL", ",", " ", "\n", "           ", "2", ",", " ", 
                  "esizesize"}], "]"}], ",", " ", "sanegreen", ",", " ", 
                "9"}], "]"}], ",", " ", 
              RowBox[{"Frame", " ", "->", " ", "True"}]}], "]"}], ",", " ", 
            "\n", "        ", 
            RowBox[{"Item", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"IntegerString", "[", 
                 RowBox[{"fsL", ",", " ", "2", ",", " ", "fsizesize"}], "]"}],
                 ",", " ", "\n", "          ", 
                RowBox[{"FontColor", " ", "->", " ", "Gray"}], ",", " ", 
                "9"}], "]"}], ",", " ", 
              RowBox[{"Frame", " ", "->", " ", "True"}]}], "]"}], ",", " ", 
            "\"\< \>\"", ",", " ", "\n", "        ", 
            RowBox[{"Item", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
               "sR", ",", " ", "Red", ",", " ", "Bold", ",", " ", "9"}], 
               "]"}], ",", " ", 
              RowBox[{"Frame", " ", "->", " ", "True"}]}], "]"}], ",", " ", 
            "\n", "        ", 
            RowBox[{"Item", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"IntegerString", "[", 
                 RowBox[{"eR", ",", " ", "2", ",", " ", 
                  RowBox[{"esR", " ", "+", " ", "1"}]}], "]"}], ",", " ", 
                "brightblue", ",", " ", "\n", "          ", "Bold", ",", " ", 
                "9"}], "]"}], ",", " ", 
              RowBox[{"Frame", " ", "->", " ", "True"}]}], "]"}], ",", " ", 
            "\"\<\[ThinSpace]\>\"", ",", " ", "\n", "        ", 
            RowBox[{"Item", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"IntegerString", "[", 
                 RowBox[{"fR", ",", " ", "2", ",", " ", 
                  RowBox[{"fsR", " ", "+", " ", "1"}]}], "]"}], ",", " ", 
                "Bold", ",", " ", "9"}], "]"}], ",", " ", "\n", "         ", 
              RowBox[{"Frame", " ", "->", " ", "True"}]}], "]"}], ",", " ", 
            RowBox[{"Item", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"Boole", "[", "iR", "]"}], ",", " ", "Magenta", ",", 
                " ", "9"}], "]"}], ",", " ", "\n", "         ", 
              RowBox[{"Frame", " ", "->", " ", "True"}]}], "]"}], ",", " ", 
            RowBox[{"Item", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"IntegerString", "[", 
                 RowBox[{
                 "esR", ",", " ", "2", ",", " ", "\n", "           ", 
                  "esizesize"}], "]"}], ",", " ", "sanegreen", ",", " ", 
                "9"}], "]"}], ",", " ", 
              RowBox[{"Frame", " ", "->", " ", "True"}]}], "]"}], ",", " ", 
            "\n", "        ", 
            RowBox[{"Item", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"IntegerString", "[", 
                 RowBox[{"fsR", ",", " ", "2", ",", " ", "fsizesize"}], "]"}],
                 ",", " ", "\n", "          ", 
                RowBox[{"FontColor", " ", "->", " ", "Gray"}], ",", " ", 
                "9"}], "]"}], ",", " ", 
              RowBox[{"Frame", " ", "->", " ", "True"}]}], "]"}]}], "}"}], 
          ",", " ", "\n", "       ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"sL", " ", "==", " ", "0"}], ",", " ", "\"\<+\>\"", 
                ",", " ", "\"\<\[Dash]\>\""}], "]"}], ",", " ", "Red", ",", 
              " ", "9"}], "]"}], ",", " ", "\n", "        ", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"StringForm", "[", 
               RowBox[{"\"\<``\[Times]\>\"", ",", " ", 
                RowBox[{"Superscript", "[", 
                 RowBox[{"2", ",", " ", "\n", "           ", 
                  RowBox[{"expovalue", "[", "uL", "]"}]}], "]"}]}], "]"}], 
              ",", " ", "brightblue", ",", " ", "12"}], "]"}], ",", " ", "\n",
             "        ", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"StringForm", "[", 
               RowBox[{
               "\"\<\[NegativeThickSpace]``+\[NegativeThickSpace]\
\[NegativeThickSpace]\>\"", ",", " ", 
                RowBox[{"hidden", "[", "uL", "]"}]}], "]"}], ",", " ", "12"}],
              "]"}], ",", " ", "\n", "        ", 
            RowBox[{"DisplayForm", "[", 
             RowBox[{"FractionBox", "[", 
              RowBox[{"fL", ",", " ", 
               RowBox[{"2", "^", 
                RowBox[{"(", 
                 RowBox[{"fsL", " ", "+", " ", "1"}], ")"}]}]}], "]"}], "]"}],
             ",", " ", "\n", "        ", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
               "iL", ",", " ", "\"\<\[CenterEllipsis]\>\"", ",", " ", 
                "\"\<\[DownArrow]\>\""}], "]"}], ",", " ", "Magenta", ",", 
              " ", "12"}], "]"}], ",", " ", "\n", "        ", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"esL", " ", "+", " ", "1"}], ",", " ", "sanegreen", ",",
               " ", "12"}], "]"}], ",", " ", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"fsL", " ", "+", " ", "1"}], ",", " ", "Gray", ",", " ",
               "\n", "         ", "12"}], "]"}], ",", " ", "\"\< \>\"", ",", 
            " ", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"sR", " ", "==", " ", "0"}], ",", " ", "\"\<+\>\"", 
                ",", " ", "\"\<\[Dash]\>\""}], "]"}], ",", " ", "Red", ",", 
              " ", "12"}], "]"}], ",", " ", "\n", "        ", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"StringForm", "[", 
               RowBox[{"\"\<``\[Times]\>\"", ",", " ", 
                RowBox[{"Superscript", "[", 
                 RowBox[{"2", ",", " ", "\n", "           ", 
                  RowBox[{"expovalue", "[", "uR", "]"}]}], "]"}]}], "]"}], 
              ",", " ", "brightblue", ",", " ", "12"}], "]"}], ",", " ", "\n",
             "        ", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"StringForm", "[", 
               RowBox[{
               "\"\<\[NegativeThickSpace]``+\[NegativeThickSpace]\
\[NegativeThickSpace]\>\"", ",", " ", 
                RowBox[{"hidden", "[", "uR", "]"}]}], "]"}], ",", " ", "12"}],
              "]"}], ",", " ", "\n", "        ", 
            RowBox[{"DisplayForm", "[", 
             RowBox[{"FractionBox", "[", 
              RowBox[{"fR", ",", " ", 
               RowBox[{"2", "^", 
                RowBox[{"(", 
                 RowBox[{"fsR", " ", "+", " ", "1"}], ")"}]}]}], "]"}], "]"}],
             ",", " ", "\n", "        ", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
               "iR", ",", " ", "\"\<\[CenterEllipsis]\>\"", ",", " ", 
                "\"\<\[DownArrow]\>\""}], "]"}], ",", " ", "Magenta", ",", 
              " ", "12"}], "]"}], ",", " ", "\n", "        ", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"esR", " ", "+", " ", "1"}], ",", " ", "sanegreen", ",",
               " ", "12"}], "]"}], ",", " ", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"fsR", " ", "+", " ", "1"}], ",", " ", "Gray", ",", " ",
               "\n", "         ", "12"}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Item", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{"NaNQ", ",", " ", "\"\< \>\"", ",", " ", 
                RowBox[{"StringForm", "[", "\n", "           ", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"u2g", "[", "u", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", 
                    "\"\<= (``,\>\"", ",", " ", "\"\<= [``,\>\""}], "]"}], 
                  ",", " ", "\n", "           ", 
                  RowBox[{
                   RowBox[{"u2g", "[", "u", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}]}], "]"}], 
              ",", " ", 
              RowBox[{"Alignment", " ", "->", " ", "Right"}]}], "]"}], ",", 
            " ", "SpanFromLeft", ",", " ", "\n", "        ", "SpanFromLeft", 
            ",", " ", "SpanFromLeft", ",", " ", "SpanFromLeft", ",", " ", 
            "SpanFromLeft", ",", " ", "\n", "        ", "SpanFromLeft", ",", 
            " ", "SpanFromLeft", ",", " ", 
            RowBox[{"Item", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
               "NaNQ", ",", " ", "\"\<NaN\>\"", ",", " ", "\n", "          ", 
                
                RowBox[{"StringForm", "[", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"u2g", "[", "u", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", " ", 
                    "\"\<``)\>\"", ",", " ", "\"\<``]\>\""}], "]"}], ",", " ",
                   "\n", "           ", 
                  RowBox[{
                   RowBox[{"u2g", "[", "u", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}]}], "]"}], 
              ",", " ", 
              RowBox[{"Alignment", " ", "->", " ", "Left"}]}], "]"}], ",", 
            " ", "SpanFromLeft", ",", " ", "\n", "        ", "SpanFromLeft", 
            ",", " ", "SpanFromLeft", ",", " ", "SpanFromLeft", ",", " ", 
            "SpanFromLeft", ",", " ", "\n", "        ", "SpanFromLeft"}], 
           "}"}]}], "}"}]}], ";", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", 
            RowBox[{
             RowBox[{"u2g", "[", "u", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], " ", "==", " ", 
           "Rational"}], " ", "||", " ", "\n", "       ", 
          RowBox[{
           RowBox[{"Head", "[", 
            RowBox[{
             RowBox[{"u2g", "[", "u", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}], " ", "==", " ", 
           "Rational"}]}], ",", " ", "\n", "      ", 
         RowBox[{"t", " ", "=", " ", 
          RowBox[{"Join", "[", 
           RowBox[{"t", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Item", "[", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{"NaNQ", ",", " ", "\"\< \>\"", ",", " ", 
                    RowBox[{"StringForm", "[", "\n", "             ", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"u2g", "[", "u", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", 
                    "\"\<= (``,\>\"", ",", " ", "\"\<= [``,\>\""}], "]"}], 
                    ",", " ", "\n", "             ", 
                    RowBox[{"autoN", "[", 
                    RowBox[{
                    RowBox[{"u2g", "[", "u", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}]}], 
                   "]"}], ",", " ", 
                  RowBox[{"Alignment", " ", "->", " ", "Right"}]}], "]"}], 
                ",", " ", "\n", "          ", "SpanFromLeft", ",", " ", 
                "SpanFromLeft", ",", " ", "SpanFromLeft", ",", " ", "\n", 
                "          ", "SpanFromLeft", ",", " ", "SpanFromLeft", ",", 
                " ", "SpanFromLeft", ",", " ", "\n", "          ", 
                "SpanFromLeft", ",", " ", 
                RowBox[{"Item", "[", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{"NaNQ", ",", " ", "\"\<NaN\>\"", ",", " ", 
                    RowBox[{"StringForm", "[", "\n", "             ", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"u2g", "[", "u", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", " ", 
                    "\"\<``)\>\"", ",", " ", "\"\<``]\>\""}], "]"}], ",", " ",
                     "\n", "             ", 
                    RowBox[{"autoN", "[", 
                    RowBox[{
                    RowBox[{"u2g", "[", "u", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}]}], 
                   "]"}], ",", " ", 
                  RowBox[{"Alignment", " ", "->", " ", "Left"}]}], "]"}], ",",
                 " ", "\n", "          ", "SpanFromLeft", ",", " ", 
                "SpanFromLeft", ",", " ", "SpanFromLeft", ",", " ", "\n", 
                "          ", "SpanFromLeft", ",", " ", "SpanFromLeft", ",", 
                " ", "SpanFromLeft"}], "}"}]}], "}"}]}], "]"}]}]}], "]"}], 
       ";", " ", "\n", "     ", 
       RowBox[{"Grid", "[", 
        RowBox[{"t", ",", " ", 
         RowBox[{"ItemStyle", " ", "->", " ", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"2", " ", "->", " ", "\"\<Text\>\""}], ",", " ", "\n", 
              "         ", 
              RowBox[{"4", " ", "->", " ", "\"\<Text\>\""}], ",", " ", 
              RowBox[{"6", " ", "->", " ", "\"\<Text\>\""}]}], "}"}]}], 
           "}"}]}]}], "]"}]}]}], "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"uview", "[", 
   RowBox[{"x_", " ", "/;", " ", 
    RowBox[{
     RowBox[{"gQ", "[", "x", "]"}], " ", "||", " ", 
     RowBox[{"uboundQ", "[", "x", "]"}], " ", "||", " ", 
     RowBox[{"unumQ", "[", "x", "]"}]}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  
  RowBox[{"Which", "[", 
   RowBox[{
    RowBox[{"gQ", "[", "x", "]"}], ",", " ", 
    RowBox[{"uboundview", "[", 
     RowBox[{"g2u", "[", "x", "]"}], "]"}], ",", " ", 
    RowBox[{"uboundQ", "[", "x", "]"}], ",", " ", 
    RowBox[{"uboundview", "[", "x", "]"}], ",", " ", "\n", "   ", "True", ",",
     " ", 
    RowBox[{"unumview", "[", "x", "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"gview", "[", 
   RowBox[{"g_", " ", "/;", " ", 
    RowBox[{
     RowBox[{"gQ", "[", "g", "]"}], " ", "||", " ", 
     RowBox[{"uboundQ", "[", "g", "]"}], " ", "||", " ", 
     RowBox[{"unumQ", "[", "g", "]"}]}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"L", ",", " ", "R", ",", " ", "LQ", ",", " ", "RQ"}], "}"}], ",",
     " ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"L", ",", " ", "R"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"LQ", ",", " ", "RQ"}], "}"}]}], "}"}], " ", "=", " ", "\n", 
      "     ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"gQ", "[", "g", "]"}], ",", " ", "g", ",", " ", 
        RowBox[{"u2g", "[", "g", "]"}]}], "]"}]}], ";", " ", 
     RowBox[{"Grid", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"L", ",", " ", "R"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"LQ", ",", " ", "RQ"}], "}"}]}], "}"}], ",", " ", "\n", 
       "     ", 
       RowBox[{"Background", " ", "->", " ", "chartreuse"}]}], "]"}]}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"view", "[", 
   RowBox[{"g_", " ", "/;", " ", 
    RowBox[{
     RowBox[{"gQ", "[", "g", "]"}], " ", "||", " ", 
     RowBox[{"unumQ", "[", "g", "]"}], " ", "||", " ", 
     RowBox[{"uboundQ", "[", "g", "]"}]}]}], "]"}], " ", ":=", " ", "\n", 
  "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"L", ",", " ", "R", ",", " ", "LQ", ",", " ", "RQ"}], "}"}], ",",
     " ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"L", ",", " ", "R"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"LQ", ",", " ", "RQ"}], "}"}]}], "}"}], " ", "=", " ", "\n", 
      "     ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"gQ", "[", "g", "]"}], ",", " ", "g", ",", " ", 
        RowBox[{"u2g", "[", "g", "]"}]}], "]"}]}], ";", " ", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"L", " ", "===", " ", "NaN"}], " ", "||", " ", 
        RowBox[{"R", " ", "===", " ", "NaN"}]}], ",", " ", "\n", "     ", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<NaN\>\"", ",", " ", "\"\<Text\>\""}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{"L", " ", "==", " ", "R"}], " ", "&&", "  ", 
        RowBox[{"!", "LQ"}], " ", "&&", "  ", 
        RowBox[{"!", "RQ"}]}], ",", " ", "\n", "     ", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"autoN", "[", "L", "]"}], ",", " ", "\"\<Text\>\""}], "]"}], 
       ",", " ", 
       RowBox[{"L", " ", "<", " ", "R"}], ",", " ", "\n", "     ", 
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{"LQ", ",", " ", "\"\<(\>\"", ",", " ", "\"\<[\>\""}], 
             "]"}], ",", " ", "\"\<Text\>\""}], "]"}], ",", " ", "\n", 
          "       ", 
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"autoN", "[", "L", "]"}], ",", " ", "\"\<Text\>\""}], 
              "]"}], ",", " ", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<, \>\"", ",", " ", "\"\<Text\>\""}], "]"}]}], 
            "}"}], "]"}], ",", " ", "\n", "       ", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"autoN", "[", "R", "]"}], ",", " ", "\"\<Text\>\""}], 
           "]"}], ",", " ", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{"RQ", ",", " ", "\"\<)\>\"", ",", " ", "\"\<]\>\""}], 
             "]"}], ",", " ", "\n", "        ", "\"\<Text\>\""}], "]"}]}], 
         "}"}], "]"}], ",", " ", "True", ",", " ", "\"\<NaN\>\""}], "]"}]}]}],
    "]"}]}], "\n", 
 RowBox[{
  RowBox[{"scale", "[", 
   RowBox[{"x_", " ", "/;", " ", 
    RowBox[{
     RowBox[{"floatQ", "[", "x", "]"}], " ", "&&", " ", 
     RowBox[{"x", " ", "!=", " ", "Infinity"}], " ", "&&", " ", 
     RowBox[{"x", " ", "=!=", " ", "NaN"}]}]}], "]"}], " ", ":=", " ", "\n", 
  "  ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"x", " ", "==", " ", "0"}], ",", " ", "0", ",", " ", 
    RowBox[{"Floor", "[", 
     RowBox[{"Log", "[", 
      RowBox[{"2", ",", " ", 
       RowBox[{"Abs", "[", "x", "]"}]}], "]"}], "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ne", "[", 
   RowBox[{"x_", " ", "/;", " ", 
    RowBox[{
     RowBox[{"floatQ", "[", "x", "]"}], " ", "&&", " ", 
     RowBox[{"x", " ", "!=", " ", "Infinity"}], " ", "&&", " ", 
     RowBox[{"x", " ", "=!=", " ", "NaN"}]}]}], "]"}], " ", ":=", " ", "\n", 
  "  ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"x", " ", "==", " ", "0"}], " ", "||", " ", 
     RowBox[{
      RowBox[{"scale", "[", "x", "]"}], " ", "==", " ", "1"}]}], ",", " ", 
    "1", ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{"Ceiling", "[", 
      RowBox[{"Log", "[", 
       RowBox[{"2", ",", " ", 
        RowBox[{"1", " ", "+", " ", 
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"scale", "[", "x", "]"}], " ", "-", " ", "1"}], "]"}]}]}], 
       "]"}], "]"}], " ", "+", " ", "1"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"nbits", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"uQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ub", " ", "=", " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"unumQ", "[", "u", "]"}], ",", " ", 
        RowBox[{"{", "u", "}"}], ",", " ", "u"}], "]"}]}], "}"}], ",", " ", 
    "\n", "   ", 
    RowBox[{"1", " ", "+", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "ub", "]"}], " ", "==", " ", "2"}], ",", " ", 
       RowBox[{
        RowBox[{"numbits", "[", 
         RowBox[{"ub", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"numbits", "[", 
         RowBox[{"ub", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", " ", "\n", "     ", 
       RowBox[{"numbits", "[", 
        RowBox[{"ub", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"padu", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"BitShiftLeft", "[", 
    RowBox[{
     RowBox[{"BitAnd", "[", 
      RowBox[{
       RowBox[{"floatmask", "[", "u", "]"}], ",", " ", "u"}], "]"}], ",", " ",
      "\n", "    ", 
     RowBox[{"fsizemax", " ", "-", " ", 
      RowBox[{"fsize", "[", "u", "]"}]}]}], "]"}], " ", "+", " ", 
   RowBox[{"BitAnd", "[", 
    RowBox[{"utagmask", ",", " ", "u"}], "]"}], " ", "+", " ", "fsizemax", 
   " ", "-", " ", "\n", "   ", 
   RowBox[{"fsize", "[", "u", "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"negateu", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"uQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Which", "[", 
   RowBox[{
    RowBox[{"uboundQ", "[", "u", "]"}], ",", " ", "\n", "   ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "u", "]"}], " ", "==", " ", "1"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"u2g", "[", 
           RowBox[{"u", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "===", " ", 
          RowBox[{"u2g", "[", "0", "]"}]}], ",", " ", 
         RowBox[{"x2u", "[", "0", "]"}], ",", " ", "\n", "      ", 
         RowBox[{"BitXor", "[", 
          RowBox[{
           RowBox[{"signmask", "[", 
            RowBox[{"u", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", " ", 
           RowBox[{"u", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], "}"}], ",", " ",
       "\n", "    ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"u2g", "[", 
            RowBox[{"u", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], " ", "===", " ", 
           RowBox[{"u2g", "[", "0", "]"}]}], ",", " ", 
          RowBox[{"x2u", "[", "0", "]"}], ",", " ", "\n", "      ", 
          RowBox[{"BitXor", "[", 
           RowBox[{
            RowBox[{"signmask", "[", 
             RowBox[{"u", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", " ", 
            RowBox[{"u", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], ",", " ", "\n",
         "     ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"u2g", "[", 
            RowBox[{"u", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "===", " ", 
           RowBox[{"u2g", "[", "0", "]"}]}], ",", " ", 
          RowBox[{"x2u", "[", "0", "]"}], ",", " ", "\n", "      ", 
          RowBox[{"BitXor", "[", 
           RowBox[{
            RowBox[{"signmask", "[", 
             RowBox[{"u", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", " ", 
            RowBox[{"u", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ",", " ", "True", ",", " ", "\n", "   ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"u2g", "[", "u", "]"}], " ", "===", " ", 
       RowBox[{"u2g", "[", "0", "]"}]}], ",", " ", 
      RowBox[{"x2u", "[", "0", "]"}], ",", " ", 
      RowBox[{"BitXor", "[", 
       RowBox[{
        RowBox[{"signmask", "[", "u", "]"}], ",", " ", "u"}], "]"}]}], 
     "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"unifypos", "[", 
   RowBox[{"ub_", " ", "/;", " ", 
    RowBox[{"uboundQ", "[", "ub", "]"}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", " ", "=", " ", 
       RowBox[{"ub", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
      RowBox[{"v", " ", "=", " ", 
       RowBox[{"ub", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}]}], ",", " ", "n"}], "}"}], ",", " ",
     "\n", "   ", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"u2g", "[", "u", "]"}], " ", "===", " ", 
       RowBox[{"u2g", "[", "v", "]"}]}], ",", " ", 
      RowBox[{"g2u", "[", 
       RowBox[{"u2g", "[", "u", "]"}], "]"}], ",", " ", 
      RowBox[{
       RowBox[{"ub", " ", "\[TildeTilde]", " ", 
        RowBox[{"{", 
         RowBox[{"x2u", "[", "0", "]"}], "}"}]}], " ", "||", " ", "\n", 
       "     ", 
       RowBox[{"ub", " ", "\[TildeTilde]", " ", 
        RowBox[{"{", 
         RowBox[{"x2u", "[", "1", "]"}], "}"}]}], " ", "||", " ", 
       RowBox[{"ub", " ", "\[TildeTilde]", " ", 
        RowBox[{"{", 
         RowBox[{"x2u", "[", "2", "]"}], "}"}]}], " ", "||", " ", 
       RowBox[{"ub", " ", "\[TildeTilde]", " ", 
        RowBox[{"{", 
         RowBox[{"x2u", "[", "3", "]"}], "}"}]}]}], ",", " ", "ub", ",", " ", 
      "\n", "    ", 
      RowBox[{
       RowBox[{"u", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"promote", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"u2g", "[", 
               RowBox[{"x2u", "[", "u", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
             "efsizemask"}], "}"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "\n", "       ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"inexQ", "[", "u", "]"}], ",", " ", "ubitmask", ",", " ", 
           RowBox[{"-", "ubitmask"}]}], "]"}]}]}], ";", " ", "\n", "     ", 
       RowBox[{"v", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"promote", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"u2g", "[", 
               RowBox[{"x2u", "[", "v", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", " ", 
             "efsizemask"}], "}"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "\n", "       ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"inexQ", "[", "v", "]"}], ",", " ", "ubitmask", ",", " ", 
           RowBox[{"-", "ubitmask"}]}], "]"}]}]}], ";", " ", 
       RowBox[{"u", " ", "==", " ", "v"}]}], ",", " ", 
      RowBox[{"{", "u", "}"}], ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"u2g", "[", "v", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "==", " ", "Infinity"}],
        " ", "&&", " ", 
       RowBox[{
        RowBox[{"u2g", "[", "v", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ltuQ", "[", 
         RowBox[{
          RowBox[{"{", "maxrealu", "}"}], ",", " ", 
          RowBox[{"{", "u", "}"}]}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"maxrealu", " ", "+", " ", "ubitmask"}], "}"}], ",", " ", 
        "\n", "     ", 
        RowBox[{
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"u2g", "[", "u", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "<", " ", 
            "Infinity"}], ",", " ", "\n", "       ", 
           RowBox[{"u", " ", "=", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"esize", "[", "u", "]"}], " ", ">", " ", "1"}], ",", 
              " ", 
              RowBox[{"demotee", "[", "u", "]"}], ",", " ", 
              RowBox[{"demotef", "[", "u", "]"}]}], "]"}]}]}], "]"}], ";", 
         " ", 
         RowBox[{"{", "u", "}"}]}]}], "]"}], ",", " ", "\n", "    ", "True", 
      ",", " ", 
      RowBox[{
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"u", " ", "!=", " ", "v"}], " ", "&&", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"u2g", "[", 
               RowBox[{"demotee", "[", "u", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "<", " ", "\n", 
             "         ", 
             RowBox[{
              RowBox[{"u2g", "[", 
               RowBox[{"demotee", "[", "v", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"u2g", "[", 
               RowBox[{"demotee", "[", "u", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "<", " ", "\n", 
             "         ", 
             RowBox[{
              RowBox[{"u2g", "[", 
               RowBox[{"demotee", "[", "v", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "<", " ", 
             "Infinity"}]}], ")"}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"esize", "[", "u", "]"}], " ", ">", " ", "1"}]}], ",", " ",
          "\n", "      ", 
         RowBox[{
          RowBox[{"u", " ", "=", " ", 
           RowBox[{"demotee", "[", "u", "]"}]}], ";", " ", 
          RowBox[{"v", " ", "=", " ", 
           RowBox[{"demotee", "[", "v", "]"}]}]}]}], "]"}], ";", " ", "\n", 
       "     ", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"u", " ", "!=", " ", "v"}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"frac", "[", "v", "]"}], " ", "!=", " ", 
           RowBox[{"frac", "[", "u", "]"}]}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"fsize", "[", "u", "]"}], " ", ">", " ", "1"}]}], ",", " ",
          "\n", "      ", 
         RowBox[{
          RowBox[{"u", " ", "=", " ", 
           RowBox[{"demotef", "[", "u", "]"}]}], ";", " ", 
          RowBox[{"v", " ", "=", " ", 
           RowBox[{"demotef", "[", "v", "]"}]}]}]}], "]"}], ";", " ", "\n", 
       "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"u", " ", "!=", " ", "v"}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"BitAnd", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"floatmask", "[", "u", "]"}], " ", "+", " ", 
              "ubitmask"}], ",", " ", "u"}], "]"}], " ", "==", " ", "\n", 
           "        ", "ubitmask"}], " ", "&&", " ", 
          RowBox[{"ltuQ", "[", 
           RowBox[{
            RowBox[{"{", "v", "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"x2u", "[", "1", "]"}], "}"}]}], "]"}]}], ",", " ", "\n",
          "      ", 
         RowBox[{
          RowBox[{"n", " ", "=", " ", 
           RowBox[{"Min", "[", 
            RowBox[{"esizemax", ",", " ", 
             RowBox[{"Floor", "[", 
              RowBox[{"Log", "[", 
               RowBox[{"2", ",", " ", "\n", "           ", 
                RowBox[{"1", " ", "-", " ", 
                 RowBox[{"Log", "[", 
                  RowBox[{"2", ",", " ", 
                   RowBox[{
                    RowBox[{"u2g", "[", 
                    RowBox[{"v", " ", "+", " ", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"exQ", "[", "v", "]"}], ",", " ", "ubitmask", ",",
                     " ", "0"}], "]"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "\n", "              ", "2"}], "]"}], 
                    "]"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}], ";", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x2u", "[", 
             RowBox[{"2", "^", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"2", "^", "n"}]}], " ", "+", " ", "1"}], ")"}]}], 
             "]"}], " ", "-", " ", "ubitmask"}], "}"}]}], ",", " ", "\n", 
         "      ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"u", " ", "==", " ", "v"}], ",", " ", 
           RowBox[{"{", "u", "}"}], ",", " ", "ub"}], "]"}]}], "]"}]}]}], 
     "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"unify", "[", 
   RowBox[{"ub_", " ", "/;", " ", 
    RowBox[{"uboundQ", "[", "ub", "]"}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", " ", "=", " ", 
       RowBox[{"ub", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
      RowBox[{"v", " ", "=", " ", 
       RowBox[{"ub", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}]}]}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"u", " ", "==", " ", "qNaNu"}], " ", "||", " ", 
       RowBox[{"u", " ", "==", " ", "sNaNu"}], " ", "||", " ", 
       RowBox[{"v", " ", "==", " ", "qNaNu"}], " ", "||", " ", 
       RowBox[{"v", " ", "==", " ", "sNaNu"}]}], ",", " ", "\n", "    ", 
      RowBox[{"{", "qNaNu", "}"}], ",", " ", 
      RowBox[{
       RowBox[{"u", " ", "==", " ", "posinfu"}], " ", "&&", " ", 
       RowBox[{"v", " ", "==", " ", "posinfu"}]}], ",", " ", 
      RowBox[{"{", "posinfu", "}"}], ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"u", " ", "==", " ", "neginfu"}], " ", "&&", " ", 
       RowBox[{"v", " ", "==", " ", "neginfu"}]}], ",", " ", 
      RowBox[{"{", "neginfu", "}"}], ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"u", " ", "==", " ", "neginfu"}], " ", "||", " ", 
       RowBox[{"u", " ", "==", " ", "posinfu"}], " ", "||", " ", 
       RowBox[{"v", " ", "==", " ", "neginfu"}], " ", "||", " ", "\n", 
       "     ", 
       RowBox[{"v", " ", "==", " ", "posinfu"}], " ", "||", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ltuQ", "[", 
          RowBox[{
           RowBox[{"{", "u", "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"x2u", "[", "0", "]"}], "}"}]}], "]"}], " ", "&&", " ", 
         "\n", "       ", 
         RowBox[{"!", 
          RowBox[{"ltuQ", "[", 
           RowBox[{
            RowBox[{"{", "v", "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"x2u", "[", "0", "]"}], "}"}]}], "]"}]}]}], ")"}]}], ",",
       " ", "ub", ",", " ", 
      RowBox[{
       RowBox[{"ltuQ", "[", 
        RowBox[{
         RowBox[{"{", "u", "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"x2u", "[", "0", "]"}], "}"}]}], "]"}], " ", "&&", " ", 
       "\n", "     ", 
       RowBox[{"ltuQ", "[", 
        RowBox[{
         RowBox[{"{", "v", "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"x2u", "[", "0", "]"}], "}"}]}], "]"}]}], ",", " ", 
      RowBox[{"negateu", "[", 
       RowBox[{"unifypos", "[", 
        RowBox[{"negateu", "[", "ub", "]"}], "]"}], "]"}], ",", " ", "\n", 
      "    ", 
      RowBox[{
       RowBox[{"u2g", "[", "u", "]"}], " ", "===", " ", 
       RowBox[{"u2g", "[", "v", "]"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"Min", "[", 
        RowBox[{"u", ",", " ", "v"}], "]"}], "}"}], ",", " ", "True", ",", 
      " ", 
      RowBox[{"unifypos", "[", "ub", "]"}]}], "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"smartunify", "[", 
   RowBox[{"ub_", ",", " ", "ratio_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"g", " ", "=", " ", 
       RowBox[{"u2g", "[", "ub", "]"}]}], ",", " ", 
      RowBox[{"v", " ", "=", " ", 
       RowBox[{"unify", "[", "ub", "]"}]}], ",", " ", "\n", "    ", 
      "widthbefore", ",", " ", "widthafter", ",", " ", "nbitsbefore", ",", 
      " ", "nbitsafter"}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{"widthbefore", " ", "=", " ", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "-", " ", 
       RowBox[{"g", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ";", " ", "\n", "    ", 
     RowBox[{"widthafter", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"u2g", "[", "v", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "-", " ", 
       RowBox[{
        RowBox[{"u2g", "[", "v", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ";", " ", "\n", "    ", 
     RowBox[{"nbitsbefore", " ", "=", " ", 
      RowBox[{"nbits", "[", "ub", "]"}]}], ";", " ", 
     RowBox[{"nbitsafter", " ", "=", " ", 
      RowBox[{"nbits", "[", "v", "]"}]}], ";", " ", "\n", "    ", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"widthafter", " ", "==", " ", "Infinity"}], ",", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ratio", " ", ">=", " ", "1"}], ",", " ", "v", ",", " ", 
         "ub"}], "]"}], ",", " ", "\n", "     ", 
       RowBox[{"widthafter", " ", "==", " ", "0"}], ",", " ", "v", ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"widthbefore", "/", "widthafter"}], ")"}], "*", "\n", 
         "       ", 
         RowBox[{"(", 
          RowBox[{"nbitsbefore", "/", "nbitsafter"}], ")"}]}], " ", ">=", " ",
         "ratio"}], ",", " ", "v", ",", " ", "True", ",", " ", "ub"}], 
      "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ubleft", "[", "xleft_List", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"open", " ", "=", " ", 
       RowBox[{"xleft", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"u", " ", "=", " ", 
       RowBox[{"x2u", "[", 
        RowBox[{"xleft", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", " ", 
      RowBox[{"x", " ", "=", " ", 
       RowBox[{"xleft", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{"x", " ", "==", " ", 
       RowBox[{"-", "Infinity"}]}], ",", " ", 
      RowBox[{"If", "[", 
       RowBox[{"open", ",", " ", "negopeninfu", ",", " ", "neginfu"}], "]"}], 
      ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"u2f", "[", "u", "]"}], " ", "===", " ", "x"}], ",", " ", 
      RowBox[{"If", "[", 
       RowBox[{"open", ",", " ", 
        RowBox[{"BitOr", "[", 
         RowBox[{
          RowBox[{"u", " ", "-", " ", 
           RowBox[{"ulpu", "*", 
            RowBox[{"Boole", "[", 
             RowBox[{"x", " ", "<", " ", "0"}], "]"}]}]}], ",", " ", "\n", 
          "      ", "ubitmask"}], "]"}], ",", " ", "u"}], "]"}], ",", " ", 
      "True", ",", " ", 
      RowBox[{"BitOr", "[", 
       RowBox[{"u", ",", " ", 
        RowBox[{
         RowBox[{"Boole", "[", "open", "]"}], "*", "ubitmask"}]}], "]"}]}], 
     "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ubright", "[", "xright_List", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"open", " ", "=", " ", 
       RowBox[{"xright", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"u", " ", "=", " ", 
       RowBox[{"x2u", "[", 
        RowBox[{"xright", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", " ", 
      RowBox[{"x", " ", "=", " ", 
       RowBox[{"xright", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{"x", " ", "==", " ", "Infinity"}], ",", " ", 
      RowBox[{"If", "[", 
       RowBox[{"open", ",", " ", "posopeninfu", ",", " ", "posinfu"}], "]"}], 
      ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"x", " ", "==", " ", "0"}], " ", "&&", " ", "open"}], ",", " ",
       "negopenzerou", ",", " ", 
      RowBox[{
       RowBox[{"u2f", "[", "u", "]"}], " ", "===", " ", "x"}], ",", " ", "\n",
       "    ", 
      RowBox[{"If", "[", 
       RowBox[{"open", ",", " ", 
        RowBox[{"BitOr", "[", 
         RowBox[{
          RowBox[{"u", " ", "-", " ", 
           RowBox[{"ulpu", "*", 
            RowBox[{"Boole", "[", 
             RowBox[{"x", " ", ">=", " ", "0"}], "]"}]}]}], ",", " ", 
          "ubitmask"}], "]"}], ",", " ", "u"}], "]"}], ",", " ", "True", ",", 
      " ", "\n", "    ", 
      RowBox[{"BitOr", "[", 
       RowBox[{"u", ",", " ", 
        RowBox[{
         RowBox[{"Boole", "[", "open", "]"}], "*", "ubitmask"}]}], "]"}]}], 
     "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"g2u", "[", 
   RowBox[{"g_", " ", "/;", " ", 
    RowBox[{"gQ", "[", "g", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ulo", " ", "=", " ", 
       RowBox[{"x2u", "[", 
        RowBox[{"g", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ",", " ", "\n", 
      "    ", 
      RowBox[{"uhi", " ", "=", " ", 
       RowBox[{"x2u", "[", 
        RowBox[{"g", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}]}], ",", " ", 
      RowBox[{"blo", " ", "=", " ", 
       RowBox[{"g", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", " ", 
      RowBox[{"bhi", " ", "=", " ", 
       RowBox[{"g", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", " ", "\n", 
    "   ", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ulo", " ", "==", " ", "qNaNu"}], " ", "||", " ", 
       RowBox[{"uhi", " ", "===", " ", "qNaNu"}], " ", "||", " ", "\n", 
       "     ", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", ">", " ", 
        RowBox[{"g", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", "||", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "==", " ", 
          RowBox[{"g", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", "&&", " ", "\n", 
         "      ", 
         RowBox[{"(", 
          RowBox[{"blo", " ", "||", " ", "bhi"}], ")"}]}], ")"}]}], ",", " ", 
      
      RowBox[{"{", "qNaNu", "}"}], ",", " ", 
      RowBox[{
       RowBox[{"ulo", " ", "==", " ", "uhi"}], " ", "&&", "  ", 
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{"Xor", "[", 
          RowBox[{"blo", ",", " ", "bhi"}], "]"}], ")"}]}]}], ",", " ", "\n", 
      "    ", 
      RowBox[{"{", 
       RowBox[{"x2u", "[", 
        RowBox[{"g", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "}"}], ",", " ", 
      "True", ",", " ", "\n", "    ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"u1", " ", "=", " ", 
           RowBox[{"ubleft", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"g", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", "blo"}], 
             "}"}], "]"}]}], ",", " ", "\n", "      ", 
          RowBox[{"u2", " ", "=", " ", 
           RowBox[{"ubright", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"g", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", " ", "bhi"}], 
             "}"}], "]"}]}]}], "}"}], ",", " ", "\n", "     ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"u2g", "[", 
            RowBox[{"unify", "[", 
             RowBox[{"{", 
              RowBox[{"u1", ",", " ", "u2"}], "}"}], "]"}], "]"}], " ", "===",
            " ", 
           RowBox[{"u2g", "[", 
            RowBox[{"{", 
             RowBox[{"u1", ",", " ", "u2"}], "}"}], "]"}]}], ",", " ", "\n", 
          "      ", 
          RowBox[{"unify", "[", 
           RowBox[{"{", 
            RowBox[{"u1", ",", " ", "u2"}], "}"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"u1", ",", " ", "u2"}], "}"}]}], "]"}]}], "]"}]}], "]"}]}],
    "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ltgQ", "[", 
   RowBox[{
    RowBox[{"g_", " ", "/;", " ", 
     RowBox[{"gQ", "[", "g", "]"}]}], ",", " ", 
    RowBox[{"h_", " ", "/;", " ", 
     RowBox[{"gQ", "[", "h", "]"}]}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"Which", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "===", " ", "NaN"}], " ", 
     "||", " ", 
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "===", " ", "NaN"}], " ", 
     "||", " ", "\n", "    ", 
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "===", " ", "NaN"}], " ", 
     "||", " ", 
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "===", " ", "NaN"}]}], 
    ",", " ", "False", ",", " ", "True", ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "<", " ", 
      RowBox[{"h", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "||", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "==", " ", 
        RowBox[{"h", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "&&", " ", "\n", 
       "     ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "||", " ", 
         RowBox[{"h", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ")"}]}], ")"}]}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ltuQ", "[", 
   RowBox[{
    RowBox[{"u_", " ", "/;", " ", 
     RowBox[{"uQ", "[", "u", "]"}]}], ",", " ", 
    RowBox[{"v_", " ", "/;", " ", 
     RowBox[{"uQ", "[", "v", "]"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"ltgQ", "[", 
   RowBox[{
    RowBox[{"u2g", "[", "u", "]"}], ",", " ", 
    RowBox[{"u2g", "[", "v", "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"(", "u_", ")"}], " ", "\[Precedes]", " ", 
   RowBox[{"(", "v_", ")"}]}], " ", ":=", " ", 
  RowBox[{"ltuQ", "[", 
   RowBox[{"u", ",", " ", "v"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"gtgQ", "[", 
   RowBox[{
    RowBox[{"g_", " ", "/;", " ", 
     RowBox[{"gQ", "[", "g", "]"}]}], ",", " ", 
    RowBox[{"h_", " ", "/;", " ", 
     RowBox[{"gQ", "[", "h", "]"}]}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"Which", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "===", " ", "NaN"}], " ", 
     "||", " ", 
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "===", " ", "NaN"}], " ", 
     "||", " ", "\n", "    ", 
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "===", " ", "NaN"}], " ", 
     "||", " ", 
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "===", " ", "NaN"}]}], 
    ",", " ", "False", ",", " ", "True", ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", ">", " ", 
      RowBox[{"h", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", "||", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "==", " ", 
        RowBox[{"h", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", "&&", " ", "\n", 
       "     ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", "||", " ", 
         RowBox[{"h", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ")"}]}], ")"}]}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"gtuQ", "[", 
   RowBox[{
    RowBox[{"u_", " ", "/;", " ", 
     RowBox[{"uQ", "[", "u", "]"}]}], ",", " ", 
    RowBox[{"v_", " ", "/;", " ", 
     RowBox[{"uQ", "[", "v", "]"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"gtgQ", "[", 
   RowBox[{
    RowBox[{"u2g", "[", "u", "]"}], ",", " ", 
    RowBox[{"u2g", "[", "v", "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"(", "u_", ")"}], " ", "\[Succeeds]", " ", 
   RowBox[{"(", "v_", ")"}]}], " ", ":=", " ", 
  RowBox[{"gtuQ", "[", 
   RowBox[{"u", ",", " ", "v"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"neqgQ", "[", 
   RowBox[{
    RowBox[{"g_", " ", "/;", " ", 
     RowBox[{"gQ", "[", "g", "]"}]}], ",", " ", 
    RowBox[{"h_", " ", "/;", " ", 
     RowBox[{"gQ", "[", "h", "]"}]}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"Which", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "===", " ", "NaN"}], " ", 
     "||", " ", 
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "===", " ", "NaN"}], " ", 
     "||", " ", "\n", "    ", 
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "===", " ", "NaN"}], " ", 
     "||", " ", 
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "===", " ", "NaN"}]}], 
    ",", " ", "False", ",", " ", "True", ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{"ltgQ", "[", 
      RowBox[{"g", ",", " ", "h"}], "]"}], " ", "||", " ", 
     RowBox[{"gtgQ", "[", 
      RowBox[{"g", ",", " ", "h"}], "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"nequQ", "[", 
   RowBox[{
    RowBox[{"u_", " ", "/;", " ", 
     RowBox[{"uQ", "[", "u", "]"}]}], ",", " ", 
    RowBox[{"v_", " ", "/;", " ", 
     RowBox[{"uQ", "[", "v", "]"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"neqgQ", "[", 
   RowBox[{
    RowBox[{"u2g", "[", "u", "]"}], ",", " ", 
    RowBox[{"u2g", "[", "v", "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"(", "u_", ")"}], " ", "\[NotTildeTilde]", " ", 
   RowBox[{"(", "v_", ")"}]}], " ", ":=", " ", 
  RowBox[{"nequQ", "[", 
   RowBox[{"u", ",", " ", "v"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"nneqgQ", "[", 
   RowBox[{
    RowBox[{"g_", " ", "/;", " ", 
     RowBox[{"gQ", "[", "g", "]"}]}], ",", " ", 
    RowBox[{"h_", " ", "/;", " ", 
     RowBox[{"gQ", "[", "h", "]"}]}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"Which", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "===", " ", "NaN"}], " ", 
     "||", " ", 
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "===", " ", "NaN"}], " ", 
     "||", " ", "\n", "    ", 
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "===", " ", "NaN"}], " ", 
     "||", " ", 
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "===", " ", "NaN"}]}], 
    ",", " ", "False", ",", " ", "True", ",", " ", "\n", "    ", 
    RowBox[{"!", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ltgQ", "[", 
        RowBox[{"g", ",", " ", "h"}], "]"}], " ", "||", " ", 
       RowBox[{"gtgQ", "[", 
        RowBox[{"g", ",", " ", "h"}], "]"}]}], ")"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"nnequQ", "[", 
   RowBox[{
    RowBox[{"u_", " ", "/;", " ", 
     RowBox[{"uQ", "[", "u", "]"}]}], ",", " ", 
    RowBox[{"v_", " ", "/;", " ", 
     RowBox[{"uQ", "[", "v", "]"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"nneqgQ", "[", 
   RowBox[{
    RowBox[{"u2g", "[", "u", "]"}], ",", " ", 
    RowBox[{"u2g", "[", "v", "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"(", "u_", ")"}], " ", "\[TildeTilde]", " ", 
   RowBox[{"(", "v_", ")"}]}], " ", ":=", " ", 
  RowBox[{"nnequQ", "[", 
   RowBox[{"u", ",", " ", "v"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"samegQ", "[", 
   RowBox[{
    RowBox[{"g_", " ", "/;", " ", 
     RowBox[{"gQ", "[", "g", "]"}]}], ",", " ", 
    RowBox[{"h_", " ", "/;", " ", 
     RowBox[{"gQ", "[", "h", "]"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"g", " ", "===", " ", "h"}]}], "\n", 
 RowBox[{
  RowBox[{"sameuQ", "[", 
   RowBox[{
    RowBox[{"u_", " ", "/;", " ", 
     RowBox[{"uQ", "[", "u", "]"}]}], ",", " ", 
    RowBox[{"v_", " ", "/;", " ", 
     RowBox[{"uQ", "[", "v", "]"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"samegQ", "[", 
   RowBox[{
    RowBox[{"u2g", "[", "u", "]"}], ",", " ", 
    RowBox[{"u2g", "[", "v", "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"(", "u_", ")"}], " ", "\[Congruent]", " ", 
   RowBox[{"(", "v_", ")"}]}], " ", ":=", " ", 
  RowBox[{"sameuQ", "[", 
   RowBox[{"u", ",", " ", "v"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"intersectg", "[", 
   RowBox[{
    RowBox[{"g_", " ", "/;", " ", 
     RowBox[{"gQ", "[", "g", "]"}]}], ",", " ", 
    RowBox[{"h_", " ", "/;", " ", 
     RowBox[{"gQ", "[", "h", "]"}]}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"glo", " ", "=", " ", 
       RowBox[{"g", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", " ", 
      RowBox[{"ghi", " ", "=", " ", 
       RowBox[{"g", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", " ", 
      RowBox[{"glob", " ", "=", " ", 
       RowBox[{"g", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"ghib", " ", "=", " ", 
       RowBox[{"g", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", " ", 
      RowBox[{"hlo", " ", "=", " ", 
       RowBox[{"h", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", " ", 
      RowBox[{"hhi", " ", "=", " ", 
       RowBox[{"h", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"hlob", " ", "=", " ", 
       RowBox[{"h", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", " ", 
      RowBox[{"hhib", " ", "=", " ", 
       RowBox[{"h", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", " ", "\n", 
    "   ", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"glo", " ", "===", " ", "NaN"}], " ", "||", " ", 
       RowBox[{"ghi", " ", "===", " ", "NaN"}], " ", "||", " ", 
       RowBox[{"hlo", " ", "===", " ", "NaN"}], " ", "||", " ", "\n", "     ", 
       RowBox[{"hhi", " ", "===", " ", "NaN"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"NaN", ",", " ", "NaN"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], ",", " ", "\n", 
      "    ", 
      RowBox[{
       RowBox[{"glo", " ", "<", " ", "hlo"}], " ", "||", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"glo", " ", "==", " ", "hlo"}], " ", "&&", " ", "hlob"}], 
        ")"}]}], ",", " ", "\n", "    ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ghi", " ", "<", " ", "hlo"}], " ", "||", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ghi", " ", "==", " ", "hlo"}], " ", "&&", " ", 
           RowBox[{"(", 
            RowBox[{"ghib", " ", "||", " ", "hlob"}], ")"}]}], ")"}]}], ",", 
        " ", "\n", "     ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"NaN", ",", " ", "NaN"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], ",", " ", 
        RowBox[{
         RowBox[{"ghi", " ", "<", " ", "hhi"}], " ", "||", " ", "\n", 
         "      ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ghi", " ", "==", " ", "hhi"}], " ", "&&", " ", 
           RowBox[{"(", 
            RowBox[{"ghib", " ", "||", "  ", 
             RowBox[{"!", "hhib"}]}], ")"}]}], ")"}]}], ",", " ", "\n", 
        "     ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"hlo", ",", " ", "ghi"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"hlob", ",", " ", "ghib"}], "}"}]}], "}"}], ",", " ", 
        "True", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"hlo", ",", " ", "hhi"}], "}"}], ",", " ", "\n", "      ", 
          
          RowBox[{"{", 
           RowBox[{"hlob", ",", " ", "hhib"}], "}"}]}], "}"}]}], "]"}], ",", 
      " ", 
      RowBox[{
       RowBox[{"glo", " ", "<", " ", "hhi"}], " ", "||", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"glo", " ", "==", " ", "hhi"}], " ", "&&", " ", "\n", 
         "      ", 
         RowBox[{"(", " ", 
          RowBox[{
           RowBox[{"!", "glob"}], " ", "&&", "  ", 
           RowBox[{"!", "hhib"}]}], ")"}]}], ")"}]}], ",", " ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ghi", " ", "<", " ", "hhi"}], " ", "||", " ", "\n", 
         "      ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ghi", " ", "==", " ", "hhi"}], " ", "&&", " ", 
           RowBox[{"(", 
            RowBox[{"ghib", " ", "||", "  ", 
             RowBox[{"!", "hhib"}]}], ")"}]}], ")"}]}], ",", " ", "\n", 
        "     ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"glo", ",", " ", "ghi"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"glob", ",", " ", "ghib"}], "}"}]}], "}"}], ",", " ", 
        "True", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"glo", ",", " ", "hhi"}], "}"}], ",", " ", "\n", "      ", 
          
          RowBox[{"{", 
           RowBox[{"glob", ",", " ", "hhib"}], "}"}]}], "}"}]}], "]"}], ",", 
      " ", "True", ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"NaN", ",", " ", "NaN"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}]}], "]"}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"intersectu", "[", 
   RowBox[{
    RowBox[{"u_", " ", "/;", " ", 
     RowBox[{"uQ", "[", "u", "]"}]}], ",", " ", 
    RowBox[{"v_", " ", "/;", " ", 
     RowBox[{"uQ", "[", "v", "]"}]}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"g2u", "[", 
   RowBox[{"intersectg", "[", 
    RowBox[{
     RowBox[{"u2g", "[", "u", "]"}], ",", " ", 
     RowBox[{"u2g", "[", "v", "]"}]}], "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"reportdatamotion", "[", 
   RowBox[{"numbersmoved_", ",", " ", "ubitsmoved_"}], "]"}], " ", ":=", " ", 
  "\n", "  ", 
  RowBox[{"Grid", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Numbers moved\>\"", ",", " ", "\"\<Text\>\""}], "]"}], 
        ",", " ", 
        RowBox[{"Style", "[", 
         RowBox[{"numbersmoved", ",", " ", "\n", "      ", "\"\<Text\>\""}], 
         "]"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Unum bits moved\>\"", ",", " ", "\"\<Text\>\""}], "]"}],
         ",", " ", "\n", "     ", 
        RowBox[{"Style", "[", 
         RowBox[{"ubitsmoved", ",", " ", "\"\<Text\>\""}], "]"}]}], "}"}], 
      ",", " ", "\n", "    ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<Average bits per number\>\"", ",", " ", "\"\<Text\>\"", ",", 
          " ", "Bold"}], "]"}], ",", " ", "\n", "     ", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"ubitsmoved", "/", "numbersmoved"}], ",", " ", "3"}], 
           "]"}], ",", " ", "\"\<Text\>\"", ",", " ", "Bold"}], "]"}]}], 
       "}"}]}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{"Frame", " ", "->", " ", "All"}], ",", " ", 
    RowBox[{"Background", " ", "->", " ", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"LightGreen", ",", " ", "None"}], "}"}], "}"}]}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"plusg", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xlo_", ",", " ", "xhi_"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"xlob_", ",", " ", "xhib_"}], "}"}]}], "}"}], ",", " ", "\n", 
    "   ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ylo_", ",", " ", "yhi_"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"ylob_", ",", " ", "yhib_"}], "}"}]}], "}"}]}], "]"}], " ", ":=",
   " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "sumleft", ",", " ", "sumright", ",", " ", "openleft", ",", " ", 
      "openright"}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"xlo", " ", "===", " ", "NaN"}], " ", "||", " ", 
       RowBox[{"xhi", " ", "===", " ", "NaN"}], " ", "||", " ", 
       RowBox[{"ylo", " ", "===", " ", "NaN"}], " ", "||", " ", 
       RowBox[{"yhi", " ", "===", " ", "NaN"}]}], ",", " ", "\n", "    ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"NaN", ",", " ", "NaN"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], ",", " ", "\n", 
      "    ", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"sumleft", ",", " ", "openleft"}], "}"}], " ", "=", " ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"xlo", " ", "==", " ", 
            RowBox[{"-", "Infinity"}]}], " ", "&&", "  ", 
           RowBox[{"!", "xlob"}]}], ",", " ", "\n", "       ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ylo", " ", "==", " ", "Infinity"}], " ", "&&", "  ", 
             RowBox[{"!", "ylob"}]}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"NaN", ",", " ", "open"}], "}"}], ",", " ", "\n", 
            "        ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "Infinity"}], ",", " ", "closed"}], "}"}]}], "]"}],
           ",", " ", 
          RowBox[{
           RowBox[{"ylo", " ", "==", " ", 
            RowBox[{"-", "Infinity"}]}], " ", "&&", "  ", 
           RowBox[{"!", "ylob"}]}], ",", " ", "\n", "       ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"xlo", " ", "==", " ", "Infinity"}], " ", "&&", "  ", 
             RowBox[{"!", "xlob"}]}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"NaN", ",", " ", "open"}], "}"}], ",", " ", "\n", 
            "        ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "Infinity"}], ",", " ", "closed"}], "}"}]}], "]"}],
           ",", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"xlo", " ", "==", " ", "Infinity"}], " ", "&&", "  ", 
             RowBox[{"!", "xlob"}]}], ")"}], " ", "||", " ", "\n", "        ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ylo", " ", "==", " ", "Infinity"}], " ", "&&", "  ", 
             RowBox[{"!", "ylob"}]}], ")"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"Infinity", ",", " ", "closed"}], "}"}], ",", " ", "\n", 
          "       ", 
          RowBox[{"xlo", " ", "==", " ", 
           RowBox[{"-", "Infinity"}]}], ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ylo", " ", "==", " ", "Infinity"}], " ", "&&", "  ", 
             RowBox[{"!", "ylob"}]}], ",", " ", "\n", "        ", 
            RowBox[{"{", 
             RowBox[{"Infinity", ",", " ", "closed"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "Infinity"}], ",", " ", "open"}], "}"}]}], "]"}], 
          ",", " ", "\n", "       ", 
          RowBox[{"ylo", " ", "==", " ", 
           RowBox[{"-", "Infinity"}]}], ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"xlo", " ", "==", " ", "Infinity"}], " ", "&&", "  ", 
             RowBox[{"!", "xlob"}]}], ",", " ", "\n", "        ", 
            RowBox[{"{", 
             RowBox[{"Infinity", ",", " ", "closed"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "Infinity"}], ",", " ", "open"}], "}"}]}], "]"}], 
          ",", " ", "True", ",", " ", "\n", "       ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xlo", " ", "+", " ", "ylo"}], ",", " ", 
            RowBox[{"xlob", " ", "||", " ", "ylob"}]}], "}"}]}], "]"}]}], ";",
        " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"sumright", ",", " ", "openright"}], "}"}], " ", "=", " ", 
        "\n", "      ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"xhi", " ", "==", " ", 
            RowBox[{"-", "Infinity"}]}], " ", "&&", "  ", 
           RowBox[{"!", "xhib"}]}], ",", " ", "\n", "       ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"yhi", " ", "==", " ", "Infinity"}], " ", "&&", "  ", 
             RowBox[{"!", "yhib"}]}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"NaN", ",", " ", "open"}], "}"}], ",", " ", "\n", 
            "        ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "Infinity"}], ",", " ", "closed"}], "}"}]}], "]"}],
           ",", " ", 
          RowBox[{
           RowBox[{"yhi", " ", "==", " ", 
            RowBox[{"-", "Infinity"}]}], " ", "&&", "  ", 
           RowBox[{"!", "yhib"}]}], ",", " ", "\n", "       ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"xhi", " ", "==", " ", "Infinity"}], " ", "&&", "  ", 
             RowBox[{"!", "xhib"}]}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"NaN", ",", " ", "open"}], "}"}], ",", " ", "\n", 
            "        ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "Infinity"}], ",", " ", "closed"}], "}"}]}], "]"}],
           ",", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"xhi", " ", "==", " ", "Infinity"}], " ", "&&", "  ", 
             RowBox[{"!", "xhib"}]}], ")"}], " ", "||", " ", "\n", "        ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"yhi", " ", "==", " ", "Infinity"}], " ", "&&", "  ", 
             RowBox[{"!", "yhib"}]}], ")"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"Infinity", ",", " ", "closed"}], "}"}], ",", " ", "\n", 
          "       ", 
          RowBox[{"xhi", " ", "==", " ", "Infinity"}], ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"yhi", " ", "==", " ", 
              RowBox[{"-", "Infinity"}]}], " ", "&&", "  ", 
             RowBox[{"!", "yhib"}]}], ",", " ", "\n", "        ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "Infinity"}], ",", " ", "closed"}], "}"}], ",", 
            " ", 
            RowBox[{"{", 
             RowBox[{"Infinity", ",", " ", "open"}], "}"}]}], "]"}], ",", " ",
           "\n", "       ", 
          RowBox[{"yhi", " ", "==", " ", "Infinity"}], ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"xhi", " ", "==", " ", 
              RowBox[{"-", "Infinity"}]}], " ", "&&", "  ", 
             RowBox[{"!", "xhib"}]}], ",", " ", "\n", "        ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "Infinity"}], ",", " ", "closed"}], "}"}], ",", 
            " ", 
            RowBox[{"{", 
             RowBox[{"Infinity", ",", " ", "open"}], "}"}]}], "]"}], ",", " ",
           "True", ",", " ", "\n", "       ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xhi", " ", "+", " ", "yhi"}], ",", " ", 
            RowBox[{"xhib", " ", "||", " ", "yhib"}]}], "}"}]}], "]"}]}], ";",
        " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"sumleft", ",", " ", "sumright"}], "}"}], ",", " ", "\n", 
         "      ", 
         RowBox[{"{", 
          RowBox[{"openleft", ",", " ", "openright"}], "}"}]}], "}"}]}]}], 
     "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"plusu", "[", 
     RowBox[{
      RowBox[{"u_", " ", "/;", " ", 
       RowBox[{"uQ", "[", "u", "]"}]}], ",", " ", 
      RowBox[{"v_", " ", "/;", " ", 
       RowBox[{"uQ", "[", "v", "]"}]}]}], "]"}], " ", ":=", " ", "\n", "   ", 
    
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"w", " ", "=", " ", 
        RowBox[{"g2u", "[", 
         RowBox[{"plusg", "[", 
          RowBox[{
           RowBox[{"u2g", "[", "u", "]"}], ",", " ", 
           RowBox[{"u2g", "[", "v", "]"}]}], "]"}], "]"}]}], "}"}], ",", " ", 
      "\n", "    ", 
      RowBox[{
       RowBox[{"ubitsmoved", " ", "+=", " ", 
        RowBox[{
         RowBox[{"nbits", "[", "u", "]"}], " ", "+", " ", 
         RowBox[{"nbits", "[", "v", "]"}], " ", "+", " ", 
         RowBox[{"nbits", "[", "w", "]"}]}]}], ";", " ", "\n", "     ", 
       RowBox[{"numbersmoved", " ", "+=", " ", "3"}], ";", " ", "w"}]}], 
     "]"}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"u_", " ", "/;", " ", 
     RowBox[{"uQ", "[", "u", "]"}]}], ")"}], " ", "\[CirclePlus]", " ", 
   RowBox[{"(", 
    RowBox[{"v_", " ", "/;", " ", 
     RowBox[{"uQ", "[", "v", "]"}]}], ")"}]}], " ", ":=", " ", 
  RowBox[{"plusu", "[", 
   RowBox[{"u", ",", " ", "v"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"negateg", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", " ", "y_"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"xb_", ",", " ", "yb_"}], "}"}]}], "}"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "y"}], ",", " ", 
      RowBox[{"-", "x"}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"yb", ",", " ", "xb"}], "}"}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"minusg", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xlo_", ",", " ", "xhi_"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"xlob_", ",", " ", "xhib_"}], "}"}]}], "}"}], ",", " ", "\n", 
    "   ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ylo_", ",", " ", "yhi_"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"ylob_", ",", " ", "yhib_"}], "}"}]}], "}"}]}], "]"}], " ", ":=",
   " ", "\n", "  ", 
  RowBox[{"plusg", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xlo", ",", " ", "xhi"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"xlob", ",", " ", "xhib"}], "}"}]}], "}"}], ",", " ", "\n", 
    "   ", 
    RowBox[{"negateg", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ylo", ",", " ", "yhi"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"ylob", ",", " ", "yhib"}], "}"}]}], "}"}], "]"}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"minusu", "[", 
   RowBox[{"u_", ",", " ", "v_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"w", " ", "=", " ", 
      RowBox[{"g2u", "[", 
       RowBox[{"minusg", "[", 
        RowBox[{
         RowBox[{"u2g", "[", "u", "]"}], ",", " ", 
         RowBox[{"u2g", "[", "v", "]"}]}], "]"}], "]"}]}], "}"}], ",", " ", 
    "\n", "   ", 
    RowBox[{
     RowBox[{"ubitsmoved", " ", "+=", " ", 
      RowBox[{
       RowBox[{"nbits", "[", "u", "]"}], " ", "+", " ", 
       RowBox[{"nbits", "[", "v", "]"}], " ", "+", " ", 
       RowBox[{"nbits", "[", "w", "]"}]}]}], ";", " ", "\n", "    ", 
     RowBox[{"numbersmoved", " ", "+=", " ", "3"}], ";", " ", "w"}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"(", "u_", ")"}], " ", "\[CircleMinus]", " ", 
   RowBox[{"(", "v_", ")"}]}], " ", ":=", " ", 
  RowBox[{"minusu", "[", 
   RowBox[{"u", ",", " ", "v"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ubitsmoved", " ", "=", " ", 
    RowBox[{"numbersmoved", " ", "=", " ", "0"}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"needmoreexpQ", "[", 
     RowBox[{"u_", " ", "/;", " ", 
      RowBox[{"uQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"g", " ", "=", " ", 
        RowBox[{"u2g", "[", "u", "]"}]}], "}"}], ",", " ", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"g", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "==", " ", 
              RowBox[{"-", "maxreal"}]}], " ", "||", " ", 
             RowBox[{
              RowBox[{"g", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "==", " ", "\n", 
              "         ", 
              RowBox[{"-", "smallsubnormal"}]}]}], ")"}], " ", "&&", " ", 
           RowBox[{"g", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ")"}], " ", "||", " ", 
         "\n", "      ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"g", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "==", " ", 
              "maxreal"}], " ", "||", " ", 
             RowBox[{
              RowBox[{"g", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "==", " ", 
              "smallsubnormal"}]}], ")"}], " ", "&&", " ", "\n", "       ", 
           RowBox[{"g", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ")"}]}], ",", " ", 
        "True", ",", " ", "False"}], "]"}]}], "]"}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"relwidth", "[", 
     RowBox[{"u_", " ", "/;", " ", 
      RowBox[{"uQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lo", " ", "=", " ", 
         RowBox[{
          RowBox[{"u2g", "[", "u", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", " ", "\n", "     ", 
        RowBox[{"hi", " ", "=", " ", 
         RowBox[{
          RowBox[{"u2g", "[", "u", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", " ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"lo", " ", "===", " ", "NaN"}], ",", " ", "Infinity", ",", 
        " ", "\n", "     ", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", "lo", "]"}], " ", "==", " ", "Infinity"}], " ", 
         "||", " ", 
         RowBox[{
          RowBox[{"Abs", "[", "hi", "]"}], " ", "==", " ", "Infinity"}]}], 
        ",", " ", "1", ",", " ", "\n", "     ", 
        RowBox[{
         RowBox[{"lo", " ", "==", " ", "0"}], " ", "&&", " ", 
         RowBox[{"hi", " ", "==", " ", "0"}]}], ",", " ", "0", ",", " ", 
        "True", ",", " ", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"hi", " ", "-", " ", "lo"}], "]"}], "/", "\n", "      ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Abs", "[", "lo", "]"}], " ", "+", " ", 
           RowBox[{"Abs", "[", "hi", "]"}]}], ")"}]}]}], "]"}]}], "]"}]}], 
   ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{"needmorefracQ", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"uQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"relwidth", "[", "u", "]"}], " ", ">", " ", 
     "relwidthtolerance"}], ",", " ", "True", ",", " ", "False"}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"relwidthtolerance", " ", "=", " ", "0.001"}], ";"}], 
  " "}], "\n", 
 RowBox[{
  RowBox[{"timesposleft", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x_", ",", " ", "xb_"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"y_", ",", " ", "yb_"}], "}"}]}], "]"}], " ", ":=", " ", "\n", 
  "  ", 
  RowBox[{"Which", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "xb"}], "}"}], " ", "==", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "closed"}], "}"}]}], ",", " ", "\n", "   ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"y", ",", " ", "yb"}], "}"}], " ", "==", " ", 
       RowBox[{"{", 
        RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"NaN", ",", " ", "open"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "closed"}], "}"}]}], "]"}], ",", " ", "\n", 
    "   ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y", ",", " ", "yb"}], "}"}], " ", "==", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "closed"}], "}"}]}], ",", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", " ", "xb"}], "}"}], " ", "==", " ", 
       RowBox[{"{", 
        RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}], ",", " ", "\n", 
      "    ", 
      RowBox[{"{", 
       RowBox[{"NaN", ",", " ", "open"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "closed"}], "}"}]}], "]"}], ",", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "xb"}], "}"}], " ", "==", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "open"}], "}"}]}], ",", " ", "\n", "   ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"y", ",", " ", "yb"}], "}"}], " ", "==", " ", 
       RowBox[{"{", 
        RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"Infinity", ",", " ", "closed"}], "}"}], ",", " ", "\n", 
      "    ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "open"}], "}"}]}], "]"}], ",", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y", ",", " ", "yb"}], "}"}], " ", "==", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "open"}], "}"}]}], ",", " ", "\n", "   ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", " ", "xb"}], "}"}], " ", "==", " ", 
       RowBox[{"{", 
        RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"Infinity", ",", " ", "closed"}], "}"}], ",", " ", "\n", 
      "    ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "open"}], "}"}]}], "]"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", " ", "xb"}], "}"}], " ", "==", " ", 
      RowBox[{"{", 
       RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}], " ", "||", " ", 
     "\n", "    ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"y", ",", " ", "yb"}], "}"}], " ", "==", " ", 
      RowBox[{"{", 
       RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"Infinity", ",", " ", "closed"}], "}"}], ",", " ", "True", ",", 
    " ", "\n", "   ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "*", "y"}], ",", " ", 
      RowBox[{"xb", " ", "||", " ", "yb"}]}], "}"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"timesposright", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x_", ",", " ", "xb_"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"y_", ",", " ", "yb_"}], "}"}]}], "]"}], " ", ":=", " ", "\n", 
  "  ", 
  RowBox[{"Which", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "xb"}], "}"}], " ", "==", " ", 
     RowBox[{"{", 
      RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}], ",", " ", "\n", 
    "   ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"y", ",", " ", "yb"}], "}"}], " ", "==", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "closed"}], "}"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"NaN", ",", " ", "open"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}], "]"}], ",", " ", 
    "\n", "   ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y", ",", " ", "yb"}], "}"}], " ", "==", " ", 
     RowBox[{"{", 
      RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}], ",", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", " ", "xb"}], "}"}], " ", "==", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "closed"}], "}"}]}], ",", " ", "\n", "    ", 
      RowBox[{"{", 
       RowBox[{"NaN", ",", " ", "open"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}], "]"}], ",", " ", 
    "\n", "   ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "xb"}], "}"}], " ", "==", " ", 
     RowBox[{"{", 
      RowBox[{"Infinity", ",", " ", "open"}], "}"}]}], ",", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"y", ",", " ", "yb"}], "}"}], " ", "==", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "closed"}], "}"}]}], ",", " ", "\n", "    ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "closed"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"Infinity", ",", " ", "open"}], "}"}]}], "]"}], ",", " ", "\n",
     "   ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y", ",", " ", "yb"}], "}"}], " ", "==", " ", 
     RowBox[{"{", 
      RowBox[{"Infinity", ",", " ", "open"}], "}"}]}], ",", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", " ", "xb"}], "}"}], " ", "==", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "closed"}], "}"}]}], ",", " ", "\n", "    ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "closed"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"Infinity", ",", " ", "open"}], "}"}]}], "]"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", " ", "xb"}], "}"}], " ", "==", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "closed"}], "}"}]}], " ", "||", " ", "\n", 
     "    ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"y", ",", " ", "yb"}], "}"}], " ", "==", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "closed"}], "}"}]}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "closed"}], "}"}], ",", " ", "True", ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "*", "y"}], ",", " ", 
      RowBox[{"xb", " ", "||", " ", "yb"}]}], "}"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"neg", "[", 
   RowBox[{"{", 
    RowBox[{"x_", ",", " ", "xb_"}], "}"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", "x"}], ",", " ", "xb"}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"unionfix", "[", 
   RowBox[{"end1_", ",", " ", "end2_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"temp", " ", "=", " ", 
       RowBox[{"Union", "[", 
        RowBox[{"end1", ",", " ", "end2"}], "]"}]}], ",", " ", "e1", ",", " ",
       "\n", "    ", "e2"}], "}"}], ",", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "temp", "]"}], " ", "==", " ", "2"}], ",", " ", 
      
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"e1", ",", " ", "e2"}], "}"}], " ", "=", " ", "temp"}], ";", 
       " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"temp", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", "===", " ", 
          RowBox[{"-", "Infinity"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"e2", ",", " ", "e1"}], "}"}], ",", " ", "temp"}], "]"}]}], 
      ",", " ", "temp"}], "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"timesg", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xlo_", ",", " ", "xhi_"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"xlob_", ",", " ", "xhib_"}], "}"}]}], "}"}], ",", " ", "\n", 
    "   ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ylo_", ",", " ", "yhi_"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"ylob_", ",", " ", "yhib_"}], "}"}]}], "}"}]}], "]"}], " ", ":=",
   " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "timesleft", ",", " ", "timesright", ",", " ", "openleft", ",", " ", 
      "openright", ",", " ", "\n", "    ", 
      RowBox[{"lcan", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"rcan", " ", "=", " ", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"xlo", " ", "===", " ", "NaN"}], " ", "||", " ", 
       RowBox[{"xhi", " ", "===", " ", "NaN"}], " ", "||", " ", "\n", "     ", 
       RowBox[{"ylo", " ", "===", " ", "NaN"}], " ", "||", " ", 
       RowBox[{"yhi", " ", "===", " ", "NaN"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"NaN", ",", " ", "NaN"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], ",", " ", "\n", 
      "    ", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"xlo", " ", ">=", " ", "0"}], " ", "&&", " ", 
          RowBox[{"ylo", " ", ">=", " ", "0"}]}], ",", " ", 
         RowBox[{"lcan", " ", "=", " ", 
          RowBox[{"unionfix", "[", 
           RowBox[{"lcan", ",", " ", "\n", "        ", 
            RowBox[{"{", 
             RowBox[{"timesposleft", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"xlo", ",", " ", "xlob"}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"ylo", ",", " ", "ylob"}], "}"}]}], "]"}], "}"}]}], 
           "]"}]}]}], "]"}], ";", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"xhi", " ", "<", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xhi", " ", "==", " ", "0"}], " ", "&&", " ", "xhib"}], 
             ")"}]}], ")"}], " ", "&&", " ", "\n", "       ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"yhi", " ", "<", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"yhi", " ", "==", " ", "0"}], " ", "&&", " ", "yhib"}], 
             ")"}]}], ")"}]}], ",", " ", "\n", "      ", 
         RowBox[{"lcan", " ", "=", " ", 
          RowBox[{"unionfix", "[", 
           RowBox[{"lcan", ",", " ", 
            RowBox[{"{", 
             RowBox[{"timesposleft", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "xhi"}], ",", " ", "xhib"}], "}"}], ",", " ", 
               "\n", "          ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "yhi"}], ",", " ", "yhib"}], "}"}]}], "]"}], 
             "}"}]}], "]"}]}]}], "]"}], ";", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"xlo", " ", "<", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xlo", " ", "==", " ", "0"}], " ", "&&", "  ", 
              RowBox[{"!", "xlob"}]}], ")"}]}], ")"}], " ", "&&", " ", "\n", 
          "       ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"yhi", " ", ">", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"yhi", " ", "==", " ", "0"}], " ", "&&", "  ", 
              RowBox[{"!", "yhib"}]}], ")"}]}], ")"}]}], ",", " ", "\n", 
         "      ", 
         RowBox[{"lcan", " ", "=", " ", 
          RowBox[{"unionfix", "[", 
           RowBox[{"lcan", ",", " ", 
            RowBox[{"{", 
             RowBox[{"neg", "[", 
              RowBox[{"timesposright", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "xlo"}], ",", " ", "xlob"}], "}"}], ",", " ", 
                "\n", "           ", 
                RowBox[{"{", 
                 RowBox[{"yhi", ",", " ", "yhib"}], "}"}]}], "]"}], "]"}], 
             "}"}]}], "]"}]}]}], "]"}], ";", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"xhi", " ", ">", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xhi", " ", "==", " ", "0"}], " ", "&&", "  ", 
              RowBox[{"!", "xhib"}]}], ")"}]}], ")"}], " ", "&&", " ", "\n", 
          "       ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ylo", " ", "<", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ylo", " ", "==", " ", "0"}], " ", "&&", "  ", 
              RowBox[{"!", "ylob"}]}], ")"}]}], ")"}]}], ",", " ", "\n", 
         "      ", 
         RowBox[{"lcan", " ", "=", " ", 
          RowBox[{"unionfix", "[", 
           RowBox[{"lcan", ",", " ", 
            RowBox[{"{", 
             RowBox[{"neg", "[", 
              RowBox[{"timesposright", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"xhi", ",", " ", "xhib"}], "}"}], ",", " ", "\n", 
                "           ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "ylo"}], ",", " ", "ylob"}], "}"}]}], "]"}], 
              "]"}], "}"}]}], "]"}]}]}], "]"}], ";", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"xhi", " ", ">", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xhi", " ", "==", " ", "0"}], " ", "&&", "  ", 
              RowBox[{"!", "xhib"}]}], ")"}]}], ")"}], " ", "&&", " ", "\n", 
          "       ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"yhi", " ", ">", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"yhi", " ", "==", " ", "0"}], " ", "&&", "  ", 
              RowBox[{"!", "yhib"}]}], ")"}]}], ")"}]}], ",", " ", "\n", 
         "      ", 
         RowBox[{"rcan", " ", "=", " ", 
          RowBox[{"unionfix", "[", 
           RowBox[{"rcan", ",", " ", 
            RowBox[{"{", 
             RowBox[{"timesposright", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"xhi", ",", " ", "xhib"}], "}"}], ",", " ", "\n", 
               "          ", 
               RowBox[{"{", 
                RowBox[{"yhi", ",", " ", "yhib"}], "}"}]}], "]"}], "}"}]}], 
           "]"}]}]}], "]"}], ";", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"xlo", " ", "<", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xlo", " ", "==", " ", "0"}], " ", "&&", "  ", 
              RowBox[{"!", "xlob"}]}], ")"}]}], ")"}], " ", "&&", " ", "\n", 
          "       ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ylo", " ", "<", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ylo", " ", "==", " ", "0"}], " ", "&&", "  ", 
              RowBox[{"!", "ylob"}]}], ")"}]}], ")"}]}], ",", " ", "\n", 
         "      ", 
         RowBox[{"rcan", " ", "=", " ", 
          RowBox[{"unionfix", "[", 
           RowBox[{"rcan", ",", " ", 
            RowBox[{"{", 
             RowBox[{"timesposright", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "xlo"}], ",", " ", "xlob"}], "}"}], ",", " ", 
               "\n", "          ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "ylo"}], ",", " ", "ylob"}], "}"}]}], "]"}], 
             "}"}]}], "]"}]}]}], "]"}], ";", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"xhi", " ", "<", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xhi", " ", "==", " ", "0"}], " ", "&&", " ", "xhib"}], 
             ")"}]}], ")"}], " ", "&&", " ", 
          RowBox[{"ylo", " ", ">=", " ", "0"}]}], ",", " ", "\n", "      ", 
         RowBox[{"rcan", " ", "=", " ", 
          RowBox[{"unionfix", "[", 
           RowBox[{"rcan", ",", " ", 
            RowBox[{"{", 
             RowBox[{"neg", "[", 
              RowBox[{"timesposleft", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "xhi"}], ",", " ", "xhib"}], "}"}], ",", " ", 
                "\n", "           ", 
                RowBox[{"{", 
                 RowBox[{"ylo", ",", " ", "ylob"}], "}"}]}], "]"}], "]"}], 
             "}"}]}], "]"}]}]}], "]"}], ";", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"xlo", " ", ">=", " ", "0"}], " ", "&&", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"yhi", " ", "<", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"yhi", " ", "==", " ", "0"}], " ", "&&", " ", "yhib"}], 
             ")"}]}], ")"}]}], ",", " ", "\n", "      ", 
         RowBox[{"rcan", " ", "=", " ", 
          RowBox[{"unionfix", "[", 
           RowBox[{"rcan", ",", " ", 
            RowBox[{"{", 
             RowBox[{"neg", "[", 
              RowBox[{"timesposleft", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"xlo", ",", " ", "xlob"}], "}"}], ",", " ", "\n", 
                "           ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "yhi"}], ",", " ", "yhib"}], "}"}]}], "]"}], 
              "]"}], "}"}]}], "]"}]}]}], "]"}], ";", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", "lcan", "]"}], ",", " ", "NaN"}], "]"}], 
          " ", "||", " ", "\n", "       ", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", "rcan", "]"}], ",", " ", "NaN"}], "]"}]}],
          ",", " ", "\n", "      ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"timesleft", ",", " ", "timesright"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"openleft", ",", " ", "openright"}], "}"}]}], "}"}], " ",
           "=", " ", "\n", "       ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"NaN", ",", " ", "NaN"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}]}]}], "]"}], 
       ";", " ", "\n", "     ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"timesleft", ",", " ", "timesright"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"openleft", ",", " ", "openright"}], "}"}]}], "}"}], " ", 
        "=", " ", "\n", "      ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lcan", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
            RowBox[{"rcan", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
          " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lcan", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", " ", "\n", 
            "        ", 
            RowBox[{"rcan", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}]}], "}"}]}], 
         "}"}]}], ";", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "lcan", "]"}], " ", ">", " ", "1"}], ",", 
         " ", "\n", "      ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"lcan", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "==", " ", 
             RowBox[{"lcan", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}]}], " ", "&&", " ", 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"lcan", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", "||", " ", 
              "\n", "          ", 
              RowBox[{"!", 
               RowBox[{"lcan", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ")"}]}], ",", " ", 
           RowBox[{"openleft", " ", "=", " ", "closed"}]}], "]"}]}], "]"}], 
       ";", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "rcan", "]"}], " ", ">", " ", "1"}], ",", 
         " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"rcan", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], " ", "==", " ", 
             
             RowBox[{"rcan", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"-", "2"}], ",", "1"}], "]"}], "]"}]}], " ", "&&", 
            " ", "\n", "        ", 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"rcan", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}]}], " ", "||", 
              "  ", 
              RowBox[{"!", 
               RowBox[{"rcan", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "2"}], "]"}], "]"}]}]}], ")"}]}], 
           ",", " ", "\n", "       ", 
           RowBox[{"openright", " ", "=", " ", "closed"}]}], "]"}]}], "]"}], 
       ";", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"timesleft", ",", " ", "timesright"}], "}"}], ",", " ", 
         "\n", "      ", 
         RowBox[{"{", 
          RowBox[{"openleft", ",", " ", "openright"}], "}"}]}], "}"}]}]}], 
     "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"timesu", "[", 
   RowBox[{
    RowBox[{"u_", " ", "/;", " ", 
     RowBox[{"uQ", "[", "u", "]"}]}], ",", " ", 
    RowBox[{"v_", " ", "/;", " ", 
     RowBox[{"uQ", "[", "v", "]"}]}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"w", " ", "=", " ", 
      RowBox[{"g2u", "[", 
       RowBox[{"timesg", "[", 
        RowBox[{
         RowBox[{"u2g", "[", "u", "]"}], ",", " ", 
         RowBox[{"u2g", "[", "v", "]"}]}], "]"}], "]"}]}], "}"}], ",", " ", 
    "\n", "   ", 
    RowBox[{
     RowBox[{"ubitsmoved", " ", "+=", " ", 
      RowBox[{
       RowBox[{"nbits", "[", "u", "]"}], " ", "+", " ", 
       RowBox[{"nbits", "[", "v", "]"}], " ", "+", " ", 
       RowBox[{"nbits", "[", "w", "]"}]}]}], ";", " ", "\n", "    ", 
     RowBox[{"numbersmoved", " ", "+=", " ", "3"}], ";", " ", "w"}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"(", "u_", ")"}], " ", "\[CircleTimes]", " ", 
   RowBox[{"(", "v_", ")"}]}], " ", ":=", " ", 
  RowBox[{"timesu", "[", 
   RowBox[{"u", ",", " ", "v"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"spanszeroQ", "[", 
   RowBox[{"ub_", " ", "/;", " ", 
    RowBox[{"uboundQ", "[", "ub", "]"}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"g1", " ", "=", " ", 
       RowBox[{
        RowBox[{"u2g", "[", "ub", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", " ", 
      RowBox[{"g2", " ", "=", " ", 
       RowBox[{
        RowBox[{"u2g", "[", "ub", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"b1", " ", "=", " ", 
       RowBox[{
        RowBox[{"u2g", "[", "ub", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", " ", 
      RowBox[{"b2", " ", "=", " ", 
       RowBox[{
        RowBox[{"u2g", "[", "ub", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", " ", "\n", 
    "   ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"g1", " ", "==", " ", "0"}], " ", "&&", "  ", 
           RowBox[{"!", "b1"}]}], ")"}], " ", "||", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"g2", " ", "==", " ", "0"}], " ", "&&", "  ", 
           RowBox[{"!", "b2"}]}], ")"}]}], ")"}], " ", "||", " ", "\n", 
       "     ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g1", " ", "<", " ", "0"}], " ", "&&", " ", 
         RowBox[{"g2", " ", ">", " ", "0"}]}], ")"}]}], ",", " ", "True", ",",
       " ", "False"}], "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"divideposleft", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x_", ",", " ", "xb_"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"y_", ",", " ", "yb_"}], "}"}]}], "]"}], " ", ":=", " ", "\n", 
  "  ", 
  RowBox[{"Which", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y", ",", " ", "yb"}], "}"}], " ", "==", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "closed"}], "}"}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"NaN", ",", " ", "open"}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "xb"}], "}"}], " ", "==", " ", 
     RowBox[{"{", 
      RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}], ",", " ", "\n", 
    "   ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"y", ",", " ", "yb"}], "}"}], " ", "==", " ", 
       RowBox[{"{", 
        RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"NaN", ",", " ", "open"}], "}"}], ",", " ", "\n", "    ", 
      RowBox[{"{", 
       RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}], "]"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", " ", "xb"}], "}"}], " ", "==", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "closed"}], "}"}]}], " ", "||", " ", "\n", 
     "    ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"y", ",", " ", "yb"}], "}"}], " ", "==", " ", 
      RowBox[{"{", 
       RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "closed"}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", " ", "xb"}], "}"}], " ", "==", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "open"}], "}"}]}], " ", "||", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"y", ",", " ", "yb"}], "}"}], " ", "==", " ", 
      RowBox[{"{", 
       RowBox[{"Infinity", ",", " ", "open"}], "}"}]}]}], ",", " ", "\n", 
    "   ", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "open"}], "}"}], ",", " ", "True", ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "/", "y"}], ",", " ", 
      RowBox[{"xb", " ", "||", " ", "yb"}]}], "}"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"divideposright", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x_", ",", " ", "xb_"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"y_", ",", " ", "yb_"}], "}"}]}], "]"}], " ", ":=", " ", "\n", 
  "  ", 
  RowBox[{"Which", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y", ",", " ", "yb"}], "}"}], " ", "==", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "closed"}], "}"}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"NaN", ",", " ", "open"}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "xb"}], "}"}], " ", "==", " ", 
     RowBox[{"{", 
      RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}], ",", " ", "\n", 
    "   ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"y", ",", " ", "yb"}], "}"}], " ", "==", " ", 
       RowBox[{"{", 
        RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"NaN", ",", " ", "open"}], "}"}], ",", " ", "\n", "    ", 
      RowBox[{"{", 
       RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}], "]"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", " ", "xb"}], "}"}], " ", "==", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "closed"}], "}"}]}], " ", "||", " ", "\n", 
     "    ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"y", ",", " ", "yb"}], "}"}], " ", "==", " ", 
      RowBox[{"{", 
       RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "closed"}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", " ", "xb"}], "}"}], " ", "==", " ", 
      RowBox[{"{", 
       RowBox[{"Infinity", ",", " ", "open"}], "}"}]}], " ", "||", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"y", ",", " ", "yb"}], "}"}], " ", "==", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "open"}], "}"}]}]}], ",", " ", "\n", "   ", 
    RowBox[{"{", 
     RowBox[{"Infinity", ",", " ", "open"}], "}"}], ",", " ", "True", ",", 
    " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "/", "y"}], ",", " ", 
      RowBox[{"xb", " ", "||", " ", "yb"}]}], "}"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"divideg", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xlo_", ",", " ", "xhi_"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"xlob_", ",", " ", "xhib_"}], "}"}]}], "}"}], ",", " ", "\n", 
    "   ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ylo_", ",", " ", "yhi_"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"ylob_", ",", " ", "yhib_"}], "}"}]}], "}"}]}], "]"}], " ", ":=",
   " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "divleft", ",", " ", "divright", ",", " ", "openleft", ",", " ", 
      "openright", ",", " ", 
      RowBox[{"lcan", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ",", " ", "\n", "    ", 
      RowBox[{"rcan", " ", "=", " ", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"xlo", " ", "===", " ", "NaN"}], " ", "||", " ", 
       RowBox[{"xhi", " ", "===", " ", "NaN"}], " ", "||", " ", 
       RowBox[{"ylo", " ", "===", " ", "NaN"}], " ", "||", " ", "\n", "     ", 
       RowBox[{"yhi", " ", "===", " ", "NaN"}], " ", "||", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ylo", " ", "<", " ", "0"}], " ", "||", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ylo", " ", "==", " ", "0"}], " ", "&&", "  ", 
             RowBox[{"!", "ylob"}]}], ")"}]}], ")"}], " ", "&&", " ", "\n", 
         "      ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"yhi", " ", ">", " ", "0"}], " ", "||", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"yhi", " ", "==", " ", "0"}], " ", "&&", "  ", 
             RowBox[{"!", "yhib"}]}], ")"}]}], ")"}]}], ")"}]}], ",", " ", 
      "\n", "    ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"NaN", ",", " ", "NaN"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], ",", " ", "\n", 
      "    ", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"xlo", " ", ">=", " ", "0"}], " ", "&&", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"yhi", " ", ">", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"yhi", " ", "==", " ", "0"}], " ", "&&", "  ", 
              RowBox[{"!", "yhib"}]}], ")"}]}], ")"}]}], ",", " ", "\n", 
         "      ", 
         RowBox[{"lcan", " ", "=", " ", 
          RowBox[{"unionfix", "[", 
           RowBox[{"lcan", ",", " ", 
            RowBox[{"{", 
             RowBox[{"divideposleft", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"xlo", ",", " ", "xlob"}], "}"}], ",", " ", "\n", 
               "          ", 
               RowBox[{"{", 
                RowBox[{"yhi", ",", " ", "yhib"}], "}"}]}], "]"}], "}"}]}], 
           "]"}]}]}], "]"}], ";", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"xhi", " ", "<", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xhi", " ", "==", " ", "0"}], " ", "&&", " ", "xhib"}], 
             ")"}]}], ")"}], " ", "&&", " ", "\n", "       ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ylo", " ", "<", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ylo", " ", "==", " ", "0"}], " ", "&&", "  ", 
              RowBox[{"!", "ylob"}]}], ")"}]}], ")"}]}], ",", " ", "\n", 
         "      ", 
         RowBox[{"lcan", " ", "=", " ", 
          RowBox[{"unionfix", "[", 
           RowBox[{"lcan", ",", " ", 
            RowBox[{"{", 
             RowBox[{"divideposleft", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "xhi"}], ",", " ", "xhib"}], "}"}], ",", " ", 
               "\n", "          ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "ylo"}], ",", " ", "ylob"}], "}"}]}], "]"}], 
             "}"}]}], "]"}]}]}], "]"}], ";", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"xlo", " ", "<", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xlo", " ", "==", " ", "0"}], " ", "&&", "  ", 
              RowBox[{"!", "xlob"}]}], ")"}]}], ")"}], " ", "&&", " ", 
          RowBox[{"ylo", " ", ">=", " ", "0"}]}], ",", " ", "\n", "      ", 
         RowBox[{"lcan", " ", "=", " ", 
          RowBox[{"unionfix", "[", 
           RowBox[{"lcan", ",", " ", 
            RowBox[{"{", 
             RowBox[{"neg", "[", 
              RowBox[{"divideposright", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "xlo"}], ",", " ", "xlob"}], "}"}], ",", " ", 
                "\n", "           ", 
                RowBox[{"{", 
                 RowBox[{"ylo", ",", " ", "ylob"}], "}"}]}], "]"}], "]"}], 
             "}"}]}], "]"}]}]}], "]"}], ";", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"xhi", " ", ">", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xhi", " ", "==", " ", "0"}], " ", "&&", "  ", 
              RowBox[{"!", "xhib"}]}], ")"}]}], ")"}], " ", "&&", " ", "\n", 
          "       ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"yhi", " ", "<", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"yhi", " ", "==", " ", "0"}], " ", "&&", " ", "yhib"}], 
             ")"}]}], ")"}]}], ",", " ", "\n", "      ", 
         RowBox[{"lcan", " ", "=", " ", 
          RowBox[{"unionfix", "[", 
           RowBox[{"lcan", ",", " ", 
            RowBox[{"{", 
             RowBox[{"neg", "[", 
              RowBox[{"divideposright", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"xhi", ",", " ", "xhib"}], "}"}], ",", " ", "\n", 
                "           ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "yhi"}], ",", " ", "yhib"}], "}"}]}], "]"}], 
              "]"}], "}"}]}], "]"}]}]}], "]"}], ";", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"xhi", " ", ">", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xhi", " ", "==", " ", "0"}], " ", "&&", "  ", 
              RowBox[{"!", "xhib"}]}], ")"}]}], ")"}], " ", "&&", " ", 
          RowBox[{"ylo", " ", ">=", " ", "0"}]}], ",", " ", "\n", "      ", 
         RowBox[{"rcan", " ", "=", " ", 
          RowBox[{"unionfix", "[", 
           RowBox[{"rcan", ",", " ", 
            RowBox[{"{", 
             RowBox[{"divideposright", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"xhi", ",", " ", "xhib"}], "}"}], ",", " ", "\n", 
               "          ", 
               RowBox[{"{", 
                RowBox[{"ylo", ",", " ", "ylob"}], "}"}]}], "]"}], "}"}]}], 
           "]"}]}]}], "]"}], ";", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"xlo", " ", "<", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xlo", " ", "==", " ", "0"}], " ", "&&", "  ", 
              RowBox[{"!", "xlob"}]}], ")"}]}], ")"}], " ", "&&", " ", "\n", 
          "       ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"yhi", " ", "<", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"yhi", " ", "==", " ", "0"}], " ", "&&", " ", "yhib"}], 
             ")"}]}], ")"}]}], ",", " ", "\n", "      ", 
         RowBox[{"rcan", " ", "=", " ", 
          RowBox[{"unionfix", "[", 
           RowBox[{"rcan", ",", " ", 
            RowBox[{"{", 
             RowBox[{"divideposright", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "xlo"}], ",", " ", "xlob"}], "}"}], ",", " ", 
               "\n", "          ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "yhi"}], ",", " ", "yhib"}], "}"}]}], "]"}], 
             "}"}]}], "]"}]}]}], "]"}], ";", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"xhi", " ", "<", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xhi", " ", "==", " ", "0"}], " ", "&&", " ", "xhib"}], 
             ")"}]}], ")"}], " ", "&&", " ", "\n", "       ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"yhi", " ", ">", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"yhi", " ", "==", " ", "0"}], " ", "&&", "  ", 
              RowBox[{"!", "yhib"}]}], ")"}]}], ")"}]}], ",", " ", "\n", 
         "      ", 
         RowBox[{"rcan", " ", "=", " ", 
          RowBox[{"unionfix", "[", 
           RowBox[{"rcan", ",", " ", 
            RowBox[{"{", 
             RowBox[{"neg", "[", 
              RowBox[{"divideposleft", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "xhi"}], ",", " ", "xhib"}], "}"}], ",", " ", 
                "\n", "           ", 
                RowBox[{"{", 
                 RowBox[{"yhi", ",", " ", "yhib"}], "}"}]}], "]"}], "]"}], 
             "}"}]}], "]"}]}]}], "]"}], ";", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"xlo", " ", ">=", " ", "0"}], " ", "&&", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ylo", " ", "<", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ylo", " ", "==", " ", "0"}], " ", "&&", "  ", 
              RowBox[{"!", "ylob"}]}], ")"}]}], ")"}]}], ",", " ", "\n", 
         "      ", 
         RowBox[{"rcan", " ", "=", " ", 
          RowBox[{"unionfix", "[", 
           RowBox[{"rcan", ",", " ", 
            RowBox[{"{", 
             RowBox[{"neg", "[", 
              RowBox[{"divideposleft", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"xlo", ",", " ", "xlob"}], "}"}], ",", " ", "\n", 
                "           ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "ylo"}], ",", " ", "ylob"}], "}"}]}], "]"}], 
              "]"}], "}"}]}], "]"}]}]}], "]"}], ";", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", "lcan", "]"}], ",", " ", "NaN"}], "]"}], 
          " ", "||", " ", "\n", "       ", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", "rcan", "]"}], ",", " ", "NaN"}], "]"}]}],
          ",", " ", "\n", "      ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"divleft", ",", " ", "divright"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"openleft", ",", " ", "openright"}], "}"}]}], "}"}], " ",
           "=", " ", "\n", "       ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"NaN", ",", " ", "NaN"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}]}]}], "]"}], 
       ";", " ", "\n", "     ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"divleft", ",", " ", "divright"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"openleft", ",", " ", "openright"}], "}"}]}], "}"}], " ", 
        "=", " ", "\n", "      ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lcan", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
            RowBox[{"rcan", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
          " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lcan", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", " ", "\n", 
            "        ", 
            RowBox[{"rcan", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}]}], "}"}]}], 
         "}"}]}], ";", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "lcan", "]"}], " ", ">", " ", "1"}], ",", 
         " ", "\n", "      ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"lcan", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "==", " ", 
             RowBox[{"lcan", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}]}], " ", "&&", " ", 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"lcan", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", "||", " ", 
              "\n", "          ", 
              RowBox[{"!", 
               RowBox[{"lcan", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ")"}]}], ",", " ", 
           RowBox[{"openleft", " ", "=", " ", "closed"}]}], "]"}]}], "]"}], 
       ";", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "rcan", "]"}], " ", ">", " ", "1"}], ",", 
         " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"rcan", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], " ", "==", " ", 
             
             RowBox[{"rcan", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"-", "2"}], ",", "1"}], "]"}], "]"}]}], " ", "&&", 
            " ", "\n", "        ", 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"rcan", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}]}], " ", "||", 
              "  ", 
              RowBox[{"!", 
               RowBox[{"rcan", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "2"}], "]"}], "]"}]}]}], ")"}]}], 
           ",", " ", "\n", "       ", 
           RowBox[{"openright", " ", "=", " ", "closed"}]}], "]"}]}], "]"}], 
       ";", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"divleft", ",", " ", "divright"}], "}"}], ",", " ", "\n", 
         "      ", 
         RowBox[{"{", 
          RowBox[{"openleft", ",", " ", "openright"}], "}"}]}], "}"}]}]}], 
     "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"divideu", "[", 
   RowBox[{
    RowBox[{"u_", " ", "/;", " ", 
     RowBox[{"uQ", "[", "u", "]"}]}], ",", " ", 
    RowBox[{"v_", " ", "/;", " ", 
     RowBox[{"uQ", "[", "v", "]"}]}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"i", " ", "=", " ", 
       RowBox[{"nbits", "[", "u", "]"}]}], ",", " ", 
      RowBox[{"j", " ", "=", " ", 
       RowBox[{"nbits", "[", "v", "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"w", " ", "=", " ", 
       RowBox[{"g2u", "[", 
        RowBox[{"divideg", "[", 
         RowBox[{
          RowBox[{"u2g", "[", "u", "]"}], ",", " ", 
          RowBox[{"u2g", "[", "v", "]"}]}], "]"}], "]"}]}]}], "}"}], ",", " ",
     "\n", "   ", 
    RowBox[{
     RowBox[{"ubitsmoved", " ", "+=", " ", 
      RowBox[{
       RowBox[{"nbits", "[", "u", "]"}], " ", "+", " ", 
       RowBox[{"nbits", "[", "v", "]"}], " ", "+", " ", 
       RowBox[{"nbits", "[", "w", "]"}]}]}], ";", " ", "\n", "    ", 
     RowBox[{"numbersmoved", " ", "+=", " ", "3"}], ";", " ", "w"}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"(", "u_", ")"}], " ", "\[CircleDot]", " ", 
   RowBox[{"(", "v_", ")"}]}], " ", ":=", " ", 
  RowBox[{"divideu", "[", 
   RowBox[{"u", ",", " ", "v"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"squareg", "[", 
   RowBox[{"g_", " ", "/;", " ", 
    RowBox[{"gQ", "[", "g", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"g1", " ", "=", " ", 
       RowBox[{"g", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", " ", 
      RowBox[{"g2", " ", "=", " ", 
       RowBox[{"g", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"b1", " ", "=", " ", 
       RowBox[{"g", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", " ", 
      RowBox[{"b2", " ", "=", " ", 
       RowBox[{"g", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", " ", "\n", 
    "   ", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"g1", " ", "===", " ", "Indeterminate"}], " ", "||", " ", 
       RowBox[{"g2", " ", "===", " ", "Indeterminate"}]}], ",", " ", "\n", 
      "    ", 
      RowBox[{"f2g", "[", "Indeterminate", "]"}], ",", " ", "True", ",", " ", 
      
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"t1", " ", "=", " ", 
           RowBox[{"g1", "^", "2"}]}], ",", " ", 
          RowBox[{"t2", " ", "=", " ", 
           RowBox[{"g2", "^", "2"}]}], ",", " ", "\n", "      ", "tset"}], 
         "}"}], ",", " ", 
        RowBox[{
         RowBox[{"tset", " ", "=", " ", 
          RowBox[{"Sort", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"t1", ",", " ", "b1"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"t2", ",", " ", "b2"}], "}"}]}], "}"}], "]"}]}], ";", 
         " ", "\n", "      ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"g1", " ", "<", " ", "0"}], " ", "&&", " ", 
              RowBox[{"g2", " ", ">", " ", "0"}]}], ")"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"g1", " ", ">", " ", "0"}], " ", "&&", " ", 
              RowBox[{"g2", " ", "<", " ", "0"}]}], ")"}], " ", "||", " ", 
            "\n", "        ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"g1", " ", "==", " ", "0"}], " ", "&&", "  ", 
              RowBox[{"!", "b1"}]}], ")"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"g2", " ", "==", " ", "0"}], " ", "&&", "  ", 
              RowBox[{"!", "b2"}]}], ")"}]}], ",", " ", "\n", "       ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"t1", " ", "==", " ", "t2"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", " ", "t1"}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"closed", ",", " ", 
                 RowBox[{"b1", " ", "&&", " ", "b2"}]}], "}"}]}], "}"}], ",", 
             " ", "\n", "        ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", " ", 
                 RowBox[{"tset", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"closed", ",", " ", 
                 RowBox[{"tset", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}]}], "}"}]}], 
            "]"}], ",", " ", "True", ",", " ", "\n", "       ", 
           RowBox[{"Transpose", "[", "tset", "]"}]}], "]"}]}]}], "]"}]}], 
     "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"squareu", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"uQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"i", " ", "=", " ", 
       RowBox[{"nbits", "[", "u", "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"v", " ", "=", " ", 
       RowBox[{"g2u", "[", 
        RowBox[{"squareg", "[", 
         RowBox[{"u2g", "[", "u", "]"}], "]"}], "]"}]}]}], "}"}], ",", " ", 
    "\n", "   ", 
    RowBox[{
     RowBox[{"ubitsmoved", " ", "+=", " ", 
      RowBox[{
       RowBox[{"nbits", "[", "u", "]"}], " ", "+", " ", 
       RowBox[{"nbits", "[", "v", "]"}]}]}], ";", " ", 
     RowBox[{"numbersmoved", " ", "+=", " ", "2"}], ";", " ", "v"}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"sqrtg", "[", 
   RowBox[{"g_", " ", "/;", " ", 
    RowBox[{"gQ", "[", "g", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "===", " ", "NaN"}], " ", 
     "||", " ", "\n", "    ", 
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "===", " ", "NaN"}], " ", 
     "||", " ", 
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "<", " ", "0"}]}], ",", 
    " ", 
    RowBox[{"f2g", "[", "NaN", "]"}], ",", " ", "\n", "   ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"g", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], ",", " ", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"g", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", 
        RowBox[{"g", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}]}], "}"}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"sqrtu", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"uQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"i", " ", "=", " ", 
       RowBox[{"nbits", "[", "u", "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"v", " ", "=", " ", 
       RowBox[{"g2u", "[", 
        RowBox[{"sqrtg", "[", 
         RowBox[{"u2g", "[", "u", "]"}], "]"}], "]"}]}]}], "}"}], ",", " ", 
    RowBox[{
     RowBox[{"ubitsmoved", " ", "+=", " ", 
      RowBox[{
       RowBox[{"nbits", "[", "u", "]"}], " ", "+", " ", 
       RowBox[{"nbits", "[", "v", "]"}]}]}], ";", " ", "\n", "    ", 
     RowBox[{"numbersmoved", " ", "+=", " ", "2"}], ";", " ", "v"}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"powposleft", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x_", " ", "/;", " ", 
       RowBox[{"x", " ", ">=", " ", "1"}]}], ",", " ", "xb_"}], "}"}], ",", 
    " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"y_", " ", "/;", " ", 
       RowBox[{"y", " ", ">=", " ", "0"}]}], ",", " ", "yb_"}], "}"}]}], 
   "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"Which", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "xb"}], "}"}], " ", "==", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "closed"}], "}"}]}], ",", " ", "\n", "   ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"y", ",", " ", "yb"}], "}"}], " ", "==", " ", 
       RowBox[{"{", 
        RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"NaN", ",", " ", "open"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "closed"}], "}"}]}], "]"}], ",", " ", "\n", 
    "   ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y", ",", " ", "yb"}], "}"}], " ", "==", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "closed"}], "}"}]}], ",", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", " ", "xb"}], "}"}], " ", "==", " ", 
       RowBox[{"{", 
        RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}], ",", " ", "\n", 
      "    ", 
      RowBox[{"{", 
       RowBox[{"NaN", ",", " ", "open"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "closed"}], "}"}]}], "]"}], ",", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "xb"}], "}"}], " ", "==", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "open"}], "}"}]}], ",", " ", "\n", "   ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"y", ",", " ", "yb"}], "}"}], " ", "==", " ", 
       RowBox[{"{", 
        RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"Infinity", ",", " ", "closed"}], "}"}], ",", " ", "\n", 
      "    ", 
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "open"}], "}"}]}], "]"}], ",", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y", ",", " ", "yb"}], "}"}], " ", "==", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "open"}], "}"}]}], ",", " ", "\n", "   ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", " ", "xb"}], "}"}], " ", "==", " ", 
       RowBox[{"{", 
        RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"Infinity", ",", " ", "closed"}], "}"}], ",", " ", "\n", 
      "    ", 
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "open"}], "}"}]}], "]"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", " ", "xb"}], "}"}], " ", "==", " ", 
      RowBox[{"{", 
       RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}], " ", "||", " ", 
     "\n", "    ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"y", ",", " ", "yb"}], "}"}], " ", "==", " ", 
      RowBox[{"{", 
       RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"Infinity", ",", " ", "closed"}], "}"}], ",", " ", "True", ",", 
    " ", "\n", "   ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "^", "y"}], ",", " ", 
      RowBox[{"xb", " ", "||", " ", "yb"}]}], "}"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"powposright", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x_", " ", "/;", " ", 
       RowBox[{"x", " ", ">=", " ", "1"}]}], ",", " ", "xb_"}], "}"}], ",", 
    " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"y_", " ", "/;", " ", 
       RowBox[{"y", " ", ">=", " ", "0"}]}], ",", " ", "yb_"}], "}"}]}], 
   "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"Which", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "xb"}], "}"}], " ", "==", " ", 
     RowBox[{"{", 
      RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}], ",", " ", "\n", 
    "   ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"y", ",", " ", "yb"}], "}"}], " ", "==", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "closed"}], "}"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"NaN", ",", " ", "open"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}], "]"}], ",", " ", 
    "\n", "   ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y", ",", " ", "yb"}], "}"}], " ", "==", " ", 
     RowBox[{"{", 
      RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}], ",", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", " ", "xb"}], "}"}], " ", "==", " ", 
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "closed"}], "}"}]}], ",", " ", "\n", "    ", 
      RowBox[{"{", 
       RowBox[{"NaN", ",", " ", "open"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}], "]"}], ",", " ", 
    "\n", "   ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "xb"}], "}"}], " ", "==", " ", 
     RowBox[{"{", 
      RowBox[{"Infinity", ",", " ", "open"}], "}"}]}], ",", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"y", ",", " ", "yb"}], "}"}], " ", "==", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "closed"}], "}"}]}], ",", " ", "\n", "    ", 
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "closed"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"Infinity", ",", " ", "open"}], "}"}]}], "]"}], ",", " ", "\n",
     "   ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y", ",", " ", "yb"}], "}"}], " ", "==", " ", 
     RowBox[{"{", 
      RowBox[{"Infinity", ",", " ", "open"}], "}"}]}], ",", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", " ", "xb"}], "}"}], " ", "==", " ", 
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "closed"}], "}"}]}], ",", " ", "\n", "    ", 
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "closed"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"Infinity", ",", " ", "open"}], "}"}]}], "]"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", " ", "xb"}], "}"}], " ", "==", " ", 
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "closed"}], "}"}]}], " ", "||", " ", "\n", 
     "    ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"y", ",", " ", "yb"}], "}"}], " ", "==", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "closed"}], "}"}]}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", " ", "closed"}], "}"}], ",", " ", "True", ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "^", "y"}], ",", " ", 
      RowBox[{"xb", " ", "||", " ", "yb"}]}], "}"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"rec", "[", 
   RowBox[{"{", 
    RowBox[{"x_", ",", " ", "xb_"}], "}"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{"x", " ", "===", " ", "NaN"}], ",", " ", "NaN", ",", " ", 
      RowBox[{"x", " ", "==", " ", "0"}], ",", " ", "Infinity", ",", " ", 
      "\n", "    ", "True", ",", " ", 
      RowBox[{"1", "/", "x"}]}], "]"}], ",", " ", "xb"}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"powg", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xlo_", ",", " ", "xhi_"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"xlob_", ",", " ", "xhib_"}], "}"}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ylo_", ",", " ", "yhi_"}], "}"}], ",", " ", "\n", "    ", 
      RowBox[{"{", 
       RowBox[{"ylob_", ",", " ", "yhib_"}], "}"}]}], "}"}]}], "]"}], " ", ":=",
   " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NaNg", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"NaN", ",", " ", "NaN"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}]}], ",", " ", 
      RowBox[{"lcan", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ",", " ", "\n", "    ", "openleft", ",", " ", 
      "openright", ",", " ", "powleft", ",", " ", "powright", ",", " ", 
      RowBox[{"rcan", " ", "=", " ", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"xlo", " ", "===", " ", "NaN"}], " ", "||", " ", 
       RowBox[{"xhi", " ", "===", " ", "NaN"}], " ", "||", " ", 
       RowBox[{"ylo", " ", "===", " ", "NaN"}], " ", "||", " ", "\n", "     ", 
       RowBox[{"yhi", " ", "===", " ", "NaN"}]}], ",", " ", "NaNg", ",", " ", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xlo", " ", "<", " ", "0"}], " ", "||", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"xlo", " ", "==", " ", "0"}], " ", "&&", "  ", 
           RowBox[{"!", "xlob"}]}], ")"}]}], ")"}], " ", "&&", " ", "\n", 
       "     ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xhi", " ", ">", " ", "0"}], " ", "||", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"xhi", " ", "==", " ", "0"}], " ", "&&", "  ", 
           RowBox[{"!", "xhib"}]}], ")"}]}], ")"}], " ", "&&", " ", "\n", 
       "     ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ylo", " ", "<", " ", "0"}], " ", "||", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ylo", " ", "==", " ", "0"}], " ", "&&", "  ", 
           RowBox[{"!", "ylob"}]}], ")"}]}], ")"}], " ", "&&", " ", "\n", 
       "      ", 
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ylo", " ", "==", " ", "yhi"}], " ", "&&", " ", 
          RowBox[{"ylo", " ", "<", " ", "0"}], " ", "&&", " ", 
          RowBox[{"EvenQ", "[", "ylo", "]"}]}], ")"}]}]}], ",", " ", "NaNg", 
      ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"yhi", " ", "==", " ", 
        RowBox[{"-", "Infinity"}]}], " ", "&&", "  ", 
       RowBox[{"!", "yhib"}], " ", "&&", " ", "\n", "     ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"xlo", " ", ">", " ", "1"}], " ", "||", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"xlo", " ", "==", " ", "1"}], " ", "&&", " ", "xlob"}], 
            ")"}]}], ")"}], " ", "||", " ", "\n", "      ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"xhi", " ", "<", " ", "1"}], " ", "||", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"xhi", " ", "==", " ", "1"}], " ", "&&", " ", "xhib"}], 
            ")"}]}], ")"}]}], ")"}]}], ",", " ", "\n", "    ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"closed", ",", " ", "closed"}], "}"}]}], "}"}], ",", " ", 
      RowBox[{
       RowBox[{"ylo", " ", "==", " ", "yhi"}], " ", "&&", "  ", 
       RowBox[{"!", "ylob"}], " ", "&&", " ", "\n", "      ", 
       RowBox[{"!", "yhib"}], " ", "&&", " ", 
       RowBox[{"IntegerQ", "[", "ylo", "]"}]}], ",", " ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"ylo", " ", "==", " ", "0"}], ",", " ", "\n", "     ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0", " ", "<", " ", "xlo"}], " ", "||", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"0", " ", "==", " ", "xlo"}], " ", "&&", " ", 
                 "xlob"}], ")"}]}], ")"}], " ", "&&", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"xhi", " ", "<", " ", "Infinity"}], " ", "||", " ", 
               "\n", "         ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"xhi", " ", "==", " ", "Infinity"}], " ", "&&", " ", 
                 "xhib"}], ")"}]}], ")"}]}], ")"}], " ", "||", " ", "\n", 
           "       ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "Infinity"}], " ", "<", " ", "xlo"}], " ", "||", 
               " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "Infinity"}], " ", "==", " ", "xlo"}], " ", "&&",
                  " ", "xlob"}], ")"}]}], ")"}], " ", "&&", " ", "\n", 
             "        ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"xhi", " ", "<", " ", "0"}], " ", "||", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"xhi", " ", "==", " ", "0"}], " ", "&&", " ", 
                 "xhib"}], ")"}]}], ")"}]}], ")"}]}], ",", " ", "\n", 
          "      ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", " ", "1"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"closed", ",", " ", "closed"}], "}"}]}], "}"}], ",", " ",
           "NaNg"}], "]"}], ",", " ", 
        RowBox[{
         RowBox[{"EvenQ", "[", "ylo", "]"}], " ", "&&", " ", 
         RowBox[{"ylo", " ", ">", " ", "0"}]}], ",", " ", "\n", "     ", 
        RowBox[{"Transpose", "[", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"xhi", " ", "<", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xhi", " ", "==", " ", "0"}], " ", "&&", " ", "xhib"}], 
             ")"}]}], ",", " ", "\n", "       ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xhi", "^", "ylo"}], ",", " ", "xhib"}], "}"}], ",", 
             " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xlo", "^", "ylo"}], ",", " ", "xlob"}], "}"}]}], 
            "}"}], ",", " ", "\n", "       ", 
           RowBox[{
            RowBox[{"xlo", " ", ">", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xlo", " ", "==", " ", "0"}], " ", "&&", " ", "xlob"}], 
             ")"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xlo", "^", "ylo"}], ",", " ", "xlob"}], "}"}], ",", 
             " ", "\n", "        ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xhi", "^", "ylo"}], ",", " ", "xhib"}], "}"}]}], 
            "}"}], ",", " ", "True", ",", " ", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"t1", " ", "=", " ", 
                RowBox[{"xlo", "^", "ylo"}]}], ",", " ", "\n", "         ", 
               RowBox[{"t2", " ", "=", " ", 
                RowBox[{"xhi", "^", "ylo"}]}]}], "}"}], ",", " ", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"t1", " ", "<", " ", "t2"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", " ", "closed"}], "}"}], ",", " ", "\n", 
                 "          ", 
                 RowBox[{"{", 
                  RowBox[{"t2", ",", " ", "xhib"}], "}"}]}], "}"}], ",", " ", 
               
               RowBox[{"t1", " ", ">", " ", "t2"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", " ", "closed"}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"t1", ",", " ", "xlob"}], "}"}]}], "}"}], ",", " ", 
               "\n", "         ", "True", ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", " ", "closed"}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"t1", ",", " ", 
                   RowBox[{"xlob", " ", "&&", " ", "xhib"}]}], "}"}]}], 
                "}"}]}], "]"}]}], "]"}]}], "]"}], "]"}], ",", " ", "\n", 
        "     ", 
        RowBox[{
         RowBox[{"EvenQ", "[", "ylo", "]"}], " ", "&&", " ", 
         RowBox[{"ylo", " ", "<", " ", "0"}]}], ",", " ", 
        RowBox[{"Transpose", "[", "\n", "      ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"xlo", " ", ">", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xlo", " ", "==", " ", "0"}], " ", "&&", " ", "xlob"}], 
             ")"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xhi", "^", "ylo"}], ",", " ", "xhib"}], "}"}], ",", 
             " ", "\n", "        ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"xlo", " ", "==", " ", "0"}], ",", " ", "Infinity", 
                 ",", " ", 
                 RowBox[{"xlo", "^", "ylo"}]}], "]"}], ",", " ", "xlob"}], 
              "}"}]}], "}"}], ",", " ", "\n", "       ", 
           RowBox[{
            RowBox[{"xhi", " ", "<", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xhi", " ", "==", " ", "0"}], " ", "&&", " ", "xhib"}], 
             ")"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xlo", "^", "ylo"}], ",", " ", "xlob"}], "}"}], ",", 
             " ", "\n", "        ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"xhi", " ", "==", " ", "0"}], ",", " ", "Infinity", 
                 ",", " ", 
                 RowBox[{"xhi", "^", "ylo"}]}], "]"}], ",", " ", "xhib"}], 
              "}"}]}], "}"}], ",", " ", "True", ",", " ", "\n", "       ", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"t1", " ", "=", " ", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"xlo", " ", "==", " ", "0"}], " ", "&&", " ", 
                   RowBox[{"ylo", " ", "<", " ", "0"}]}], ",", " ", 
                  "Infinity", ",", " ", 
                  RowBox[{"xlo", "^", "ylo"}]}], "]"}]}], ",", " ", "\n", 
               "         ", 
               RowBox[{"t2", " ", "=", " ", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"xhi", " ", "==", " ", "0"}], " ", "&&", " ", 
                   RowBox[{"ylo", " ", "<", " ", "0"}]}], ",", " ", 
                  "Infinity", ",", " ", 
                  RowBox[{"xhi", "^", "ylo"}]}], "]"}]}]}], "}"}], ",", " ", 
             "\n", "        ", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"t1", " ", ">", " ", "t2"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"t2", ",", " ", "xhib"}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}], "}"}], 
               ",", " ", "\n", "         ", 
               RowBox[{"t1", " ", "<", " ", "t2"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"t1", ",", " ", "xlob"}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}], "}"}], 
               ",", " ", "True", ",", " ", "\n", "         ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"t1", ",", " ", 
                   RowBox[{"xlob", " ", "&&", " ", "xhib"}]}], "}"}], ",", 
                 " ", 
                 RowBox[{"{", 
                  RowBox[{"Infinity", ",", " ", "closed"}], "}"}]}], "}"}]}], 
              "]"}]}], "]"}]}], "]"}], "]"}], ",", " ", 
        RowBox[{"ylo", " ", ">", " ", "0"}], ",", " ", "\n", "     ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xlo", "^", "ylo"}], ",", " ", 
            RowBox[{"xhi", "^", "ylo"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"xlob", ",", " ", "xhib"}], "}"}]}], "}"}], ",", " ", 
        "True", ",", " ", "\n", "     ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"xhi", " ", "==", " ", "0"}], ",", " ", 
              RowBox[{"-", "Infinity"}], ",", " ", 
              RowBox[{"xhi", "^", "ylo"}]}], "]"}], ",", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"xlo", " ", "==", " ", "0"}], ",", " ", "Infinity", ",",
               " ", "\n", "        ", 
              RowBox[{"xlo", "^", "ylo"}]}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"xhib", ",", " ", "xlob"}], "}"}]}], "}"}]}], "]"}], ",", 
      " ", 
      RowBox[{"xlo", " ", "<", " ", "0"}], ",", " ", "NaNg", ",", " ", "True",
       ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"xlo", " ", ">=", " ", "1"}], " ", "&&", " ", 
          RowBox[{"ylo", " ", ">=", " ", "0"}]}], ",", " ", 
         RowBox[{"lcan", " ", "=", " ", 
          RowBox[{"Union", "[", 
           RowBox[{"lcan", ",", " ", "\n", "        ", 
            RowBox[{"{", 
             RowBox[{"powposleft", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"xlo", ",", " ", "xlob"}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"ylo", ",", " ", "ylob"}], "}"}]}], "]"}], "}"}]}], 
           "]"}]}]}], "]"}], ";", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"xhi", " ", "<", " ", "1"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xhi", " ", "==", " ", "1"}], " ", "&&", " ", "xhib"}], 
             ")"}]}], ")"}], " ", "&&", " ", "\n", "       ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"yhi", " ", "<", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"yhi", " ", "==", " ", "0"}], " ", "&&", " ", "yhib"}], 
             ")"}]}], ")"}]}], ",", " ", "\n", "      ", 
         RowBox[{"lcan", " ", "=", " ", 
          RowBox[{"Union", "[", 
           RowBox[{"lcan", ",", " ", 
            RowBox[{"{", 
             RowBox[{"powposleft", "[", 
              RowBox[{
               RowBox[{"rec", "[", 
                RowBox[{"{", 
                 RowBox[{"xhi", ",", " ", "xhib"}], "}"}], "]"}], ",", " ", 
               "\n", "          ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "yhi"}], ",", " ", "yhib"}], "}"}]}], "]"}], 
             "}"}]}], "]"}]}]}], "]"}], ";", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"xlo", " ", "<", " ", "1"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xlo", " ", "==", " ", "1"}], " ", "&&", "  ", 
              RowBox[{"!", "xlob"}]}], ")"}]}], ")"}], " ", "&&", " ", "\n", 
          "       ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"yhi", " ", ">", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"yhi", " ", "==", " ", "0"}], " ", "&&", "  ", 
              RowBox[{"!", "yhib"}]}], ")"}]}], ")"}]}], ",", " ", "\n", 
         "      ", 
         RowBox[{"lcan", " ", "=", " ", 
          RowBox[{"Union", "[", 
           RowBox[{"lcan", ",", " ", 
            RowBox[{"{", 
             RowBox[{"rec", "[", 
              RowBox[{"powposright", "[", 
               RowBox[{
                RowBox[{"rec", "[", 
                 RowBox[{"{", 
                  RowBox[{"xlo", ",", " ", "xlob"}], "}"}], "]"}], ",", " ", 
                "\n", "           ", 
                RowBox[{"{", 
                 RowBox[{"yhi", ",", " ", "yhib"}], "}"}]}], "]"}], "]"}], 
             "}"}]}], "]"}]}]}], "]"}], ";", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"xhi", " ", ">", " ", "1"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xhi", " ", "==", " ", "1"}], " ", "&&", "  ", 
              RowBox[{"!", "xhib"}]}], ")"}]}], ")"}], " ", "&&", " ", "\n", 
          "       ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ylo", " ", "<", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ylo", " ", "==", " ", "0"}], " ", "&&", "  ", 
              RowBox[{"!", "ylob"}]}], ")"}]}], ")"}]}], ",", " ", "\n", 
         "      ", 
         RowBox[{"lcan", " ", "=", " ", 
          RowBox[{"Union", "[", 
           RowBox[{"lcan", ",", " ", 
            RowBox[{"{", 
             RowBox[{"rec", "[", 
              RowBox[{"powposright", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"xhi", ",", " ", "xhib"}], "}"}], ",", " ", "\n", 
                "           ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "ylo"}], ",", " ", "ylob"}], "}"}]}], "]"}], 
              "]"}], "}"}]}], "]"}]}]}], "]"}], ";", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"xhi", " ", ">", " ", "1"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xhi", " ", "==", " ", "1"}], " ", "&&", "  ", 
              RowBox[{"!", "xhib"}]}], ")"}]}], ")"}], " ", "&&", " ", "\n", 
          "       ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"yhi", " ", ">", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"yhi", " ", "==", " ", "0"}], " ", "&&", "  ", 
              RowBox[{"!", "yhib"}]}], ")"}]}], ")"}]}], ",", " ", "\n", 
         "      ", 
         RowBox[{"rcan", " ", "=", " ", 
          RowBox[{"Union", "[", 
           RowBox[{"rcan", ",", " ", 
            RowBox[{"{", 
             RowBox[{"powposright", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"xhi", ",", " ", "xhib"}], "}"}], ",", " ", "\n", 
               "          ", 
               RowBox[{"{", 
                RowBox[{"yhi", ",", " ", "yhib"}], "}"}]}], "]"}], "}"}]}], 
           "]"}]}]}], "]"}], ";", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"xlo", " ", "<", " ", "1"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xlo", " ", "==", " ", "1"}], " ", "&&", "  ", 
              RowBox[{"!", "xlob"}]}], ")"}]}], ")"}], " ", "&&", " ", "\n", 
          "       ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ylo", " ", "<", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ylo", " ", "==", " ", "0"}], " ", "&&", "  ", 
              RowBox[{"!", "ylob"}]}], ")"}]}], ")"}]}], ",", " ", "\n", 
         "      ", 
         RowBox[{"rcan", " ", "=", " ", 
          RowBox[{"Union", "[", 
           RowBox[{"rcan", ",", " ", 
            RowBox[{"{", 
             RowBox[{"powposright", "[", 
              RowBox[{
               RowBox[{"rec", "[", 
                RowBox[{"{", 
                 RowBox[{"xlo", ",", " ", "xlob"}], "}"}], "]"}], ",", " ", 
               "\n", "          ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "ylo"}], ",", " ", "ylob"}], "}"}]}], "]"}], 
             "}"}]}], "]"}]}]}], "]"}], ";", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"xhi", " ", "<", " ", "1"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xhi", " ", "==", " ", "1"}], " ", "&&", " ", "xhib"}], 
             ")"}]}], ")"}], " ", "&&", " ", 
          RowBox[{"ylo", " ", ">=", " ", "0"}]}], ",", " ", "\n", "      ", 
         RowBox[{"rcan", " ", "=", " ", 
          RowBox[{"Union", "[", 
           RowBox[{"rcan", ",", " ", 
            RowBox[{"{", 
             RowBox[{"rec", "[", 
              RowBox[{"powposleft", "[", 
               RowBox[{
                RowBox[{"rec", "[", 
                 RowBox[{"{", 
                  RowBox[{"xhi", ",", " ", "xhib"}], "}"}], "]"}], ",", " ", 
                "\n", "           ", 
                RowBox[{"{", 
                 RowBox[{"ylo", ",", " ", "ylob"}], "}"}]}], "]"}], "]"}], 
             "}"}]}], "]"}]}]}], "]"}], ";", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"xlo", " ", ">=", " ", "1"}], " ", "&&", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"yhi", " ", "<", " ", "0"}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"yhi", " ", "==", " ", "0"}], " ", "&&", " ", "yhib"}], 
             ")"}]}], ")"}]}], ",", " ", "\n", "      ", 
         RowBox[{"rcan", " ", "=", " ", 
          RowBox[{"Union", "[", 
           RowBox[{"rcan", ",", " ", 
            RowBox[{"{", 
             RowBox[{"rec", "[", 
              RowBox[{"powposleft", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"xlo", ",", " ", "xlob"}], "}"}], ",", " ", "\n", 
                "           ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "yhi"}], ",", " ", "yhib"}], "}"}]}], "]"}], 
              "]"}], "}"}]}], "]"}]}]}], "]"}], ";", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"powleft", ",", " ", "powright"}], "}"}], ",", " ", "\n", 
          "       ", 
          RowBox[{"{", 
           RowBox[{"openleft", ",", " ", "openright"}], "}"}]}], "}"}], " ", 
        "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lcan", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
            RowBox[{"rcan", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
          " ", "\n", "       ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lcan", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", " ", 
            RowBox[{"rcan", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}]}], "}"}]}], 
         "}"}]}], ";", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "lcan", "]"}], " ", ">", " ", "1"}], ",", 
         " ", "\n", "      ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"lcan", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "==", " ", 
             RowBox[{"lcan", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}]}], " ", "&&", " ", 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"lcan", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", "||", " ", 
              "\n", "          ", 
              RowBox[{"!", 
               RowBox[{"lcan", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ")"}]}], ",", " ", 
           RowBox[{"openleft", " ", "=", " ", "closed"}]}], "]"}]}], "]"}], 
       ";", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "rcan", "]"}], " ", ">", " ", "1"}], ",", 
         " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"rcan", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], " ", "==", " ", 
             
             RowBox[{"rcan", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"-", "2"}], ",", "1"}], "]"}], "]"}]}], " ", "&&", 
            " ", "\n", "        ", 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"rcan", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}]}], " ", "||", 
              "  ", 
              RowBox[{"!", 
               RowBox[{"rcan", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "2"}], "]"}], "]"}]}]}], ")"}]}], 
           ",", " ", "\n", "       ", 
           RowBox[{"openright", " ", "=", " ", "closed"}]}], "]"}]}], "]"}], 
       ";", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"powleft", ",", " ", "powright"}], "}"}], ",", " ", "\n", 
         "      ", 
         RowBox[{"{", 
          RowBox[{"openleft", ",", " ", "openright"}], "}"}]}], "}"}]}]}], 
     "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"powu", "[", 
   RowBox[{
    RowBox[{"u_", " ", "/;", " ", 
     RowBox[{"uQ", "[", "u", "]"}]}], ",", " ", 
    RowBox[{"v_", " ", "/;", " ", 
     RowBox[{"uQ", "[", "v", "]"}]}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"w", " ", "=", " ", 
      RowBox[{"g2u", "[", 
       RowBox[{"powg", "[", 
        RowBox[{
         RowBox[{"u2g", "[", "u", "]"}], ",", " ", 
         RowBox[{"u2g", "[", "v", "]"}]}], "]"}], "]"}]}], "}"}], ",", " ", 
    "\n", "   ", 
    RowBox[{
     RowBox[{"ubitsmoved", " ", "+=", " ", 
      RowBox[{
       RowBox[{"nbits", "[", "u", "]"}], " ", "+", " ", 
       RowBox[{"nbits", "[", "v", "]"}], " ", "+", " ", 
       RowBox[{"nbits", "[", "w", "]"}]}]}], ";", " ", "\n", "    ", 
     RowBox[{"numbersmoved", " ", "+=", " ", "3"}], ";", " ", "w"}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"expg", "[", 
   RowBox[{"g_", " ", "/;", " ", 
    RowBox[{"gQ", "[", "g", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"g1", " ", "=", " ", 
       RowBox[{"g", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", " ", 
      RowBox[{"g2", " ", "=", " ", 
       RowBox[{"g", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"b1", " ", "=", " ", 
       RowBox[{"g", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", " ", 
      RowBox[{"b2", " ", "=", " ", 
       RowBox[{"g", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", " ", 
      RowBox[{"lo", " ", "=", " ", 
       RowBox[{"Log", "[", "smallsubnormal", "]"}]}], ",", " ", "\n", "    ", 
      
      RowBox[{"hi", " ", "=", " ", 
       RowBox[{"Log", "[", "maxreal", "]"}]}], ",", " ", "glo", ",", " ", 
      "ghi"}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{"glo", " ", "=", " ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"g1", " ", "===", " ", "NaN"}], " ", "||", " ", 
         RowBox[{"g2", " ", "===", " ", "NaN"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "NaN", "}"}], ",", " ", 
          RowBox[{"{", "open", "}"}]}], "}"}], ",", " ", "\n", "      ", 
        RowBox[{
         RowBox[{"g1", " ", "==", " ", 
          RowBox[{"-", "Infinity"}]}], " ", "&&", "  ", 
         RowBox[{"!", "b1"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "0", "}"}], ",", " ", 
          RowBox[{"{", "closed", "}"}]}], "}"}], ",", " ", "\n", "      ", 
        RowBox[{
         RowBox[{"g1", " ", "==", " ", "0"}], " ", "&&", "  ", 
         RowBox[{"!", "b1"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", " ", 
          RowBox[{"{", "closed", "}"}]}], "}"}], ",", " ", 
        RowBox[{
         RowBox[{"g1", " ", "==", " ", "Infinity"}], " ", "&&", "  ", 
         RowBox[{"!", "b1"}]}], ",", " ", "\n", "      ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "Infinity", "}"}], ",", " ", 
          RowBox[{"{", "closed", "}"}]}], "}"}], ",", " ", 
        RowBox[{"g1", " ", "<", " ", "lo"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "0", "}"}], ",", " ", 
          RowBox[{"{", "open", "}"}]}], "}"}], ",", " ", 
        RowBox[{"g1", " ", ">", " ", "hi"}], ",", " ", "\n", "      ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "maxreal", "}"}], ",", " ", 
          RowBox[{"{", "open", "}"}]}], "}"}], ",", " ", "True", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Exp", "[", "g1", "]"}], "}"}], ",", " ", 
          RowBox[{"{", "open", "}"}]}], "}"}]}], "]"}]}], ";", " ", "\n", 
     "    ", 
     RowBox[{"ghi", " ", "=", " ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"g1", " ", "===", " ", "NaN"}], " ", "||", " ", 
         RowBox[{"g2", " ", "===", " ", "NaN"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "NaN", "}"}], ",", " ", 
          RowBox[{"{", "open", "}"}]}], "}"}], ",", " ", "\n", "      ", 
        RowBox[{
         RowBox[{"g2", " ", "==", " ", 
          RowBox[{"-", "Infinity"}]}], " ", "&&", "  ", 
         RowBox[{"!", "b2"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "0", "}"}], ",", " ", 
          RowBox[{"{", "closed", "}"}]}], "}"}], ",", " ", "\n", "      ", 
        RowBox[{
         RowBox[{"g2", " ", "==", " ", "0"}], " ", "&&", "  ", 
         RowBox[{"!", "b2"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", " ", 
          RowBox[{"{", "closed", "}"}]}], "}"}], ",", " ", 
        RowBox[{
         RowBox[{"g2", " ", "==", " ", "Infinity"}], " ", "&&", "  ", 
         RowBox[{"!", "b2"}]}], ",", " ", "\n", "      ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "Infinity", "}"}], ",", " ", 
          RowBox[{"{", "closed", "}"}]}], "}"}], ",", " ", 
        RowBox[{"g2", " ", "<", " ", "lo"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "smallsubnormal", "}"}], ",", " ", "\n", "       ", 
          RowBox[{"{", "open", "}"}]}], "}"}], ",", " ", 
        RowBox[{"g2", " ", ">", " ", "hi"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "Infinity", "}"}], ",", " ", 
          RowBox[{"{", "open", "}"}]}], "}"}], ",", " ", "True", ",", " ", 
        "\n", "      ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Exp", "[", "g2", "]"}], "}"}], ",", " ", 
          RowBox[{"{", "open", "}"}]}], "}"}]}], "]"}]}], ";", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"g1", " ", "===", " ", "g2"}], ",", " ", 
       RowBox[{"f2g", "[", 
        RowBox[{"Exp", "[", "g1", "]"}], "]"}], ",", " ", "\n", "     ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"glo", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
           RowBox[{"ghi", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"glo", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", 
           RowBox[{"ghi", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}]}], "}"}]}], 
      "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"expu", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"uQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"i", " ", "=", " ", 
       RowBox[{"nbits", "[", "u", "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"v", " ", "=", " ", 
       RowBox[{"g2u", "[", 
        RowBox[{"expg", "[", 
         RowBox[{"u2g", "[", "u", "]"}], "]"}], "]"}]}]}], "}"}], ",", " ", 
    RowBox[{
     RowBox[{"ubitsmoved", " ", "+=", " ", 
      RowBox[{
       RowBox[{"nbits", "[", "u", "]"}], " ", "+", " ", 
       RowBox[{"nbits", "[", "v", "]"}]}]}], ";", " ", "\n", "    ", 
     RowBox[{"numbersmoved", " ", "+=", " ", "2"}], ";", " ", "v"}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"absg", "[", "g_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"g1", " ", "=", " ", 
       RowBox[{"g", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", " ", 
      RowBox[{"g2", " ", "=", " ", 
       RowBox[{"g", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"b1", " ", "=", " ", 
       RowBox[{"g", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", " ", 
      RowBox[{"b2", " ", "=", " ", 
       RowBox[{"g", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", " ", "\n", 
    "   ", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"g1", " ", "===", " ", "NaN"}], " ", "||", " ", 
       RowBox[{"g2", " ", "===", " ", "NaN"}]}], ",", " ", 
      RowBox[{"f2g", "[", "NaN", "]"}], ",", " ", 
      RowBox[{"g2", " ", "<=", " ", "0"}], ",", " ", "\n", "    ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Abs", "[", "g2", "]"}], ",", " ", 
          RowBox[{"Abs", "[", "g1", "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"b2", ",", " ", "b1"}], "}"}]}], "}"}], ",", " ", 
      RowBox[{"g1", " ", "<=", " ", "0"}], ",", " ", "\n", "    ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "g1", "]"}], " ", "<", " ", 
         RowBox[{"Abs", "[", "g2", "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", " ", 
            RowBox[{"Abs", "[", "g2", "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"closed", ",", " ", "b2"}], "}"}]}], "}"}], ",", " ", "\n",
         "     ", 
        RowBox[{
         RowBox[{"Abs", "[", "g1", "]"}], " ", ">", " ", 
         RowBox[{"Abs", "[", "g2", "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", " ", 
            RowBox[{"Abs", "[", "g1", "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"closed", ",", " ", "b1"}], "}"}]}], "}"}], ",", " ", 
        "True", ",", " ", "\n", "     ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", " ", 
            RowBox[{"Abs", "[", "g2", "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"closed", ",", " ", 
            RowBox[{"b1", " ", "&&", " ", "b2"}]}], "}"}]}], "}"}]}], "]"}], 
      ",", " ", "True", ",", " ", "\n", "    ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Abs", "[", "g1", "]"}], ",", " ", 
          RowBox[{"Abs", "[", "g2", "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"b1", ",", " ", "b2"}], "}"}]}], "}"}]}], "]"}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"absu", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"uQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"i", " ", "=", " ", 
       RowBox[{"nbits", "[", "u", "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"v", " ", "=", " ", 
       RowBox[{"g2u", "[", 
        RowBox[{"absg", "[", 
         RowBox[{"u2g", "[", "u", "]"}], "]"}], "]"}]}]}], "}"}], ",", " ", 
    RowBox[{
     RowBox[{"ubitsmoved", " ", "+=", " ", 
      RowBox[{
       RowBox[{"nbits", "[", "u", "]"}], " ", "+", " ", 
       RowBox[{"nbits", "[", "v", "]"}]}]}], ";", " ", "\n", "    ", 
     RowBox[{"numbersmoved", " ", "+=", " ", "2"}], ";", " ", "v"}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"logg", "[", 
   RowBox[{"g_", " ", "/;", " ", 
    RowBox[{"gQ", "[", "g", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"g1", " ", "=", " ", 
       RowBox[{"g", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", " ", 
      RowBox[{"g2", " ", "=", " ", 
       RowBox[{"g", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"b1", " ", "=", " ", 
       RowBox[{"g", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", " ", 
      RowBox[{"b2", " ", "=", " ", 
       RowBox[{"g", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", " ", "glo", ",", " ", 
      "ghi"}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"g1", " ", "===", " ", "NaN"}], " ", "||", " ", 
       RowBox[{"g2", " ", "===", " ", "NaN"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"NaN", ",", " ", "NaN"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], ",", " ", "\n", 
      "    ", 
      RowBox[{"g1", " ", "<", " ", "0"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"NaN", ",", " ", "NaN"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], ",", " ", "True",
       ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"glo", " ", "=", " ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"g1", " ", "==", " ", "0"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"-", "Infinity"}], "}"}], ",", " ", 
            RowBox[{"{", "b1", "}"}]}], "}"}], ",", " ", 
          RowBox[{"g1", " ", "==", " ", "1"}], ",", " ", "\n", "       ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", " ", 
            RowBox[{"{", "b1", "}"}]}], "}"}], ",", " ", 
          RowBox[{"g1", " ", "==", " ", "Infinity"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "Infinity", "}"}], ",", " ", 
            RowBox[{"{", "closed", "}"}]}], "}"}], ",", " ", "\n", "       ", 
          "True", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Log", "[", "g1", "]"}], "}"}], ",", " ", 
            RowBox[{"{", "open", "}"}]}], "}"}]}], "]"}]}], ";", " ", "\n", 
       "     ", 
       RowBox[{"ghi", " ", "=", " ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"g2", " ", "==", " ", "0"}], " ", "&&", "  ", 
           RowBox[{"!", "b2"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"-", "Infinity"}], "}"}], ",", " ", 
            RowBox[{"{", "closed", "}"}]}], "}"}], ",", " ", "\n", "       ", 
          
          RowBox[{"g2", " ", "==", " ", "1"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", " ", 
            RowBox[{"{", "b2", "}"}]}], "}"}], ",", " ", 
          RowBox[{"g2", " ", "==", " ", "Infinity"}], ",", " ", "\n", 
          "       ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "Infinity", "}"}], ",", " ", 
            RowBox[{"{", "b2", "}"}]}], "}"}], ",", " ", "True", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Log", "[", "g2", "]"}], "}"}], ",", " ", 
            RowBox[{"{", "open", "}"}]}], "}"}]}], "]"}]}], ";", " ", "\n", 
       "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"g1", " ", "===", " ", "g2"}], ",", " ", 
         RowBox[{"f2g", "[", 
          RowBox[{"Log", "[", "g1", "]"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"glo", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
             RowBox[{"ghi", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}], ",", " ", "\n",
            "       ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"glo", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", 
             RowBox[{"ghi", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}]}], "}"}]}], 
        "]"}]}]}], "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"logu", "[", 
     RowBox[{"u_", " ", "/;", " ", 
      RowBox[{"uQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"i", " ", "=", " ", 
         RowBox[{"nbits", "[", "u", "]"}]}], ",", " ", "\n", "     ", 
        RowBox[{"v", " ", "=", " ", 
         RowBox[{"g2u", "[", 
          RowBox[{"logg", "[", 
           RowBox[{"u2g", "[", "u", "]"}], "]"}], "]"}]}]}], "}"}], ",", " ", 
      
      RowBox[{
       RowBox[{"ubitsmoved", " ", "+=", " ", 
        RowBox[{
         RowBox[{"nbits", "[", "u", "]"}], " ", "+", " ", 
         RowBox[{"nbits", "[", "v", "]"}]}]}], ";", " ", "\n", "     ", 
       RowBox[{"numbersmoved", " ", "+=", " ", "2"}], ";", " ", "v"}]}], 
     "]"}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cosg", "[", 
     RowBox[{"g_", " ", "/;", " ", 
      RowBox[{"gQ", "[", "g", "]"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"g1", " ", "=", " ", 
         RowBox[{"g", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", " ", 
        RowBox[{"g2", " ", "=", " ", 
         RowBox[{"g", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", " ", "\n", "     ", 
        RowBox[{"b1", " ", "=", " ", 
         RowBox[{"g", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", " ", 
        RowBox[{"b2", " ", "=", " ", 
         RowBox[{"g", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", " ", "\n", 
      "    ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"g1", " ", "===", " ", "NaN"}], " ", "||", " ", 
         RowBox[{"g2", " ", "===", " ", "NaN"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"NaN", ",", " ", "NaN"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], ",", " ", "\n",
         "     ", 
        RowBox[{
         RowBox[{"g1", " ", "===", " ", "Infinity"}], " ", "||", " ", 
         RowBox[{"g2", " ", "===", " ", "Infinity"}], " ", "||", " ", 
         RowBox[{"g1", " ", "===", " ", 
          RowBox[{"-", "Infinity"}]}], " ", "||", " ", "\n", "      ", 
         RowBox[{"g2", " ", "===", " ", 
          RowBox[{"-", "Infinity"}]}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", " ", "1"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"closed", ",", " ", "closed"}], "}"}]}], "}"}], ",", " ", 
        "\n", "     ", 
        RowBox[{
         RowBox[{"g2", " ", "-", " ", "g1"}], " ", ">", " ", "360"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", " ", "1"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"closed", ",", " ", "closed"}], "}"}]}], "}"}], ",", " ", 
        "\n", "     ", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"g1", ",", " ", "g2"}], "}"}], " ", "-=", " ", 
          RowBox[{
           RowBox[{"Floor", "[", 
            RowBox[{"g1", "/", "360"}], "]"}], "*", "360"}]}], ";", " ", 
         RowBox[{"g1", " ", "<", " ", "180"}]}], ",", " ", "\n", "     ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"g2", " ", "<", " ", "180"}], " ", "||", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g2", " ", "==", " ", "180"}], " ", "&&", " ", "b2"}], 
            ")"}]}], ",", " ", "\n", "      ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"g2", "*", "Degree"}], "]"}], ",", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"g1", "*", "Degree"}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"b2", ",", " ", "b1"}], "}"}]}], "}"}], ",", " ", "\n", 
          "      ", 
          RowBox[{
           RowBox[{"g2", " ", "<", " ", "360"}], " ", "||", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g2", " ", "==", " ", "360"}], " ", "&&", " ", "b2"}], 
            ")"}]}], ",", " ", "\n", "      ", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"g1", "*", "Degree"}], "]"}], " ", "<", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"g2", "*", "Degree"}], "]"}]}], ",", " ", "\n", 
            "       ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"g2", "*", "Degree"}], "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"closed", ",", " ", "b2"}], "}"}]}], "}"}], ",", " ", 
            "\n", "       ", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"g1", "*", "Degree"}], "]"}], " ", ">", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"g2", "*", "Degree"}], "]"}]}], ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"g1", "*", "Degree"}], "]"}]}], "}"}], ",", " ", 
              "\n", "        ", 
              RowBox[{"{", 
               RowBox[{"closed", ",", " ", "b1"}], "}"}]}], "}"}], ",", " ", 
            "True", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"g1", "*", "Degree"}], "]"}]}], "}"}], ",", " ", 
              "\n", "        ", 
              RowBox[{"{", 
               RowBox[{"closed", ",", " ", 
                RowBox[{"b1", " ", "&&", " ", "b2"}]}], "}"}]}], "}"}]}], 
           "]"}], ",", " ", "True", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", " ", "1"}], "}"}], ",", " ", "\n", 
            "       ", 
            RowBox[{"{", 
             RowBox[{"closed", ",", " ", "closed"}], "}"}]}], "}"}]}], "]"}], 
        ",", " ", "True", ",", " ", "\n", "     ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"g2", " ", "<", " ", "360"}], " ", "||", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g2", " ", "==", " ", "360"}], " ", "&&", " ", "b2"}], 
            ")"}]}], ",", " ", "\n", "      ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"g1", "*", "Degree"}], "]"}], ",", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"g2", "*", "Degree"}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"b1", ",", " ", "b2"}], "}"}]}], "}"}], ",", " ", "True",
           ",", " ", "\n", "      ", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"g1", "*", "Degree"}], "]"}], " ", ">", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"g2", "*", "Degree"}], "]"}]}], ",", " ", "\n", 
            "       ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"g2", "*", "Degree"}], "]"}], ",", " ", "1"}], "}"}],
               ",", " ", 
              RowBox[{"{", 
               RowBox[{"b2", ",", " ", "closed"}], "}"}]}], "}"}], ",", " ", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"g1", "*", "Degree"}], "]"}], " ", "<", " ", "\n", 
             "        ", 
             RowBox[{"Cos", "[", 
              RowBox[{"g2", "*", "Degree"}], "]"}]}], ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"g1", "*", "Degree"}], "]"}], ",", " ", "1"}], "}"}],
               ",", " ", 
              RowBox[{"{", 
               RowBox[{"b1", ",", " ", "closed"}], "}"}]}], "}"}], ",", " ", 
            "\n", "       ", "True", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"g1", "*", "Degree"}], "]"}], ",", " ", "1"}], "}"}],
               ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"b1", " ", "&&", " ", "b2"}], ",", " ", "closed"}], 
               "}"}]}], "}"}]}], "]"}], ",", " ", "True", ",", " ", "\n", 
          "      ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", " ", "1"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"closed", ",", " ", "closed"}], "}"}]}], "}"}]}], 
         "]"}]}], "]"}]}], "]"}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cosu", "[", 
     RowBox[{"u_", " ", "/;", " ", 
      RowBox[{"uQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"i", " ", "=", " ", 
         RowBox[{"nbits", "[", "u", "]"}]}], ",", " ", "\n", "     ", 
        RowBox[{"v", " ", "=", " ", 
         RowBox[{"g2u", "[", 
          RowBox[{"cosg", "[", 
           RowBox[{"u2g", "[", "u", "]"}], "]"}], "]"}]}]}], "}"}], ",", " ", 
      
      RowBox[{
       RowBox[{"ubitsmoved", " ", "+=", " ", 
        RowBox[{
         RowBox[{"nbits", "[", "u", "]"}], " ", "+", " ", 
         RowBox[{"nbits", "[", "v", "]"}]}]}], ";", " ", "\n", "     ", 
       RowBox[{"numbersmoved", " ", "+=", " ", "2"}], ";", " ", "v"}]}], 
     "]"}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sing", "[", 
     RowBox[{"g_", " ", "/;", " ", 
      RowBox[{"gQ", "[", "g", "]"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"cosg", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"90", " ", "-", " ", 
          RowBox[{"g", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", " ", 
         RowBox[{"90", " ", "-", " ", 
          RowBox[{"g", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "}"}], ",", " ", "\n", 
       "     ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", " ", 
         RowBox[{"g", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}]}], "}"}], "]"}]}], 
   ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sinu", "[", 
     RowBox[{"u_", " ", "/;", " ", 
      RowBox[{"uQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", " ", "=", " ", 
        RowBox[{"g2u", "[", 
         RowBox[{"sing", "[", 
          RowBox[{"u2g", "[", "u", "]"}], "]"}], "]"}]}], "}"}], ",", " ", 
      "\n", "    ", 
      RowBox[{
       RowBox[{"ubitsmoved", " ", "+=", " ", 
        RowBox[{
         RowBox[{"nbits", "[", "u", "]"}], " ", "+", " ", 
         RowBox[{"nbits", "[", "v", "]"}]}]}], ";", " ", 
       RowBox[{"numbersmoved", " ", "+=", " ", "2"}], ";", " ", "v"}]}], 
     "]"}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cotg", "[", 
     RowBox[{"g_", " ", "/;", " ", 
      RowBox[{"gQ", "[", "g", "]"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"g1", " ", "=", " ", 
         RowBox[{"g", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", " ", 
        RowBox[{"g2", " ", "=", " ", 
         RowBox[{"g", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", " ", "\n", "     ", 
        RowBox[{"b1", " ", "=", " ", 
         RowBox[{"g", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", " ", 
        RowBox[{"b2", " ", "=", " ", 
         RowBox[{"g", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", " ", "\n", 
      "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"g1", " ", "===", " ", "NaN"}], " ", "||", " ", 
         RowBox[{"g2", " ", "===", " ", "NaN"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"NaN", ",", " ", "NaN"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], ",", " ", "\n",
         "     ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", "g1", "]"}], " ", "==", " ", "Infinity"}], 
           " ", "||", " ", 
           RowBox[{
            RowBox[{"Abs", "[", "g2", "]"}], " ", "==", " ", "Infinity"}]}], 
          ",", " ", "\n", "      ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"NaN", ",", " ", "NaN"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"g2", " ", "-", " ", "g1"}], " ", ">", " ", "180"}], ",",
             " ", "\n", "       ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"NaN", ",", " ", "NaN"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], ",", " ", 
            "\n", "       ", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"g1", ",", " ", "g2"}], "}"}], " ", "-=", " ", 
              RowBox[{
               RowBox[{"Floor", "[", 
                RowBox[{"g1", "/", "180"}], "]"}], "*", "180"}]}], ";", " ", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"g1", " ", "==", " ", "0"}], " ", "&&", "  ", 
                RowBox[{"!", "b1"}]}], ",", " ", "\n", "         ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"NaN", ",", " ", "NaN"}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], ",", 
               " ", 
               RowBox[{
                RowBox[{"g1", " ", "==", " ", "0"}], " ", "&&", " ", "b1"}], 
               ",", " ", "\n", "         ", 
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{"g2", " ", "<", " ", "180"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cot", "[", 
                    RowBox[{"g2", "*", "Degree"}], "]"}], ",", " ", 
                    "Infinity"}], "}"}], ",", " ", "\n", "           ", 
                   RowBox[{"{", 
                    RowBox[{"b2", ",", " ", "open"}], "}"}]}], "}"}], ",", 
                 " ", 
                 RowBox[{
                  RowBox[{"g2", " ", "==", " ", "180"}], " ", "&&", " ", 
                  "b2"}], ",", " ", "\n", "          ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "Infinity"}], ",", " ", "Infinity"}], "}"}], 
                   ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], ",", 
                 " ", "True", ",", " ", "\n", "          ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"NaN", ",", " ", "NaN"}], "}"}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}]}], 
                "]"}], ",", " ", 
               RowBox[{"g1", " ", "<", " ", "180"}], ",", " ", "\n", 
               "         ", 
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{"g2", " ", "<", " ", "180"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cot", "[", 
                    RowBox[{"g2", "*", "Degree"}], "]"}], ",", " ", 
                    RowBox[{"Cot", "[", 
                    RowBox[{"g1", "*", "Degree"}], "]"}]}], "}"}], ",", " ", 
                   "\n", "           ", 
                   RowBox[{"{", 
                    RowBox[{"b2", ",", " ", "b1"}], "}"}]}], "}"}], ",", " ", 
                 
                 RowBox[{
                  RowBox[{"g2", " ", "==", " ", "180"}], " ", "&&", " ", 
                  "b2"}], ",", " ", "\n", "          ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "Infinity"}], ",", " ", 
                    RowBox[{"Cot", "[", 
                    RowBox[{"g1", "*", "Degree"}], "]"}]}], "}"}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"open", ",", " ", "b1"}], "}"}]}], "}"}], ",", 
                 " ", "True", ",", " ", "\n", "          ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"NaN", ",", " ", "NaN"}], "}"}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}]}], 
                "]"}], ",", " ", "True", ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"NaN", ",", " ", "NaN"}], "}"}], ",", " ", "\n", 
                 "          ", 
                 RowBox[{"{", 
                  RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}]}], 
              "]"}]}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
  " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cotu", "[", 
     RowBox[{"u_", " ", "/;", " ", 
      RowBox[{"uQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", " ", "=", " ", 
        RowBox[{"g2u", "[", 
         RowBox[{"cotg", "[", 
          RowBox[{"u2g", "[", "u", "]"}], "]"}], "]"}]}], "}"}], ",", " ", 
      "\n", "    ", 
      RowBox[{
       RowBox[{"ubitsmoved", " ", "+=", " ", 
        RowBox[{
         RowBox[{"nbits", "[", "u", "]"}], " ", "+", " ", 
         RowBox[{"nbits", "[", "v", "]"}]}]}], ";", " ", 
       RowBox[{"numbersmoved", " ", "+=", " ", "2"}], ";", " ", "v"}]}], 
     "]"}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"tang", "[", 
     RowBox[{"g_", " ", "/;", " ", 
      RowBox[{"gQ", "[", "g", "]"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"cotg", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"90", " ", "-", " ", 
          RowBox[{"g", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", " ", 
         RowBox[{"90", " ", "-", " ", 
          RowBox[{"g", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "}"}], ",", " ", "\n", 
       "     ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", " ", 
         RowBox[{"g", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}]}], "}"}], "]"}]}], 
   ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"tanu", "[", 
     RowBox[{"u_", " ", "/;", " ", 
      RowBox[{"uQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", " ", "=", " ", 
        RowBox[{"g2u", "[", 
         RowBox[{"tang", "[", 
          RowBox[{"u2g", "[", "u", "]"}], "]"}], "]"}]}], "}"}], ",", " ", 
      "\n", "    ", 
      RowBox[{
       RowBox[{"ubitsmoved", " ", "+=", " ", 
        RowBox[{
         RowBox[{"nbits", "[", "u", "]"}], " ", "+", " ", 
         RowBox[{"nbits", "[", "v", "]"}]}]}], ";", " ", 
       RowBox[{"numbersmoved", " ", "+=", " ", "2"}], ";", " ", "v"}]}], 
     "]"}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{"fmag", "[", 
   RowBox[{
    RowBox[{"ag_", " ", "/;", " ", 
     RowBox[{"gQ", "[", "ag", "]"}]}], ",", " ", 
    RowBox[{"bg_", " ", "/;", " ", 
     RowBox[{"gQ", "[", "bg", "]"}]}], ",", " ", 
    RowBox[{"cg_", " ", "/;", " ", 
     RowBox[{"gQ", "[", "cg", "]"}]}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"plusg", "[", 
   RowBox[{
    RowBox[{"timesg", "[", 
     RowBox[{"ag", ",", " ", "bg"}], "]"}], ",", " ", "cg"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"fmau", "[", 
   RowBox[{
    RowBox[{"au_", " ", "/;", " ", 
     RowBox[{"uQ", "[", "au", "]"}]}], ",", " ", 
    RowBox[{"bu_", " ", "/;", " ", 
     RowBox[{"uQ", "[", "bu", "]"}]}], ",", " ", 
    RowBox[{"cu_", " ", "/;", " ", 
     RowBox[{"uQ", "[", "cu", "]"}]}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"w", " ", "=", " ", 
      RowBox[{"g2u", "[", 
       RowBox[{"fmag", "[", 
        RowBox[{
         RowBox[{"u2g", "[", "au", "]"}], ",", " ", 
         RowBox[{"u2g", "[", "bu", "]"}], ",", " ", 
         RowBox[{"u2g", "[", "cu", "]"}]}], "]"}], "]"}]}], "}"}], ",", " ", 
    "\n", "   ", 
    RowBox[{
     RowBox[{"ubitsmoved", " ", "+=", " ", 
      RowBox[{
       RowBox[{"nbits", "[", "au", "]"}], " ", "+", " ", 
       RowBox[{"nbits", "[", "bu", "]"}], " ", "+", " ", 
       RowBox[{"nbits", "[", "cu", "]"}], " ", "+", " ", 
       RowBox[{"nbits", "[", "w", "]"}]}]}], ";", " ", "\n", "    ", 
     RowBox[{"numbersmoved", " ", "+=", " ", "4"}], ";", " ", "w"}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"fdotg", "[", 
   RowBox[{"ag_List", ",", " ", "bg_List"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", " ", 
      RowBox[{"legitQ", " ", "=", " ", "True"}], ",", " ", "\n", "    ", 
      RowBox[{"sumg", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"closed", ",", " ", "closed"}], "}"}]}], "}"}]}]}], "}"}], 
    ",", " ", "\n", "   ", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "ag", "]"}], " ", "!=", " ", 
       RowBox[{"Length", "[", "bg", "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<Vectors must be of equal length.\>\"", ",", " ", "\"\<Text\>\"", 
        ",", " ", "\n", "     ", 
        RowBox[{"Background", " ", "->", " ", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", " ", "0.9", ",", " ", "0.7"}], "}"}], "]"}]}]}], 
       "]"}], ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"i", " ", "<=", " ", 
          RowBox[{"Length", "[", "ag", "]"}]}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", "\n", "      ", 
         RowBox[{"legitQ", " ", "=", " ", 
          RowBox[{"legitQ", " ", "&&", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"gQ", "[", 
              RowBox[{"ag", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], " ", "&&", " ", 
             RowBox[{"gQ", "[", 
              RowBox[{"bg", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ")"}]}]}]}], "]"}], 
       ";", " ", "\n", "      ", 
       RowBox[{"!", "legitQ"}]}], ",", " ", 
      RowBox[{"Style", "[", "\n", "     ", 
       RowBox[{
       "\"\<Vector entries must be general intervals.\>\"", ",", " ", 
        "\"\<Text\>\"", ",", " ", "\n", "     ", 
        RowBox[{"Background", " ", "->", " ", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", " ", "0.9", ",", " ", "0.7"}], "}"}], "]"}]}]}], 
       "]"}], ",", " ", "True", ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"i", " ", "<=", " ", 
          RowBox[{"Length", "[", "ag", "]"}]}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", "\n", "      ", 
         RowBox[{"sumg", " ", "=", " ", 
          RowBox[{"plusg", "[", 
           RowBox[{"sumg", ",", " ", 
            RowBox[{"timesg", "[", 
             RowBox[{
              RowBox[{"ag", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
              RowBox[{"bg", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}]}], "]"}], 
       ";", " ", "sumg"}]}], "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"fdotu", "[", 
   RowBox[{"au_List", ",", " ", "bu_List"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", " ", 
      RowBox[{"legitQ", " ", "=", " ", "True"}], ",", " ", "\n", "    ", 
      RowBox[{"sumg", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"closed", ",", " ", "closed"}], "}"}]}], "}"}]}], ",", " ", 
      "w"}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "au", "]"}], " ", "!=", " ", 
       RowBox[{"Length", "[", "bu", "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<Vectors must be of equal length.\>\"", ",", " ", "\"\<Text\>\"", 
        ",", " ", "\n", "     ", 
        RowBox[{"Background", " ", "->", " ", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", " ", "0.9", ",", " ", "0.7"}], "}"}], "]"}]}]}], 
       "]"}], ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"i", " ", "<=", " ", 
          RowBox[{"Length", "[", "au", "]"}]}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", "\n", "      ", 
         RowBox[{"legitQ", " ", "=", " ", 
          RowBox[{"legitQ", " ", "&&", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"uQ", "[", 
              RowBox[{"au", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], " ", "&&", " ", 
             RowBox[{"uQ", "[", 
              RowBox[{"bu", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ")"}]}]}]}], "]"}], 
       ";", " ", "\n", "      ", 
       RowBox[{"!", "legitQ"}]}], ",", " ", 
      RowBox[{"Style", "[", "\n", "     ", 
       RowBox[{
       "\"\<Vector entries must be unums or ubounds.\>\"", ",", " ", 
        "\"\<Text\>\"", ",", " ", "\n", "     ", 
        RowBox[{"Background", " ", "->", " ", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", " ", "0.9", ",", " ", "0.7"}], "}"}], "]"}]}]}], 
       "]"}], ",", " ", "True", ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"i", " ", "<=", " ", 
          RowBox[{"Length", "[", "au", "]"}]}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", "\n", "      ", 
         RowBox[{
          RowBox[{"ubitsmoved", " ", "+=", " ", 
           RowBox[{
            RowBox[{"nbits", "[", 
             RowBox[{"au", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], " ", "+", " ", 
            RowBox[{"nbits", "[", 
             RowBox[{"bu", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], ";", " ", "\n", 
          "       ", 
          RowBox[{"sumg", " ", "=", " ", 
           RowBox[{"plusg", "[", 
            RowBox[{"sumg", ",", " ", 
             RowBox[{"timesg", "[", 
              RowBox[{
               RowBox[{"u2g", "[", 
                RowBox[{"au", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", " ", 
               RowBox[{"u2g", "[", 
                RowBox[{"bu", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}], 
            "]"}]}]}]}], "]"}], ";", " ", "\n", "     ", 
       RowBox[{"w", " ", "=", " ", 
        RowBox[{"g2u", "[", "sumg", "]"}]}], ";", " ", 
       RowBox[{"ubitsmoved", " ", "+=", " ", 
        RowBox[{"nbits", "[", "w", "]"}]}], ";", " ", "\n", "     ", 
       RowBox[{"numbersmoved", " ", "+=", " ", 
        RowBox[{
         RowBox[{"2", "*", 
          RowBox[{"Length", "[", "au", "]"}]}], " ", "+", " ", "1"}]}], ";", 
       " ", "w"}]}], "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"fsumg", "[", "ag_List", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", " ", 
      RowBox[{"legitQ", " ", "=", " ", "True"}], ",", " ", "\n", "    ", 
      RowBox[{"sumg", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"closed", ",", " ", "closed"}], "}"}]}], "}"}]}]}], "}"}], 
    ",", " ", "\n", "   ", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"i", " ", "<=", " ", 
          RowBox[{"Length", "[", "ag", "]"}]}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", "\n", "      ", 
         RowBox[{"legitQ", " ", "=", " ", 
          RowBox[{"legitQ", " ", "&&", " ", 
           RowBox[{"gQ", "[", 
            RowBox[{"ag", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}]}], "]"}], ";", "  ", 
       RowBox[{"!", "legitQ"}]}], ",", " ", "\n", "    ", 
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<List entries must be general intervals.\>\"", ",", " ", 
        "\"\<Text\>\"", ",", " ", "\n", "     ", 
        RowBox[{"Background", " ", "->", " ", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", " ", "0.9", ",", " ", "0.7"}], "}"}], "]"}]}]}], 
       "]"}], ",", " ", "True", ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"i", " ", "<=", " ", 
          RowBox[{"Length", "[", "ag", "]"}]}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", "\n", "      ", 
         RowBox[{"sumg", " ", "=", " ", 
          RowBox[{"plusg", "[", 
           RowBox[{"sumg", ",", " ", 
            RowBox[{"ag", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "]"}], ";", " ", 
       "sumg"}]}], "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"fsumu", "[", "au_List", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", " ", 
      RowBox[{"legitQ", " ", "=", " ", "True"}], ",", " ", "\n", "    ", 
      RowBox[{"sumg", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"closed", ",", " ", "closed"}], "}"}]}], "}"}]}], ",", " ", 
      "w"}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"i", " ", "<=", " ", 
          RowBox[{"Length", "[", "au", "]"}]}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", "\n", "      ", 
         RowBox[{"legitQ", " ", "=", " ", 
          RowBox[{"legitQ", " ", "&&", " ", 
           RowBox[{"uQ", "[", 
            RowBox[{"au", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}]}], "]"}], ";", "  ", 
       RowBox[{"!", "legitQ"}]}], ",", " ", "\n", "    ", 
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<List entries must be unums or ubounds.\>\"", ",", " ", 
        "\"\<Text\>\"", ",", " ", "\n", "     ", 
        RowBox[{"Background", " ", "->", " ", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", " ", "0.9", ",", " ", "0.7"}], "}"}], "]"}]}]}], 
       "]"}], ",", " ", "True", ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"i", " ", "<=", " ", 
          RowBox[{"Length", "[", "au", "]"}]}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", "\n", "      ", 
         RowBox[{
          RowBox[{"ubitsmoved", " ", "+=", " ", 
           RowBox[{"nbits", "[", 
            RowBox[{"au", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", " ", "\n", 
          "       ", 
          RowBox[{"sumg", " ", "=", " ", 
           RowBox[{"plusg", "[", 
            RowBox[{"sumg", ",", " ", 
             RowBox[{"u2g", "[", 
              RowBox[{"au", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}]}]}], "]"}], 
       ";", " ", 
       RowBox[{"w", " ", "=", " ", 
        RowBox[{"g2u", "[", "sumg", "]"}]}], ";", " ", "\n", "     ", 
       RowBox[{"ubitsmoved", " ", "+=", " ", 
        RowBox[{"nbits", "[", "w", "]"}]}], ";", " ", 
       RowBox[{"numbersmoved", " ", "+=", " ", 
        RowBox[{
         RowBox[{"Length", "[", "au", "]"}], " ", "+", " ", "1"}]}], ";", " ",
        "w"}]}], "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"fprodg", "[", "ag_List", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", " ", 
      RowBox[{"legitQ", " ", "=", " ", "True"}], ",", " ", "\n", "    ", 
      RowBox[{"prodg", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", " ", "1"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"closed", ",", " ", "closed"}], "}"}]}], "}"}]}]}], "}"}], 
    ",", " ", "\n", "   ", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"i", " ", "<=", " ", 
          RowBox[{"Length", "[", "ag", "]"}]}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", "\n", "      ", 
         RowBox[{"legitQ", " ", "=", " ", 
          RowBox[{"legitQ", " ", "&&", " ", 
           RowBox[{"gQ", "[", 
            RowBox[{"ag", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}]}], "]"}], ";", "  ", 
       RowBox[{"!", "legitQ"}]}], ",", " ", "\n", "    ", 
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<List entries must be general intervals.\>\"", ",", " ", 
        "\"\<Text\>\"", ",", " ", "\n", "     ", 
        RowBox[{"Background", " ", "->", " ", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", " ", "0.9", ",", " ", "0.7"}], "}"}], "]"}]}]}], 
       "]"}], ",", " ", "True", ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"i", " ", "<=", " ", 
          RowBox[{"Length", "[", "ag", "]"}]}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", "\n", "      ", 
         RowBox[{"prodg", " ", "=", " ", 
          RowBox[{"timesg", "[", 
           RowBox[{"prodg", ",", " ", 
            RowBox[{"ag", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "]"}], ";", " ", 
       "prodg"}]}], "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"fprodu", "[", "au_List", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", " ", 
      RowBox[{"legitQ", " ", "=", " ", "True"}], ",", " ", "\n", "    ", 
      RowBox[{"prodg", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", " ", "1"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"closed", ",", " ", "closed"}], "}"}]}], "}"}]}], ",", " ", 
      "w"}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
          RowBox[{"i", " ", "<=", " ", 
           RowBox[{"Length", "[", "au", "]"}]}], ",", " ", 
          RowBox[{"i", "++"}], ",", " ", "\n", "       ", 
          RowBox[{"legitQ", " ", "=", " ", 
           RowBox[{"legitQ", " ", "&&", " ", 
            RowBox[{"uQ", "[", 
             RowBox[{"au", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}]}], "]"}], ";", "  ", 
        RowBox[{"!", "legitQ"}]}], ",", " ", "\n", "     ", 
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<List entries must be unums or ubounds.\>\"", ",", " ", 
         "\"\<Text\>\"", ",", " ", "\n", "      ", 
         RowBox[{"Background", " ", "->", " ", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", " ", "0.9", ",", " ", "0.7"}], "}"}], "]"}]}]}],
         "]"}], ",", " ", "True", ",", " ", "\n", "     ", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
          RowBox[{"i", " ", "<=", " ", 
           RowBox[{"Length", "[", "au", "]"}]}], ",", " ", 
          RowBox[{"i", "++"}], ",", " ", "\n", "       ", 
          RowBox[{
           RowBox[{"ubitsmoved", " ", "+=", " ", 
            RowBox[{"nbits", "[", 
             RowBox[{"au", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", " ", 
           RowBox[{"prodg", " ", "=", " ", 
            RowBox[{"timesg", "[", 
             RowBox[{"prodg", ",", " ", "\n", "          ", 
              RowBox[{"u2g", "[", 
               RowBox[{"au", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}]}]}], "]"}], 
        ";", " ", 
        RowBox[{"w", " ", "=", " ", 
         RowBox[{"g2u", "[", "prodg", "]"}]}]}]}], "]"}], ";", " ", "\n", 
     "    ", 
     RowBox[{"ubitsmoved", " ", "+=", " ", 
      RowBox[{"nbits", "[", "w", "]"}]}], ";", " ", 
     RowBox[{"numbersmoved", " ", "+=", " ", 
      RowBox[{
       RowBox[{"Length", "[", "au", "]"}], " ", "+", " ", "1"}]}], ";", " ", 
     "w"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"famg", "[", 
   RowBox[{
    RowBox[{"ag_", " ", "/;", " ", 
     RowBox[{"gQ", "[", "ag", "]"}]}], ",", " ", 
    RowBox[{"bg_", " ", "/;", " ", 
     RowBox[{"gQ", "[", "bg", "]"}]}], ",", " ", 
    RowBox[{"cg_", " ", "/;", " ", 
     RowBox[{"gQ", "[", "cg", "]"}]}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"timesg", "[", 
   RowBox[{
    RowBox[{"plusg", "[", 
     RowBox[{"ag", ",", " ", "bg"}], "]"}], ",", " ", "cg"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"famu", "[", 
   RowBox[{
    RowBox[{"au_", " ", "/;", " ", 
     RowBox[{"uQ", "[", "au", "]"}]}], ",", " ", 
    RowBox[{"bu_", " ", "/;", " ", 
     RowBox[{"uQ", "[", "bu", "]"}]}], ",", " ", 
    RowBox[{"cu_", " ", "/;", " ", 
     RowBox[{"uQ", "[", "cu", "]"}]}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"w", " ", "=", " ", 
      RowBox[{"g2u", "[", 
       RowBox[{"famg", "[", 
        RowBox[{
         RowBox[{"u2g", "[", "au", "]"}], ",", " ", 
         RowBox[{"u2g", "[", "bu", "]"}], ",", " ", 
         RowBox[{"u2g", "[", "cu", "]"}]}], "]"}], "]"}]}], "}"}], ",", " ", 
    "\n", "   ", 
    RowBox[{
     RowBox[{"ubitsmoved", " ", "+=", " ", 
      RowBox[{
       RowBox[{"nbits", "[", "au", "]"}], " ", "+", " ", 
       RowBox[{"nbits", "[", "bu", "]"}], " ", "+", " ", 
       RowBox[{"nbits", "[", "cu", "]"}], " ", "+", " ", 
       RowBox[{"nbits", "[", "w", "]"}]}]}], ";", " ", "\n", "    ", 
     RowBox[{"numbersmoved", " ", "+=", " ", "4"}], ";", " ", "w"}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"fprodratiog", "[", 
   RowBox[{"numeratorsg_List", ",", " ", "denominatorsg_List"}], "]"}], " ", ":=",
   " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", " ", 
      RowBox[{"legitQ", " ", "=", " ", "True"}]}], "}"}], ",", " ", "\n", 
    "   ", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"i", " ", "<=", " ", 
        RowBox[{"Length", "[", "numeratorsg", "]"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", " ", "\n", "     ", 
       RowBox[{"legitQ", " ", "=", " ", 
        RowBox[{"legitQ", " ", "&&", " ", 
         RowBox[{"gQ", "[", 
          RowBox[{"numeratorsg", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}]}], "]"}], ";", " ", "\n",
      "    ", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"i", " ", "<=", " ", 
        RowBox[{"Length", "[", "denominatorsg", "]"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", " ", "\n", "     ", 
       RowBox[{"legitQ", " ", "=", " ", 
        RowBox[{"legitQ", " ", "&&", " ", 
         RowBox[{"gQ", "[", 
          RowBox[{"denominatorsg", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}]}], "]"}], ";", " ", "\n",
      "    ", 
     RowBox[{"If", "[", " ", 
      RowBox[{
       RowBox[{"!", "legitQ"}], ",", " ", 
       RowBox[{"Style", "[", "\n", "      ", 
        RowBox[{
        "\"\<Vector entries must be general intervals.\>\"", ",", " ", 
         "\"\<Text\>\"", ",", " ", "\n", "      ", 
         RowBox[{"Background", " ", "->", " ", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", " ", "0.9", ",", " ", "0.7"}], "}"}], "]"}]}]}],
         "]"}], ",", " ", "\n", "     ", 
       RowBox[{"divideg", "[", 
        RowBox[{
         RowBox[{"fprodg", "[", "numeratorsg", "]"}], ",", " ", 
         RowBox[{"fprodg", "[", "denominatorsg", "]"}]}], "]"}]}], "]"}]}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"fprodratiou", "[", 
   RowBox[{"numeratorsu_List", ",", " ", "denominatorsu_List"}], "]"}], " ", ":=",
   " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", " ", 
      RowBox[{"legitQ", " ", "=", " ", "True"}], ",", " ", 
      RowBox[{"lengthden", " ", "=", " ", 
       RowBox[{"Length", "[", "denominatorsu", "]"}]}], ",", " ", "\n", 
      "    ", 
      RowBox[{"lengthnum", " ", "=", " ", 
       RowBox[{"Length", "[", "numeratorsu", "]"}]}], ",", " ", "\n", "    ", 
      
      RowBox[{"proddeng", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", " ", "1"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"closed", ",", " ", "closed"}], "}"}]}], "}"}]}], ",", " ", 
      "\n", "    ", 
      RowBox[{"prodnumg", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", " ", "1"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"closed", ",", " ", "closed"}], "}"}]}], "}"}]}], ",", " ", 
      "w"}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"i", " ", "<=", " ", "lengthden"}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", "\n", "      ", 
         RowBox[{"legitQ", " ", "=", " ", 
          RowBox[{"legitQ", " ", "&&", " ", 
           RowBox[{"uQ", "[", 
            RowBox[{"denominatorsu", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}]}], "]"}], ";", " ", 
       "\n", "     ", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"i", " ", "<=", " ", "lengthnum"}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", "\n", "      ", 
         RowBox[{"legitQ", " ", "=", " ", 
          RowBox[{"legitQ", " ", "&&", " ", 
           RowBox[{"uQ", "[", 
            RowBox[{"numeratorsu", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}]}], "]"}], ";", " ", 
       "\n", "      ", 
       RowBox[{
        RowBox[{"!", "legitQ"}], " ", "||", " ", 
        RowBox[{"lengthden", " ", "<", " ", "1"}], " ", "||", " ", 
        RowBox[{"lengthnum", " ", "<", " ", "1"}]}]}], ",", " ", "\n", "    ", 
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<Vector entries must be unums or ubounds\>\"", ",", " ", 
        "\"\<Text\>\"", ",", " ", "\n", "     ", 
        RowBox[{"Background", " ", "->", " ", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", " ", "0.9", ",", " ", "0.7"}], "}"}], "]"}]}]}], 
       "]"}], ",", " ", "True", ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"i", " ", "<=", " ", "lengthden"}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", "\n", "      ", 
         RowBox[{
          RowBox[{"ubitsmoved", " ", "+=", " ", 
           RowBox[{"nbits", "[", 
            RowBox[{"denominatorsu", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", " ", "\n", 
          "       ", 
          RowBox[{"proddeng", " ", "=", " ", 
           RowBox[{"timesg", "[", 
            RowBox[{"proddeng", ",", " ", 
             RowBox[{"u2g", "[", 
              RowBox[{"denominatorsu", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}]}]}], "]"}], 
       ";", " ", "\n", "     ", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"i", " ", "<=", " ", "lengthnum"}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", "\n", "      ", 
         RowBox[{
          RowBox[{"ubitsmoved", " ", "+=", " ", 
           RowBox[{"nbits", "[", 
            RowBox[{"numeratorsu", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", " ", "\n", 
          "       ", 
          RowBox[{"prodnumg", " ", "=", " ", 
           RowBox[{"timesg", "[", 
            RowBox[{"prodnumg", ",", " ", 
             RowBox[{"u2g", "[", 
              RowBox[{"numeratorsu", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}]}]}], "]"}], 
       ";", " ", "\n", "     ", 
       RowBox[{"w", " ", "=", " ", 
        RowBox[{"g2u", "[", 
         RowBox[{"divideg", "[", 
          RowBox[{"prodnumg", ",", " ", "proddeng"}], "]"}], "]"}]}], ";", 
       " ", "\n", "     ", 
       RowBox[{"ubitsmoved", " ", "+=", " ", 
        RowBox[{"nbits", "[", "w", "]"}]}], ";", " ", 
       RowBox[{"numbersmoved", " ", "+=", " ", "\n", "      ", 
        RowBox[{
        "lengthden", " ", "+", " ", "lengthnum", " ", "+", " ", "1"}]}], ";", 
       " ", "w"}]}], "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"cfftu", "[", 
   RowBox[{"rru_List", ",", " ", "n_Integer", ",", " ", "iflg_Integer"}], 
   "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ggu", " ", "=", " ", "rru"}], ",", " ", "i", ",", " ", "j", 
      ",", " ", 
      RowBox[{"k", " ", "=", " ", 
       RowBox[{"n", "/", "2"}]}], ",", " ", "\n", "    ", 
      RowBox[{"th", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"iflg", " ", ">=", " ", "0"}], ",", " ", 
         RowBox[{"-", "Pi"}], ",", " ", "Pi"}], "]"}]}], ",", " ", "tru", ",",
       " ", "tiu", ",", " ", "twiddleu", ",", " ", "wwu"}], "}"}], ",", " ", 
    "\n", "   ", 
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"k", " ", ">=", " ", "1"}], ",", " ", 
       RowBox[{
        RowBox[{"wwu", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x2u", "[", 
             RowBox[{
              RowBox[{"-", "2"}], "*", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"th", "/", 
                 RowBox[{"(", 
                  RowBox[{"2", "*", "k"}], ")"}]}], "]"}], "^", "2"}]}], 
             "]"}], "}"}], ",", " ", "\n", "        ", 
           RowBox[{"{", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"x2u", "[", "th", "]"}], "/", "k"}], "]"}], "}"}]}], 
          "}"}]}], ";", " ", 
        RowBox[{"twiddleu", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x2u", "[", "1", "]"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"x2u", "[", "0", "]"}], "}"}]}], "}"}]}], ";", " ", "\n", 
        "      ", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", " ", "=", " ", "0"}], ",", " ", 
          RowBox[{"j", " ", "<", " ", "k"}], ",", " ", 
          RowBox[{"j", "++"}], ",", " ", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
             RowBox[{"i", " ", "<=", " ", "n"}], ",", " ", 
             RowBox[{"i", " ", "+=", " ", 
              RowBox[{"2", "*", "k"}]}], ",", " ", "\n", "         ", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"tru", ",", " ", "tiu"}], "}"}], " ", "=", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"smartunify", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ggu", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", " ", "+", " ", "j"}], ",", "1"}], "]"}], 
                    "]"}], " ", "\[CircleMinus]", " ", "\n", "              ", 
                    RowBox[{"ggu", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", " ", "+", " ", "j", " ", "+", " ", "k"}], 
                    ",", "1"}], "]"}], "]"}]}], ",", " ", "1"}], "]"}], ",", 
                 " ", 
                 RowBox[{"smartunify", "[", "\n", "             ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ggu", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", " ", "+", " ", "j"}], ",", "2"}], "]"}], 
                    "]"}], " ", "\[CircleMinus]", " ", 
                    RowBox[{"ggu", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", " ", "+", " ", "j", " ", "+", " ", "k"}], 
                    ",", "2"}], "]"}], "]"}]}], ",", " ", "1"}], "]"}]}], 
                "}"}]}], ";", " ", "\n", "          ", 
              RowBox[{
               RowBox[{"ggu", "[", 
                RowBox[{"[", 
                 RowBox[{"i", " ", "+", " ", "j"}], "]"}], "]"}], " ", "=", 
               " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"smartunify", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ggu", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", " ", "+", " ", "j"}], ",", "1"}], "]"}], 
                    "]"}], " ", "\[CirclePlus]", " ", "\n", "              ", 
                    
                    RowBox[{"ggu", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", " ", "+", " ", "j", " ", "+", " ", "k"}], 
                    ",", "1"}], "]"}], "]"}]}], ",", " ", "1"}], "]"}], ",", 
                 " ", 
                 RowBox[{"smartunify", "[", "\n", "             ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ggu", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", " ", "+", " ", "j"}], ",", "2"}], "]"}], 
                    "]"}], " ", "\[CirclePlus]", " ", 
                    RowBox[{"ggu", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", " ", "+", " ", "j", " ", "+", " ", "k"}], 
                    ",", "2"}], "]"}], "]"}]}], ",", " ", "1"}], "]"}]}], 
                "}"}]}], ";", " ", "\n", "          ", 
              RowBox[{
               RowBox[{"ggu", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i", " ", "+", " ", "j", " ", "+", " ", "k"}], ",", 
                  "1"}], "]"}], "]"}], " ", "=", " ", 
               RowBox[{"smartunify", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"twiddleu", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "\[CircleTimes]", 
                   " ", "\n", "              ", "tru"}], " ", 
                  "\[CircleMinus]", " ", 
                  RowBox[{
                   RowBox[{"twiddleu", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "\[CircleTimes]", 
                   " ", "tiu"}]}], ",", " ", "1"}], "]"}]}], ";", " ", "\n", 
              "          ", 
              RowBox[{
               RowBox[{"ggu", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i", " ", "+", " ", "j", " ", "+", " ", "k"}], ",", 
                  "2"}], "]"}], "]"}], " ", "=", " ", 
               RowBox[{"smartunify", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"twiddleu", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "\[CircleTimes]", 
                   " ", "\n", "              ", "tiu"}], " ", "\[CirclePlus]",
                   " ", 
                  RowBox[{
                   RowBox[{"twiddleu", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "\[CircleTimes]", 
                   " ", "tru"}]}], ",", " ", "1"}], "]"}]}]}]}], "]"}], ";", 
           " ", "\n", "        ", 
           RowBox[{"tru", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"twiddleu", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "\[CircleTimes]", " ", 
               RowBox[{"wwu", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], " ", "\[CircleMinus]", " ", 
              
              RowBox[{
               RowBox[{"twiddleu", "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "\[CircleTimes]", " ", 
               "\n", "            ", 
               RowBox[{"wwu", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], " ", "\[CirclePlus]", " ", 
             RowBox[{"twiddleu", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], ";", " ", 
           RowBox[{
            RowBox[{"twiddleu", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", "\n", "         ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"twiddleu", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", "\[CircleTimes]", " ", 
                RowBox[{"wwu", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], " ", "\[CirclePlus]", " ", 
               
               RowBox[{
                RowBox[{"twiddleu", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "\[CircleTimes]", " ", 
                "\n", "            ", 
                RowBox[{"wwu", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], " ", 
             "\[CirclePlus]", " ", 
             RowBox[{"twiddleu", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], ";", " ", 
           RowBox[{
            RowBox[{"twiddleu", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "tru"}]}]}], 
         "]"}], ";", " ", "\n", "      ", 
        RowBox[{"k", " ", "=", " ", 
         RowBox[{"k", "/", "2"}]}]}]}], "]"}], ";", " ", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", 
        RowBox[{"j", " ", "=", " ", "0"}]}], ",", " ", 
       RowBox[{"i", " ", "<", " ", 
        RowBox[{"n", " ", "-", " ", "1"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", " ", "\n", "     ", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", " ", "<", " ", "j"}], ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"tru", ",", " ", "tiu"}], "}"}], " ", "=", " ", 
            RowBox[{"ggu", "[", 
             RowBox[{"[", 
              RowBox[{"j", " ", "+", " ", "1"}], "]"}], "]"}]}], ";", " ", 
           RowBox[{
            RowBox[{"ggu", "[", 
             RowBox[{"[", 
              RowBox[{"j", " ", "+", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
            "\n", "         ", 
            RowBox[{"ggu", "[", 
             RowBox[{"[", 
              RowBox[{"i", " ", "+", " ", "1"}], "]"}], "]"}]}], ";", " ", 
           RowBox[{
            RowBox[{"ggu", "[", 
             RowBox[{"[", 
              RowBox[{"i", " ", "+", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
            
            RowBox[{"{", 
             RowBox[{"tru", ",", " ", "tiu"}], "}"}]}]}]}], "]"}], ";", " ", 
        RowBox[{"k", " ", "=", " ", 
         RowBox[{"n", "/", "2"}]}], ";", " ", "\n", "      ", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"k", " ", "<=", " ", "j"}], ",", " ", 
          RowBox[{
           RowBox[{"j", " ", "=", " ", 
            RowBox[{"j", " ", "-", " ", "k"}]}], ";", " ", 
           RowBox[{"k", " ", "=", " ", 
            RowBox[{"k", "/", "2"}]}]}]}], "]"}], ";", " ", 
        RowBox[{"j", " ", "=", " ", 
         RowBox[{"j", " ", "+", " ", "k"}]}]}]}], "]"}], ";", " ", "ggu"}]}], 
   "]"}]}]}], "Input",
 CellMargins->{{49, Inherited}, {1, 1}},
 InitializationCell->True,
 CellChangeTimes->{{3.580298050513713*^9, 3.580298159783435*^9}, {
   3.580298199572612*^9, 3.580298272767013*^9}, {3.580298436671176*^9, 
   3.5802984392809877`*^9}, {3.580298486368454*^9, 3.580298508119864*^9}, {
   3.580298892709241*^9, 3.5802989898516808`*^9}, {3.580299036933043*^9, 
   3.5802990759411497`*^9}, {3.580301096553261*^9, 3.580301107900325*^9}, 
   3.580407185618232*^9, {3.5804073411934566`*^9, 3.5804074162225933`*^9}, {
   3.580409883925783*^9, 3.580409966611824*^9}, {3.5804100146695833`*^9, 
   3.5804100498518457`*^9}, {3.5804100829154263`*^9, 
   3.5804101128653603`*^9}, {3.580425448449752*^9, 3.580425448779365*^9}, {
   3.5804261201173267`*^9, 3.580426208877038*^9}, {3.580426265284741*^9, 
   3.580426350403449*^9}, {3.580426485679954*^9, 3.5804264905641737`*^9}, 
   3.5804279203282843`*^9, 3.580428142103916*^9, {3.5804282229099073`*^9, 
   3.580428236525876*^9}, {3.580428596651292*^9, 3.580428636427302*^9}, 
   3.580428697853199*^9, {3.5804288226414557`*^9, 3.580428899491375*^9}, {
   3.580429105490171*^9, 3.580429114809146*^9}, {3.58047836218604*^9, 
   3.580478387135298*^9}, {3.580478426265153*^9, 3.580478432336335*^9}, {
   3.580478546403347*^9, 3.5804785478701687`*^9}, {3.58050672117647*^9, 
   3.580506907360235*^9}, {3.580506966415413*^9, 3.580507005277861*^9}, {
   3.580507064963773*^9, 3.580507067911181*^9}, {3.580507106619545*^9, 
   3.580507133988846*^9}, {3.5805173485253267`*^9, 3.5805173614119787`*^9}, {
   3.5805174649883432`*^9, 3.5805174904422617`*^9}, {3.580517982687579*^9, 
   3.580517983270061*^9}, {3.580518225267564*^9, 3.580518274450782*^9}, {
   3.580553307093566*^9, 3.580553314032319*^9}, {3.580564151300725*^9, 
   3.580564156005431*^9}, {3.580564198852427*^9, 3.580564217883697*^9}, {
   3.580564271980632*^9, 3.5805642844351788`*^9}, {3.580564410577867*^9, 
   3.58056442844328*^9}, 3.5805670555833*^9, {3.580567795170231*^9, 
   3.580567804792451*^9}, {3.5805681765764*^9, 3.580568178149033*^9}, {
   3.580568247798682*^9, 3.580568272596991*^9}, {3.580568508184713*^9, 
   3.580568537933886*^9}, {3.580568653258788*^9, 3.580568656162497*^9}, {
   3.5805687034983*^9, 3.58056875067342*^9}, {3.580569020825623*^9, 
   3.5805690326636677`*^9}, 3.5807399271706133`*^9, {3.580839338424562*^9, 
   3.580839352590754*^9}, {3.58083938395133*^9, 3.5808394159264107`*^9}, {
   3.58179076605632*^9, 3.5817908291653023`*^9}, {3.581791726054412*^9, 
   3.581791751892557*^9}, {3.5817918449016743`*^9, 3.58179187167181*^9}, {
   3.5828199539226913`*^9, 3.5828199616691113`*^9}, {3.5834302529567213`*^9, 
   3.583430254556594*^9}, {3.587909478641012*^9, 3.587909479129734*^9}, {
   3.5879096375190372`*^9, 3.5879096436539183`*^9}, {3.587909712515162*^9, 
   3.587909715539117*^9}, {3.587909855809832*^9, 3.587909889495844*^9}, {
   3.5879099949218683`*^9, 3.587909996489438*^9}, {3.587910035431437*^9, 
   3.5879100375866547`*^9}, {3.587910096690349*^9, 3.587910125274394*^9}, {
   3.587910256394767*^9, 3.587910285202273*^9}, {3.587910341109633*^9, 
   3.587910353597309*^9}, {3.587910506851668*^9, 3.5879105076531267`*^9}, {
   3.5879105757037897`*^9, 3.587910576200951*^9}, {3.5879107669811*^9, 
   3.58791076850147*^9}, {3.587910872927346*^9, 3.587910890624839*^9}, {
   3.5879109802010593`*^9, 3.587910981642737*^9}, {3.587911057509115*^9, 
   3.587911080717304*^9}, {3.5879111858543873`*^9, 3.587911186713225*^9}, {
   3.5879112599940987`*^9, 3.587911263475442*^9}, {3.587911294119294*^9, 
   3.5879112958912687`*^9}, {3.58791137719527*^9, 3.587911377974805*^9}, {
   3.5879114983323317`*^9, 3.587911499527094*^9}, {3.587911544970408*^9, 
   3.5879115740591507`*^9}, {3.587911623670957*^9, 3.587911624785001*^9}, {
   3.5879116795158577`*^9, 3.587911679854506*^9}, {3.587911901622241*^9, 
   3.587911901913745*^9}, {3.5879119539881*^9, 3.587912022940012*^9}, {
   3.5879120642548103`*^9, 3.587912065009788*^9}, {3.587912175432179*^9, 
   3.587912189362751*^9}, {3.587912246132987*^9, 3.587912260447584*^9}, {
   3.587912294833497*^9, 3.5879122963564568`*^9}, {3.587912730239882*^9, 
   3.5879127318148108`*^9}, {3.5879127919161987`*^9, 3.587912813600243*^9}, {
   3.587912891382753*^9, 3.587912949517733*^9}, {3.5879129805235157`*^9, 
   3.587912982980937*^9}, {3.5879131859655867`*^9, 3.587913187306343*^9}, {
   3.587913249738021*^9, 3.587913252245919*^9}, {3.587913338419718*^9, 
   3.587913380564851*^9}, {3.587913535777323*^9, 3.587913537068199*^9}, {
   3.587913702885401*^9, 3.587913704067244*^9}, {3.587913750548087*^9, 
   3.587913786866914*^9}, {3.587914093852672*^9, 3.587914094236862*^9}, {
   3.587914261475312*^9, 3.58791426184097*^9}, {3.587914360629822*^9, 
   3.58791438068326*^9}, {3.587914484783248*^9, 3.587914533658374*^9}, {
   3.5879146411322927`*^9, 3.587914646313336*^9}, {3.587914701697352*^9, 
   3.587914757310111*^9}, 3.587914837025895*^9, 3.587915003417149*^9, {
   3.5879327627788773`*^9, 3.5879328427292557`*^9}, {3.5922158927441273`*^9, 
   3.5922158931839647`*^9}, 3.592215959764965*^9, 3.59277611871113*^9, 
   3.5938994900977087`*^9, {3.5943258152811337`*^9, 3.594325816213779*^9}, {
   3.5943521340055027`*^9, 3.5943522496649237`*^9}, {3.594390382458068*^9, 
   3.594390389164937*^9}, {3.5943904841050177`*^9, 3.594390490284296*^9}, {
   3.594390554971953*^9, 3.594390559788272*^9}, {3.5944516933232317`*^9, 
   3.594451694655644*^9}, {3.594451749679246*^9, 3.594451763602281*^9}, {
   3.594451877380302*^9, 3.594451887463608*^9}, {3.594452197178338*^9, 
   3.5944521985075407`*^9}, {3.594452241914612*^9, 3.594452252526926*^9}, {
   3.594452684167313*^9, 3.5944527921951847`*^9}, {3.594452936178753*^9, 
   3.594452941698814*^9}, {3.594453188520314*^9, 3.594453189971349*^9}, {
   3.594453653107585*^9, 3.594453654309108*^9}, {3.594468747216604*^9, 
   3.5944687774963417`*^9}, {3.594469007875073*^9, 3.5944690297845793`*^9}, {
   3.5944984781041737`*^9, 3.594498502092618*^9}, {3.59449871647021*^9, 
   3.594498879755804*^9}, {3.594498938800415*^9, 3.594498942055294*^9}, {
   3.594499263378154*^9, 3.594499285842998*^9}, {3.594499348860486*^9, 
   3.594499351334875*^9}, {3.59450416127113*^9, 3.594504172146974*^9}, {
   3.594504307321096*^9, 3.59450434971206*^9}, {3.594504752623733*^9, 
   3.5945047554061003`*^9}, {3.594504871225806*^9, 3.594504877936388*^9}, {
   3.5945055596668262`*^9, 3.594505568425068*^9}, {3.594652239886821*^9, 
   3.594652267738048*^9}, {3.59467142959534*^9, 3.594671431027108*^9}, {
   3.594932848207707*^9, 3.594932849799758*^9}, {3.594935348185996*^9, 
   3.594935350732348*^9}, {3.5949366625927267`*^9, 3.594936675178787*^9}, 
   3.595016298168294*^9, {3.595098352380693*^9, 3.59509838081502*^9}, {
   3.5950984859828587`*^9, 3.5950984975538483`*^9}, {3.5950992060014563`*^9, 
   3.595099209200944*^9}, {3.595106755617092*^9, 3.59510675682261*^9}, {
   3.595107319003234*^9, 3.595107326236487*^9}, {3.5951073744774647`*^9, 
   3.5951073843720512`*^9}, {3.5951117379493723`*^9, 3.595111746063115*^9}, {
   3.5951119238417053`*^9, 3.595111932456912*^9}, 3.595365716483788*^9, {
   3.596223353341857*^9, 3.596223359166494*^9}, {3.596227444951634*^9, 
   3.5962274497080107`*^9}, {3.596273577984915*^9, 3.596273605071785*^9}, 
   3.59646386845551*^9, {3.5965515766090918`*^9, 3.5965515896029987`*^9}, {
   3.596722017251544*^9, 3.5967220304878397`*^9}, {3.596761099718512*^9, 
   3.596761109185371*^9}, {3.59706725444414*^9, 3.5970672563701468`*^9}, {
   3.5970676907405777`*^9, 3.597067708722151*^9}, {3.5970991684417887`*^9, 
   3.597099168913548*^9}, {3.597319798822302*^9, 3.597319811922399*^9}, 
   3.597319850413365*^9, {3.597857215471332*^9, 3.597857267226129*^9}, {
   3.5978573137256327`*^9, 3.597857326631215*^9}, {3.59801452019693*^9, 
   3.598014521531755*^9}, 3.599851751650032*^9, {3.600706606144747*^9, 
   3.600706659773452*^9}, {3.60339581989427*^9, 3.6033958214954157`*^9}, {
   3.603409145758832*^9, 3.603409147201283*^9}, {3.603542970928772*^9, 
   3.6035429724744463`*^9}, {3.603550173037918*^9, 3.603550174671896*^9}, {
   3.603807370507317*^9, 3.60380738211386*^9}, {3.6038074877638063`*^9, 
   3.603807519807238*^9}, {3.603816404753533*^9, 3.603816406053636*^9}, {
   3.6039676533349133`*^9, 3.6039676768589697`*^9}, {3.603968007083645*^9, 
   3.603968014243576*^9}, {3.603971334990003*^9, 3.6039713803342733`*^9}, {
   3.603981691772496*^9, 3.603981692121807*^9}, {3.604003465394865*^9, 
   3.604003466630534*^9}, {3.6040040079694347`*^9, 3.6040040692227783`*^9}, {
   3.604004197041348*^9, 3.604004241826613*^9}, {3.604004276313704*^9, 
   3.6040043349571238`*^9}, {3.6040043805692053`*^9, 3.604004421463447*^9}, {
   3.604004469895645*^9, 3.604004513922512*^9}, {3.6040046278857517`*^9, 
   3.604004635042556*^9}, {3.604052919653323*^9, 3.604052921074033*^9}, 
   3.604056132882725*^9, {3.6040561814003143`*^9, 3.6040562364912148`*^9}, {
   3.604058052219502*^9, 3.604058053788744*^9}, {3.604081585639173*^9, 
   3.604081586818005*^9}, {3.6041012628885098`*^9, 3.604101263982148*^9}, {
   3.6041526413593903`*^9, 3.604152778317606*^9}, {3.604161038154252*^9, 
   3.604161044412672*^9}, {3.6041612029800053`*^9, 3.604161208063031*^9}, {
   3.6045165038236322`*^9, 3.604516506129974*^9}, {3.605041402439681*^9, 
   3.6050414034227552`*^9}, {3.605094441465953*^9, 3.605094442533757*^9}, {
   3.605905669180859*^9, 3.605905670413966*^9}, {3.606504052876608*^9, 
   3.606504053852453*^9}, {3.60656524662658*^9, 3.606565247870693*^9}, 
   3.60770074465532*^9, {3.607700894491021*^9, 3.6077009437496147`*^9}, {
   3.6077010589554567`*^9, 3.60770108050249*^9}, {3.607701173447282*^9, 
   3.6077013476842003`*^9}, 3.607708952229067*^9, {3.6077090649010468`*^9, 
   3.6077091270652313`*^9}, {3.607709164485268*^9, 3.607709167121694*^9}, {
   3.609681343399515*^9, 3.6096813721101437`*^9}, {3.609697539767413*^9, 
   3.6096975414792*^9}, {3.609784526919179*^9, 3.60978462056979*^9}, {
   3.6097850440602703`*^9, 3.609785056318077*^9}, 3.6098593388850737`*^9, {
   3.6105006460914288`*^9, 3.6105006471020927`*^9}, {3.610501797082596*^9, 
   3.6105019212384987`*^9}, {3.610541389991515*^9, 3.610541410604353*^9}, {
   3.610543438875368*^9, 3.61054344260537*^9}, {3.610543504896633*^9, 
   3.610543535107634*^9}, {3.610543612572315*^9, 3.610543684484585*^9}, 
   3.6105437227991667`*^9, 3.610543773069769*^9, {3.610657404227602*^9, 
   3.610657412986354*^9}, {3.610830808462391*^9, 3.610830947947979*^9}, {
   3.611057852565778*^9, 3.611057891313137*^9}, {3.6113244162270184`*^9, 
   3.611324525005494*^9}, {3.611325842651414*^9, 3.611325964787428*^9}, {
   3.6113301791609898`*^9, 3.611330204158825*^9}, 3.611334908508106*^9, 
   3.611335183756899*^9, {3.6113364162237377`*^9, 3.611336472433091*^9}, {
   3.611336504227975*^9, 3.6113365053152027`*^9}, {3.611337235444765*^9, 
   3.611337273708741*^9}, {3.611337377922061*^9, 3.611337397816841*^9}, 
   3.611337434170796*^9, {3.6113378787222967`*^9, 3.611337920455288*^9}, {
   3.6113384139425898`*^9, 3.611338524437406*^9}, {3.6113403309763823`*^9, 
   3.611340341607003*^9}, {3.6113403952528553`*^9, 3.6113405634536953`*^9}, {
   3.611344200446971*^9, 3.611344417316568*^9}, {3.611344449296412*^9, 
   3.611344614866522*^9}, {3.611344737207652*^9, 3.611344895274699*^9}, {
   3.6113449318963947`*^9, 3.6113449552207823`*^9}, {3.6113452968814096`*^9, 
   3.6113453496805487`*^9}, {3.611345388511642*^9, 3.611345540872859*^9}, {
   3.6113456025478287`*^9, 3.6113457898957577`*^9}, {3.611345841698388*^9, 
   3.611346110093336*^9}, {3.611346605656618*^9, 3.611346659455295*^9}, {
   3.6113467023446302`*^9, 3.611346786711089*^9}, {3.611346877714183*^9, 
   3.61134701911701*^9}, {3.611347067421777*^9, 3.611347560003193*^9}, {
   3.611347617686076*^9, 3.611347623661186*^9}, {3.611352285431233*^9, 
   3.611352325555724*^9}, {3.611352411160118*^9, 3.6113524116636333`*^9}, {
   3.611352466830634*^9, 3.6113524684418297`*^9}, 3.6113526502197647`*^9, 
   3.611352786606023*^9, {3.6113530238330584`*^9, 3.6113531511383543`*^9}, {
   3.611401934112834*^9, 3.6114019892534027`*^9}, {3.611402144957292*^9, 
   3.611402184563339*^9}, {3.611402226086554*^9, 3.611402453604703*^9}, {
   3.611402689136094*^9, 3.6114027230610533`*^9}, {3.611402818278263*^9, 
   3.611402940785427*^9}, {3.611402971768086*^9, 3.611403099005699*^9}, {
   3.6114031514786043`*^9, 3.611403161452056*^9}, {3.611403355055861*^9, 
   3.61140340816798*^9}, {3.611403464421294*^9, 3.611403501780781*^9}, {
   3.611403553132329*^9, 3.611403581168152*^9}, {3.61140363195821*^9, 
   3.611403633073916*^9}, {3.611403672052104*^9, 3.6114037409089327`*^9}, {
   3.61140377668631*^9, 3.611403945457706*^9}, {3.611404060585659*^9, 
   3.6114040867769938`*^9}, {3.6114043793308973`*^9, 3.611404413656144*^9}, {
   3.611404580949699*^9, 3.611404606189232*^9}, {3.6114048023772697`*^9, 
   3.611404825416172*^9}, {3.611404883691124*^9, 3.611404927119955*^9}, {
   3.611404981701631*^9, 3.611405002996537*^9}, {3.611406857101919*^9, 
   3.611406920422085*^9}, {3.6114069956593447`*^9, 3.611407016893119*^9}, {
   3.6114090858805647`*^9, 3.611409129508759*^9}, {3.611409175567478*^9, 
   3.61140921737576*^9}, {3.611409253019392*^9, 3.611409311418614*^9}, {
   3.611409346039339*^9, 3.611409359112913*^9}, {3.611409433481669*^9, 
   3.6114095085067873`*^9}, {3.611409539830052*^9, 3.611409563104268*^9}, {
   3.611409648183095*^9, 3.611409680785637*^9}, {3.611409719884927*^9, 
   3.611409735773966*^9}, {3.6114111843873253`*^9, 3.6114112154973993`*^9}, {
   3.611428594619253*^9, 3.611428613320983*^9}, {3.611503089447872*^9, 
   3.6115033934831676`*^9}, 3.611503448539278*^9, {3.611503479980041*^9, 
   3.6115035000955544`*^9}, {3.611505715430374*^9, 3.611505772130348*^9}, {
   3.611505805718206*^9, 3.611505817598289*^9}, {3.611505928692836*^9, 
   3.6115059296782637`*^9}, {3.61150610514246*^9, 3.611506168097466*^9}, {
   3.6115908447877913`*^9, 3.611590992206379*^9}, {3.611591312323811*^9, 
   3.611591415450995*^9}, {3.611591446993956*^9, 3.611591533353236*^9}, {
   3.6115917671362953`*^9, 3.611591781865183*^9}, {3.611591845643044*^9, 
   3.611591873296452*^9}, {3.611591948171556*^9, 3.611591980731173*^9}, {
   3.611592078859605*^9, 3.611592106896896*^9}, {3.611592203972699*^9, 
   3.611592224256708*^9}, {3.6115922551789637`*^9, 3.61159225528025*^9}, {
   3.611602129828635*^9, 3.6116021785686502`*^9}, {3.611602310562924*^9, 
   3.6116023409990673`*^9}, {3.611602383670669*^9, 3.611602490258275*^9}, {
   3.611602602367505*^9, 3.611602629061698*^9}, {3.611602662396019*^9, 
   3.611602664210948*^9}, {3.6116027568029213`*^9, 3.6116028432384653`*^9}, {
   3.611602928737363*^9, 3.611602934801454*^9}, {3.611603001580304*^9, 
   3.611603026937208*^9}, {3.611603194235249*^9, 3.611603199486364*^9}, {
   3.611603273589836*^9, 3.611603284247612*^9}, {3.611603515262145*^9, 
   3.6116036793511143`*^9}, {3.611603736896163*^9, 3.611603807345518*^9}, {
   3.611604839983081*^9, 3.6116048565128593`*^9}, {3.6116049285067377`*^9, 
   3.61160495140959*^9}, {3.611604997674511*^9, 3.611605004604744*^9}, 
   3.611607719047611*^9, {3.6116095283711452`*^9, 3.611609536781147*^9}, {
   3.6116098104981318`*^9, 3.611609843469531*^9}, {3.611612426581737*^9, 
   3.611612470036147*^9}, {3.611612556944491*^9, 3.6116125618311462`*^9}, 
   3.611614052823285*^9, {3.611614295234661*^9, 3.61161430136981*^9}, {
   3.611616632537026*^9, 3.611616662391904*^9}, {3.611616736943976*^9, 
   3.6116167840951557`*^9}, {3.611616817425606*^9, 3.611616820700158*^9}, {
   3.611616887527769*^9, 3.611616907819735*^9}, {3.611616994562722*^9, 
   3.611617035714443*^9}, {3.611617073553857*^9, 3.611617131949247*^9}, {
   3.6116171626984987`*^9, 3.6116172278120947`*^9}, {3.611617279131094*^9, 
   3.6116172851157427`*^9}, {3.6116214556237173`*^9, 3.611621521450667*^9}, 
   3.611645384454369*^9, {3.611645447226398*^9, 3.6116454481442823`*^9}, {
   3.6116606243403473`*^9, 3.611660637124936*^9}, {3.611660672869735*^9, 
   3.6116606842035427`*^9}, {3.611660764767602*^9, 3.611660806596868*^9}, {
   3.611660839072846*^9, 3.611660904064067*^9}, 3.6116609390431633`*^9, {
   3.611661027073657*^9, 3.611661066539721*^9}, {3.611662263323892*^9, 
   3.611662268539956*^9}, {3.611662408059132*^9, 3.611662553491457*^9}, {
   3.611662662679879*^9, 3.6116627117447157`*^9}, {3.611662923948555*^9, 
   3.611662929533847*^9}, {3.611662977803617*^9, 3.611663058956764*^9}, {
   3.611663089909041*^9, 3.611663104018507*^9}, {3.611663141620193*^9, 
   3.6116631614014997`*^9}, {3.6116636725641003`*^9, 3.611663804623563*^9}, {
   3.6116638376366863`*^9, 3.6116639911985693`*^9}, {3.611770295393733*^9, 
   3.6117703038462877`*^9}, {3.6118344094276457`*^9, 3.611834413541534*^9}, 
   3.61202964405189*^9, {3.612030464816306*^9, 3.6120304673500843`*^9}, {
   3.612038530581665*^9, 3.6120385530358353`*^9}, {3.612038677745232*^9, 
   3.6120386961277523`*^9}, {3.612039787786324*^9, 3.612039844720715*^9}, {
   3.612039896245668*^9, 3.6120398984752274`*^9}, {3.6120399491878223`*^9, 
   3.612039964938209*^9}, {3.612040141366255*^9, 3.61204022567817*^9}, {
   3.6120402666214113`*^9, 3.6120402791189213`*^9}, {3.6120403983146057`*^9, 
   3.6120404147866917`*^9}, {3.6120404708941097`*^9, 3.612040485387714*^9}, {
   3.612040535471334*^9, 3.612040577773923*^9}, {3.6120406727611313`*^9, 
   3.612040676615737*^9}, {3.612040725911175*^9, 3.6120408591467953`*^9}, {
   3.6120415957773113`*^9, 3.612041653989353*^9}, {3.612041906958583*^9, 
   3.612041944105445*^9}, {3.612041977938911*^9, 3.612041978658618*^9}, {
   3.6120420201878633`*^9, 3.6120421165004168`*^9}, {3.612042163106473*^9, 
   3.61204216471154*^9}, {3.6120940316965837`*^9, 3.6120940386582327`*^9}, {
   3.612094077533141*^9, 3.612094174529667*^9}, 3.612095804000678*^9, {
   3.6120958793269167`*^9, 3.612095894821218*^9}, {3.6120959317496243`*^9, 
   3.612095993606543*^9}, {3.612096634369329*^9, 3.612096640992239*^9}, {
   3.61209956121142*^9, 3.612099601596951*^9}, {3.61209967291033*^9, 
   3.612099739569571*^9}, {3.612099797732602*^9, 3.612099886816708*^9}, {
   3.612099967677156*^9, 3.612100022806437*^9}, {3.612100089948083*^9, 
   3.612100180475606*^9}, {3.6121002325001163`*^9, 3.6121002530443373`*^9}, {
   3.6121003598869247`*^9, 3.612100431919997*^9}, {3.612123869528582*^9, 
   3.61212387641847*^9}, {3.612124095545298*^9, 3.6121240967194347`*^9}, {
   3.6121242999416847`*^9, 3.612124309348521*^9}, {3.61213280493814*^9, 
   3.612132828697994*^9}, 3.61226765757825*^9, {3.612385597998209*^9, 
   3.612385647061499*^9}, {3.612385678049781*^9, 3.612385678663199*^9}, {
   3.612385746164057*^9, 3.61238579297582*^9}, {3.61238583213284*^9, 
   3.612385875044321*^9}, {3.612386076098205*^9, 3.612386138330822*^9}, {
   3.61238621406568*^9, 3.6123864871546097`*^9}, {3.612386592834424*^9, 
   3.612386595345366*^9}, {3.61238669783259*^9, 3.612386719465087*^9}, {
   3.612386763049239*^9, 3.6123869754467688`*^9}, {3.612387081523037*^9, 
   3.612387086900037*^9}, {3.61238714210116*^9, 3.6123871635919657`*^9}, {
   3.612387218495696*^9, 3.612387272597714*^9}, {3.612388453163433*^9, 
   3.612388509729362*^9}, {3.612388689937704*^9, 3.612388823354988*^9}, {
   3.612388922035955*^9, 3.6123889423713512`*^9}, {3.612438584739971*^9, 
   3.612438586018125*^9}, {3.612459504380815*^9, 3.6124596080047913`*^9}, {
   3.612459642327042*^9, 3.6124596681867943`*^9}, {3.6124597174275*^9, 
   3.612459756932399*^9}, {3.612529932459811*^9, 3.612529940999262*^9}, {
   3.612530094866077*^9, 3.612530135823183*^9}, {3.6125301707999067`*^9, 
   3.612530192472035*^9}, {3.612530357725339*^9, 3.612530393366385*^9}, {
   3.6125423297007847`*^9, 3.612542395897833*^9}, {3.612542460850719*^9, 
   3.612542823834886*^9}, {3.6125428915754547`*^9, 3.612542954087964*^9}, 
   3.61254309873851*^9, {3.612543659237805*^9, 3.612543659932743*^9}, {
   3.61254374455721*^9, 3.612543745300645*^9}, {3.612545901906189*^9, 
   3.6125459412764597`*^9}, {3.612546166832563*^9, 3.612546171467997*^9}, 
   3.61264208909579*^9, 3.612646148971404*^9, {3.612708599574895*^9, 
   3.612708622753731*^9}, 3.612987534341853*^9, {3.6129877145340233`*^9, 
   3.612987718080566*^9}, {3.6132637653718777`*^9, 3.613263780994561*^9}, 
   3.613264226482449*^9, {3.613266745099494*^9, 3.613266963706663*^9}, {
   3.613267026181794*^9, 3.613267027422632*^9}, {3.613305053919121*^9, 
   3.613305115693572*^9}, {3.6133052552237787`*^9, 3.613305256898961*^9}, {
   3.613563600431302*^9, 3.613563601016981*^9}, 3.613583059747168*^9, {
   3.6135861791155243`*^9, 3.613586270864945*^9}, {3.613586353476955*^9, 
   3.613586384603867*^9}, {3.6135865368771477`*^9, 3.613586564694858*^9}, {
   3.613771643041127*^9, 3.613771677849854*^9}, {3.613842066498301*^9, 
   3.6138421149241667`*^9}, 3.613842156519615*^9, 3.613842243285387*^9, 
   3.6148825743409357`*^9, {3.615706381595963*^9, 3.6157063973895683`*^9}, {
   3.615766831046301*^9, 3.615766832068151*^9}, 3.6169357045061398`*^9, 
   3.616965541571431*^9, {3.6169668951879396`*^9, 3.616966960415564*^9}, {
   3.6169686958968678`*^9, 3.616969104429738*^9}, 3.61696929738767*^9, {
   3.616969435414283*^9, 3.6169694769956093`*^9}, {3.616969598002757*^9, 
   3.616969598493371*^9}, {3.616969690318234*^9, 3.616969854967506*^9}, {
   3.616969901844253*^9, 3.616970074094339*^9}, {3.616970145842664*^9, 
   3.616970163123555*^9}, 3.6171199773011227`*^9, 3.617120015619646*^9, 
   3.61745540923536*^9, {3.617986855263095*^9, 3.617986881384048*^9}, {
   3.618000615882044*^9, 3.618000654968944*^9}, {3.618000700196775*^9, 
   3.6180007780171757`*^9}, {3.618000982719067*^9, 3.618000984414953*^9}, {
   3.618533170396345*^9, 3.618533175793386*^9}, 3.6186955773993998`*^9, {
   3.618738015350525*^9, 3.618738033085267*^9}, {3.6189309871383123`*^9, 
   3.618931014323516*^9}, {3.618954367451046*^9, 3.618954370931837*^9}, {
   3.620725270314445*^9, 3.6207253522822237`*^9}, {3.6279225915429363`*^9, 
   3.6279225925021667`*^9}, {3.627922780200569*^9, 3.6279228063315983`*^9}, {
   3.6279228608718653`*^9, 3.6279229207763977`*^9}, {3.627922967435993*^9, 
   3.627923441321862*^9}, {3.6392501350969114`*^9, 3.6392501567721357`*^9}, {
   3.639250220855795*^9, 3.639250235993947*^9}, {3.639250846335835*^9, 
   3.6392509877782927`*^9}, {3.639251036494793*^9, 3.6392510457378855`*^9}, {
   3.639251107123518*^9, 3.639251142937881*^9}, {3.639251190503367*^9, 
   3.6392512466029387`*^9}, {3.639307622653927*^9, 3.6393076512032146`*^9}, {
   3.6393076845205517`*^9, 3.639307686913576*^9}, 3.639307745773177*^9, 
   3.6393078387751207`*^9, 3.6393078797825375`*^9, {3.6393080693754654`*^9, 
   3.6393080960077343`*^9}, {3.639308126512043*^9, 3.6393081395161753`*^9}, 
   3.639308181567607*^9, {3.6393089109092717`*^9, 3.6393089132592955`*^9}, {
   3.639309009727275*^9, 3.6393090580857716`*^9}, {3.639309092672125*^9, 
   3.639309124786455*^9}, {3.6393093538370094`*^9, 3.6393093538370094`*^9}, {
   3.6393093855033283`*^9, 3.639309480416291*^9}, {3.63931024900288*^9, 
   3.6393102490348835`*^9}, {3.6393102825370655`*^9, 3.6393103774395037`*^9}, 
   3.6393104445311346`*^9, {3.639310681634098*^9, 3.6393106816540985`*^9}, {
   3.6393121121198006`*^9, 3.6393121141678753`*^9}, {3.6393121738774004`*^9, 
   3.6393122357656374`*^9}, 3.63931239817651*^9, 3.6393125324660263`*^9, {
   3.639312587438315*^9, 3.6393126858520937`*^9}, {3.6393127322129555`*^9, 
   3.6393128194068136`*^9}, {3.63931288342709*^9, 3.639312982969671*^9}, {
   3.6393130362897124`*^9, 3.639313155578438*^9}, {3.639313205349704*^9, 
   3.639313209912765*^9}, {3.6393133844488926`*^9, 3.639313436612899*^9}, {
   3.639313531444481*^9, 3.6393135372656083`*^9}, {3.6393135938115983`*^9, 
   3.639313603396717*^9}, {3.6393136740854416`*^9, 3.6393137034758987`*^9}, {
   3.6393147611486826`*^9, 3.6393147682847548`*^9}, {3.641248277582052*^9, 
   3.6412483036485167`*^9}, {3.642793692888131*^9, 3.642793720160467*^9}, {
   3.642793795454947*^9, 3.642793795457553*^9}, {3.64279383830371*^9, 
   3.642793988373868*^9}, {3.6427943357122307`*^9, 3.642794335825313*^9}, 
   3.642794402945443*^9},
 FormatType->"InputForm"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"promotef", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{
     RowBox[{"unumQ", "[", "u", "]"}], " ", "&&", " ", 
     RowBox[{"exQ", "[", "u", "]"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"fsize", "[", "u", "]"}], " ", "<", " ", "fsizemax"}], ",", " ", 
    "\n", "   ", 
    RowBox[{
     RowBox[{"2", "*", 
      RowBox[{"BitAnd", "[", 
       RowBox[{
        RowBox[{"floatmask", "[", "u", "]"}], ",", " ", "u"}], "]"}]}], " ", 
     "+", " ", 
     RowBox[{"BitAnd", "[", 
      RowBox[{"utagmask", ",", " ", "u"}], "]"}], " ", "+", " ", "1"}], ",", 
    " ", "u"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"promotee", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{
     RowBox[{"unumQ", "[", "u", "]"}], " ", "&&", " ", 
     RowBox[{"exQ", "[", "u", "]"}]}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"e", " ", "=", " ", 
       RowBox[{"expo", "[", "u", "]"}]}], ",", " ", 
      RowBox[{"es", " ", "=", " ", 
       RowBox[{"esize", "[", "u", "]"}]}], ",", " ", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"frac", "[", "u", "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"fs", " ", "=", " ", 
       RowBox[{"fsize", "[", "u", "]"}]}], ",", " ", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{"BitAnd", "[", 
        RowBox[{
         RowBox[{"signmask", "[", "u", "]"}], ",", " ", "u"}], "]"}]}], ",", 
      " ", "\n", "    ", 
      RowBox[{"ut", " ", "=", " ", 
       RowBox[{
        RowBox[{"BitAnd", "[", 
         RowBox[{"utagmask", ",", " ", "u"}], "]"}], " ", "+", " ", 
        "fsizemax"}]}], ",", " ", "nsigbits"}], "}"}], ",", " ", "\n", "   ", 
    
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{"es", " ", "==", " ", "esizemax"}], ",", " ", "u", ",", " ", 
      RowBox[{
       RowBox[{"e", " ", "==", " ", "0"}], " ", "&&", " ", 
       RowBox[{"f", " ", "==", " ", "0"}]}], ",", " ", "ut", ",", " ", 
      RowBox[{"e", " ", ">", " ", "0"}], ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"2", "*", "s"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"e", " ", "+", " ", 
          RowBox[{"2", "^", 
           RowBox[{"(", 
            RowBox[{"es", " ", "-", " ", "1"}], ")"}]}]}], ")"}], "*", 
        RowBox[{"hiddenmask", "[", "u", "]"}]}], " ", "+", " ", "\n", "     ", 
       RowBox[{"BitAnd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"hiddenmask", "[", "u", "]"}], " ", "-", " ", "1"}], ",", 
         " ", "u"}], "]"}], " ", "+", " ", "fsizemax"}], ",", " ", "\n", 
      "    ", 
      RowBox[{
       RowBox[{"fs", " ", "-", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Floor", "[", 
           RowBox[{"Log", "[", 
            RowBox[{"2", ",", " ", "f"}], "]"}], "]"}], " ", "+", " ", "1"}], 
         ")"}]}], " ", ">=", " ", 
       RowBox[{"2", "^", 
        RowBox[{"(", 
         RowBox[{"es", " ", "-", " ", "1"}], ")"}]}]}], ",", " ", "\n", 
      "    ", 
      RowBox[{
       RowBox[{"2", "*", "s"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"frac", "[", "u", "]"}], "*", 
        RowBox[{"2", "^", 
         RowBox[{"2", "^", 
          RowBox[{"(", 
           RowBox[{"es", " ", "-", " ", "1"}], ")"}]}]}], "*", "ulpu"}], " ", 
       "+", " ", "ut"}], ",", " ", "True", ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"nsigbits", " ", "=", " ", 
        RowBox[{
         RowBox[{"Floor", "[", 
          RowBox[{"Log", "[", 
           RowBox[{"2", ",", " ", "f"}], "]"}], "]"}], " ", "+", " ", "1"}]}],
        ";", " ", "\n", "     ", 
       RowBox[{
        RowBox[{"2", "*", "s"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "^", 
            RowBox[{"(", 
             RowBox[{"es", " ", "-", " ", "1"}], ")"}]}], " ", "+", " ", "1", 
           " ", "-", " ", "fs", " ", "+", " ", "nsigbits"}], ")"}], "*", 
         RowBox[{"hiddenmask", "[", "u", "]"}]}], " ", "+", " ", "\n", 
        "      ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"f", " ", "-", " ", 
           RowBox[{"2", "^", "nsigbits"}]}], ")"}], "*", 
         RowBox[{"2", "^", 
          RowBox[{"(", 
           RowBox[{"fs", " ", "-", " ", "nsigbits", " ", "+", " ", "1"}], 
           ")"}]}], "*", "ulpu"}], " ", "+", " ", "\n", "      ", 
        RowBox[{"BitAnd", "[", 
         RowBox[{"utagmask", ",", " ", "u"}], "]"}], " ", "+", " ", 
        "fsizemax"}]}]}], "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"promote", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"u_", ",", " ", "v_"}], "}"}], " ", "/;", " ", 
    RowBox[{
     RowBox[{"unumQ", "[", "u", "]"}], " ", "&&", " ", 
     RowBox[{"unumQ", "[", "v", "]"}], " ", "&&", " ", 
     RowBox[{"exQ", "[", "u", "]"}], " ", "&&", " ", "\n", "     ", 
     RowBox[{"exQ", "[", "v", "]"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"eu", " ", "=", " ", 
       RowBox[{"esize", "[", "u", "]"}]}], ",", " ", 
      RowBox[{"ev", " ", "=", " ", 
       RowBox[{"esize", "[", "v", "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"fu", " ", "=", " ", 
       RowBox[{"fsize", "[", "u", "]"}]}], ",", " ", 
      RowBox[{"fv", " ", "=", " ", 
       RowBox[{"fsize", "[", "v", "]"}]}], ",", " ", 
      RowBox[{"ut", " ", "=", " ", "u"}], ",", " ", 
      RowBox[{"vt", " ", "=", " ", "v"}]}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"eu", " ", "<", " ", "ev"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ut", " ", "=", " ", 
          RowBox[{"promotee", "[", "ut", "]"}]}], ";", " ", 
         RowBox[{"eu", " ", "+=", " ", "1"}]}], "}"}]}], "]"}], ";", " ", 
     "\n", "    ", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"ev", " ", "<", " ", "eu"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vt", " ", "=", " ", 
          RowBox[{"promotee", "[", "vt", "]"}]}], ";", " ", 
         RowBox[{"ev", " ", "+=", " ", "1"}]}], "}"}]}], "]"}], ";", " ", 
     "\n", "    ", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"fu", " ", "<", " ", "fv"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ut", " ", "=", " ", 
          RowBox[{"promotef", "[", "ut", "]"}]}], ";", " ", 
         RowBox[{"fu", " ", "+=", " ", "1"}]}], "}"}]}], "]"}], ";", " ", 
     "\n", "    ", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"fv", " ", "<", " ", "fu"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vt", " ", "=", " ", 
          RowBox[{"promotef", "[", "vt", "]"}]}], ";", " ", 
         RowBox[{"fv", " ", "+=", " ", "1"}]}], "}"}]}], "]"}], ";", " ", 
     RowBox[{"{", 
      RowBox[{"ut", ",", " ", "vt"}], "}"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"demotef", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"fsize", "[", "u", "]"}], " ", "==", " ", "1"}], " ", "||", " ", 
     RowBox[{"u", " ", "==", " ", "posinfu"}], " ", "||", " ", "\n", "    ", 
     RowBox[{"u", " ", "==", " ", "neginfu"}], " ", "||", " ", 
     RowBox[{"u", " ", "==", " ", "qNaNu"}], " ", "||", " ", 
     RowBox[{"u", " ", "==", " ", "sNaNu"}]}], ",", " ", "u", ",", " ", "\n", 
    "   ", 
    RowBox[{"BitOr", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"BitAnd", "[", 
        RowBox[{"u", ",", " ", 
         RowBox[{"floatmask", "[", "u", "]"}]}], "]"}], "/", "2"}], ",", " ", 
      
      RowBox[{
       RowBox[{"BitAnd", "[", 
        RowBox[{"utagmask", ",", " ", "u"}], "]"}], " ", "-", " ", "1"}]}], 
     "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"demotee", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "u", "]"}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"es", " ", "=", " ", 
       RowBox[{"esize", "[", "u", "]"}]}], ",", " ", 
      RowBox[{"mask", " ", "=", " ", 
       RowBox[{
        RowBox[{"signmask", "[", "u", "]"}], "/", "4"}]}], ",", " ", "\n", 
      "    ", 
      RowBox[{"fm", " ", "=", " ", 
       RowBox[{"floatmask", "[", "u", "]"}]}], ",", " ", 
      RowBox[{"ut", " ", "=", " ", 
       RowBox[{"BitAnd", "[", 
        RowBox[{"u", ",", " ", "utagmask"}], "]"}]}], ",", " ", "left2", ",", 
      " ", "ibit", ",", " ", "\n", "    ", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{"BitAnd", "[", 
        RowBox[{
         RowBox[{"signmask", "[", "u", "]"}], ",", " ", "u"}], "]"}]}], ",", 
      " ", "e", ",", " ", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"frac", "[", "u", "]"}]}]}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{"left2", " ", "=", " ", 
      RowBox[{
       RowBox[{"BitAnd", "[", 
        RowBox[{"u", ",", " ", 
         RowBox[{"3", "*", "mask"}]}], "]"}], "/", "mask"}]}], ";", " ", "\n",
      "    ", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"es", " ", "==", " ", "1"}], " ", "||", " ", 
        RowBox[{"u", " ", "==", " ", "posinfu"}], " ", "||", " ", 
        RowBox[{"u", " ", "==", " ", "neginfu"}], " ", "||", " ", "\n", 
        "      ", 
        RowBox[{"u", " ", "==", " ", "qNaNu"}], " ", "||", " ", 
        RowBox[{"u", " ", "==", " ", "sNaNu"}]}], ",", " ", "u", ",", " ", 
       RowBox[{
        RowBox[{"expo", "[", "u", "]"}], " ", "==", " ", "0"}], ",", " ", 
       "\n", "     ", 
       RowBox[{
        RowBox[{"f", " ", "=", " ", 
         RowBox[{"f", "/", 
          RowBox[{"2", "^", 
           RowBox[{"2", "^", 
            RowBox[{"(", 
             RowBox[{"es", " ", "-", " ", "2"}], ")"}]}]}]}]}], ";", " ", 
        RowBox[{"ibit", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"FractionalPart", "[", "f", "]"}], " ", ">", " ", "0"}], 
           ",", " ", "\n", "        ", "ubitmask", ",", " ", "0"}], "]"}]}], 
        ";", " ", 
        RowBox[{"BitOr", "[", 
         RowBox[{"ibit", ",", " ", 
          RowBox[{
           RowBox[{"s", "/", "2"}], " ", "+", " ", 
           RowBox[{
            RowBox[{"IntegerPart", "[", "f", "]"}], "*", "ulpu"}], " ", "+", 
           " ", "\n", "        ", "ut", " ", "-", " ", "fsizemax"}]}], 
         "]"}]}], ",", " ", 
       RowBox[{"left2", " ", "==", " ", "0"}], ",", " ", "\n", "     ", 
       RowBox[{
        RowBox[{"f", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "^", 
             RowBox[{"fsize", "[", "u", "]"}]}], " ", "+", " ", "f"}], ")"}], 
          "/", 
          RowBox[{"2", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"expo", "[", "u", "]"}]}], " ", "+", " ", 
             RowBox[{"2", "^", 
              RowBox[{"(", 
               RowBox[{"es", " ", "-", " ", "2"}], ")"}]}], " ", "+", " ", 
             "1"}], ")"}]}]}]}], ";", " ", "\n", "      ", 
        RowBox[{"ibit", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"FractionalPart", "[", "f", "]"}], " ", ">", " ", "0"}], 
           ",", " ", "ubitmask", ",", " ", "0"}], "]"}]}], ";", " ", "\n", 
        "      ", 
        RowBox[{"BitOr", "[", 
         RowBox[{"ibit", ",", " ", 
          RowBox[{
           RowBox[{"s", "/", "2"}], " ", "+", " ", 
           RowBox[{
            RowBox[{"IntegerPart", "[", "f", "]"}], "*", "ulpu"}], " ", "+", 
           " ", "ut", " ", "-", " ", "fsizemax"}]}], "]"}]}], ",", " ", "\n", 
       "     ", 
       RowBox[{"left2", " ", "<=", " ", "2"}], ",", " ", 
       RowBox[{
        RowBox[{"e", " ", "=", " ", 
         RowBox[{
          RowBox[{"BitAnd", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"expomask", "[", "u", "]"}], " ", "-", " ", 
             RowBox[{"3", "*", "mask"}]}], ",", " ", "u"}], "]"}], " ", "+", 
          " ", "\n", "        ", 
          RowBox[{
           RowBox[{"BitAnd", "[", 
            RowBox[{"u", ",", " ", 
             RowBox[{"2", "*", "mask"}]}], "]"}], "/", "2"}]}]}], ";", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"e", " ", "==", " ", "0"}], ",", " ", "\n", "       ", 
          RowBox[{"f", " ", "=", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "^", 
               RowBox[{"fsize", "[", "u", "]"}]}], " ", "+", " ", "f"}], 
             ")"}], "/", "2"}]}]}], "]"}], ";", " ", "\n", "      ", 
        RowBox[{"ibit", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"FractionalPart", "[", "f", "]"}], " ", ">", " ", "0"}], 
           ",", " ", "ubitmask", ",", " ", "0"}], "]"}]}], ";", " ", "\n", 
        "      ", 
        RowBox[{"BitOr", "[", 
         RowBox[{"ibit", ",", " ", 
          RowBox[{
           RowBox[{"s", "/", "2"}], " ", "+", " ", "e", " ", "+", " ", 
           RowBox[{
            RowBox[{"IntegerPart", "[", "f", "]"}], "*", "ulpu"}], " ", "+", 
           " ", "ut", " ", "-", " ", "\n", "        ", "fsizemax"}]}], 
         "]"}]}], ",", " ", "True", ",", " ", "\n", "     ", 
       RowBox[{
        RowBox[{"BitOr", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"BitAnd", "[", 
              RowBox[{"u", ",", " ", 
               RowBox[{"signmask", "[", "u", "]"}]}], "]"}], " ", "+", " ", 
             RowBox[{"(", 
              RowBox[{"fm", " ", "-", " ", 
               RowBox[{"signmask", "[", "u", "]"}]}], ")"}]}], ")"}], "/", 
           "2"}], ",", " ", "\n", "       ", "ut"}], "]"}], " ", "-", " ", 
        "fsizemax"}]}], "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ulphi", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{
     RowBox[{"unumQ", "[", "u", "]"}], " ", "&&", " ", 
     RowBox[{"exQ", "[", "u", "]"}]}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s", " ", "=", " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ltuQ", "[", 
         RowBox[{
          RowBox[{"{", "u", "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"x2u", "[", "0", "]"}], "}"}]}], "]"}], ",", " ", 
        RowBox[{"-", "1"}], ",", " ", "1"}], "]"}]}], "}"}], ",", " ", "\n", 
    "   ", 
    RowBox[{
     RowBox[{
      RowBox[{"u2g", "[", 
       RowBox[{"u", " ", "+", " ", 
        RowBox[{"s", "*", "ubitmask"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "-", " ", 
     RowBox[{
      RowBox[{"u2g", "[", 
       RowBox[{"u", " ", "+", " ", 
        RowBox[{"s", "*", "ubitmask"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"favore", "[", 
   RowBox[{"unum_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "unum", "]"}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"u", " ", "=", " ", 
      RowBox[{"demotef", "[", 
       RowBox[{"promotee", "[", "unum", "]"}], "]"}]}], "}"}], ",", " ", "\n",
     "   ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"inexQ", "[", "u", "]"}], " ", "||", " ", 
       RowBox[{
        RowBox[{"esize", "[", "u", "]"}], " ", "==", " ", "esizemax"}], " ", "||",
        " ", 
       RowBox[{
        RowBox[{"fsize", "[", "u", "]"}], " ", "==", " ", "1"}], " ", "||", 
       " ", "\n", "     ", 
       RowBox[{"inexQ", "[", "u", "]"}]}], ",", " ", "u", ",", " ", 
      RowBox[{
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"fsize", "[", "u", "]"}], " ", ">", " ", "1"}], " ", "&&", 
          " ", 
          RowBox[{"exQ", "[", 
           RowBox[{"demotef", "[", "u", "]"}], "]"}]}], ",", " ", "\n", 
         "      ", 
         RowBox[{"u", " ", "=", " ", 
          RowBox[{"demotef", "[", "u", "]"}]}]}], "]"}], ";", " ", "u"}]}], 
     "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"favorf", "[", 
   RowBox[{"unum_", " ", "/;", " ", 
    RowBox[{"unumQ", "[", "unum", "]"}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"u", " ", "=", " ", 
      RowBox[{"demotee", "[", 
       RowBox[{"padu", "[", "unum", "]"}], "]"}]}], "}"}], ",", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"inexQ", "[", "u", "]"}], ",", " ", "u", ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"fsize", "[", "u", "]"}], " ", ">", " ", "1"}], " ", "&&", 
          " ", 
          RowBox[{"exQ", "[", 
           RowBox[{"demotef", "[", "u", "]"}], "]"}]}], ",", " ", 
         RowBox[{"u", " ", "=", " ", 
          RowBox[{"demotef", "[", "u", "]"}]}]}], "]"}], ";", " ", "u"}]}], 
     "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"nborhi", "[", 
   RowBox[{
    RowBox[{"u_", " ", "/;", " ", 
     RowBox[{"unumQ", "[", "u", "]"}]}], ",", " ", "minpower_"}], "]"}], " ", 
  ":=", " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "up", ",", " ", "vp", ",", " ", "s", ",", " ", "t", ",", " ", "ulpminu", 
      ",", " ", "ulpmin", ",", " ", 
      RowBox[{"overflow", " ", "=", " ", "False"}], ",", " ", "\n", "    ", 
      RowBox[{"ut", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"u", " ", "==", " ", 
           RowBox[{"BitAnd", "[", 
            RowBox[{
             RowBox[{"utagmask", " ", "+", " ", 
              RowBox[{"signmask", "[", "u", "]"}]}], ",", " ", "u"}], "]"}]}],
           " ", "&&", " ", 
          RowBox[{"exQ", "[", "u", "]"}]}], ",", " ", "\n", "      ", 
         RowBox[{"x2u", "[", "0", "]"}], ",", " ", "u"}], "]"}]}]}], "}"}], 
    ",", " ", 
    RowBox[{
     RowBox[{"s", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", 
       RowBox[{"sign", "[", "ut", "]"}]}]}], ";", " ", "\n", "    ", 
     RowBox[{"ulpminu", " ", "=", " ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"minpower", " ", "<", " ", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", " ", "smallsubnormal"}], "]"}]}], ",", " ", "\n", 
        "      ", "smallsubnormalu", ",", " ", 
        RowBox[{"minpower", " ", ">", " ", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", " ", "maxreal"}], "]"}]}], ",", " ", "\n", 
        "      ", 
        RowBox[{
         RowBox[{"overflow", " ", "=", " ", "True"}], ";", " ", 
         RowBox[{"x2u", "[", 
          RowBox[{"2", "^", 
           RowBox[{"Floor", "[", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", " ", "maxreal"}], "]"}], "]"}]}], "]"}]}], ",",
         " ", "True", ",", " ", "\n", "      ", 
        RowBox[{"x2u", "[", 
         RowBox[{"2", "^", "minpower"}], "]"}]}], "]"}]}], ";", " ", 
     RowBox[{"ulpmin", " ", "=", " ", 
      RowBox[{
       RowBox[{"u2g", "[", "ulpminu", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", " ", "\n", "    ", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"u", " ", "==", " ", "posinfu"}], " ", "||", " ", 
        RowBox[{"u", " ", "==", " ", "sNaNu"}], " ", "||", " ", 
        RowBox[{"u", " ", "==", " ", "qNaNu"}]}], ",", " ", "qNaNu", ",", " ",
        "\n", "     ", 
       RowBox[{"u", " ", "==", " ", "neginfu"}], ",", " ", 
       RowBox[{"If", "[", 
        RowBox[{"overflow", ",", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"utagmask", " ", "==", " ", "1"}], ",", " ", "\n", 
           "       ", 
           RowBox[{
            RowBox[{"x2u", "[", 
             RowBox[{"-", "2"}], "]"}], " ", "+", " ", "ubitmask"}], ",", " ", 
           RowBox[{
            RowBox[{"x2u", "[", 
             RowBox[{"-", "3"}], "]"}], " ", "+", " ", "ubitmask"}]}], "]"}], 
         ",", " ", "\n", "      ", 
         RowBox[{"negbigu", " ", "+", " ", "ubitmask"}]}], "]"}], ",", " ", 
       RowBox[{"inexQ", "[", "u", "]"}], ",", " ", 
       RowBox[{"x2u", "[", 
        RowBox[{
         RowBox[{"u2g", "[", "u", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}], ",", " ", "\n", 
       "     ", 
       RowBox[{"overflow", " ", "&&", " ", 
        RowBox[{"u", " ", "==", " ", 
         RowBox[{"x2u", "[", "2", "]"}]}], " ", "&&", " ", 
        RowBox[{"utagmask", " ", "==", " ", "1"}]}], ",", " ", "\n", "     ", 
       
       RowBox[{
        RowBox[{"x2u", "[", "2", "]"}], " ", "+", " ", "ubitmask"}], ",", " ", 
       RowBox[{"overflow", " ", "&&", " ", 
        RowBox[{"u", " ", "==", " ", 
         RowBox[{"x2u", "[", "3", "]"}]}], " ", "&&", " ", "\n", "      ", 
        RowBox[{"utagmask", " ", "!=", " ", "1"}]}], ",", " ", 
       RowBox[{
        RowBox[{"x2u", "[", "3", "]"}], " ", "+", " ", "ubitmask"}], ",", " ",
        "True", ",", " ", "\n", "     ", 
       RowBox[{
        RowBox[{"t", " ", "=", " ", 
         RowBox[{
          RowBox[{"u2g", "[", "ut", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", " ", 
        RowBox[{"ut", " ", "=", " ", 
         RowBox[{"x2u", "[", "t", "]"}]}], ";", " ", "\n", "      ", 
        RowBox[{"While", "[", " ", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"IntegerQ", "[", 
            RowBox[{"t", "/", "ulpmin"}], "]"}]}], ",", " ", 
          RowBox[{"ulpmin", " ", "/=", " ", "2"}]}], "]"}], ";", " ", "\n", 
        "      ", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ulphi", "[", "ut", "]"}], " ", "<", " ", "ulpmin"}], " ",
            "&&", " ", 
           RowBox[{"ut", " ", "!=", " ", 
            RowBox[{"favorf", "[", "ut", "]"}]}]}], ",", " ", "\n", "       ", 
          RowBox[{"ut", " ", "=", " ", 
           RowBox[{"favorf", "[", "ut", "]"}]}]}], "]"}], ";", " ", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"esize", "[", "ut", "]"}], " ", "<", " ", "esizemax"}], 
           " ", "&&", " ", "\n", "        ", 
           RowBox[{
            RowBox[{"ulphi", "[", 
             RowBox[{"promotee", "[", "ut", "]"}], "]"}], " ", ">=", " ", 
            "ulpmin"}]}], ",", " ", 
          RowBox[{"ut", " ", "=", " ", 
           RowBox[{"promotee", "[", "ut", "]"}]}]}], "]"}], ";", " ", "\n", 
        "      ", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"fsize", "[", "ut", "]"}], " ", "<", " ", "fsizemax"}], 
           " ", "&&", " ", 
           RowBox[{
            RowBox[{"ulphi", "[", 
             RowBox[{"promotef", "[", "ut", "]"}], "]"}], " ", ">=", " ", 
            "\n", "         ", "ulpmin"}]}], ",", " ", 
          RowBox[{"ut", " ", "=", " ", 
           RowBox[{"promotef", "[", "ut", "]"}]}]}], "]"}], ";", " ", 
        RowBox[{"ut", " ", "+", " ", 
         RowBox[{"s", "*", "ubitmask"}]}]}]}], "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"nborlo", "[", 
   RowBox[{
    RowBox[{"u_", " ", "/;", " ", 
     RowBox[{"unumQ", "[", "u", "]"}]}], ",", " ", "minpower_"}], "]"}], " ", 
  ":=", " ", "\n", "  ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"sameuQ", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x2u", "[", "u", "]"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"x2u", "[", "0", "]"}], "}"}]}], "]"}], " ", "&&", " ", "\n", 
     "    ", 
     RowBox[{"minpower", " ", "<", " ", 
      RowBox[{"Log", "[", 
       RowBox[{"2", ",", " ", "smallsubnormal"}], "]"}]}]}], ",", " ", 
    RowBox[{
    "smallsubnormalu", " ", "+", " ", "\n", "    ", "signbigu", " ", "-", " ",
      "ubitmask"}], ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{"negateu", "[", 
      RowBox[{"{", 
       RowBox[{"nborhi", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"negateu", "[", 
           RowBox[{"{", "u", "}"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "minpower"}], "]"}], 
       "}"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"uboxlist", "[", 
   RowBox[{
    RowBox[{"ub_", " ", "/;", " ", 
     RowBox[{"uboundQ", "[", "ub", "]"}]}], ",", " ", "minpower_Integer"}], 
   "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"utest", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ub", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "===", " ", "neginfu"}], ",", 
         " ", "neginfu", ",", " ", "\n", "      ", 
         RowBox[{"nborhi", "[", 
          RowBox[{
           RowBox[{"nborlo", "[", 
            RowBox[{
             RowBox[{"ub", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", " ", "minpower"}], "]"}], 
           ",", " ", "minpower"}], "]"}]}], "]"}]}], ",", " ", 
      RowBox[{"list1", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ",", " ", "\n", "    ", 
      RowBox[{"list2", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ",", " ", "infinitybits", ",", " ", "nbortemp"}],
      "}"}], ",", " ", "\n", "   ", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ub", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "===", " ", "qNaNu"}], " ", "||",
        " ", 
       RowBox[{
        RowBox[{"ub", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], " ", "===", " ", "qNaNu"}], " ", "||",
        " ", "\n", "     ", 
       RowBox[{
        RowBox[{"ub", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "===", " ", "sNaNu"}], " ", "||",
        " ", 
       RowBox[{
        RowBox[{"ub", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], " ", "===", " ", "sNaNu"}]}], ",",
       " ", 
      RowBox[{"{", "qNaNu", "}"}], ",", " ", "\n", "    ", 
      RowBox[{"sameuQ", "[", 
       RowBox[{"ub", ",", " ", 
        RowBox[{"{", "neginfu", "}"}]}], "]"}], ",", " ", 
      RowBox[{"{", "neginfu", "}"}], ",", " ", 
      RowBox[{"sameuQ", "[", 
       RowBox[{"ub", ",", " ", 
        RowBox[{"{", "posinfu", "}"}]}], "]"}], ",", " ", "\n", "    ", 
      RowBox[{"{", "posinfu", "}"}], ",", " ", "True", ",", " ", 
      RowBox[{
       RowBox[{"infinitybits", " ", "=", " ", 
        RowBox[{"ubitmask", " ", "+", " ", "\n", "       ", 
         RowBox[{"expomask", "[", "utest", "]"}], " ", "+", " ", 
         RowBox[{"fracmask", "[", "utest", "]"}]}]}], ";", " ", "\n", "     ", 
       RowBox[{"nbortemp", " ", "=", " ", 
        RowBox[{"nborhi", "[", 
         RowBox[{"utest", ",", " ", "minpower"}], "]"}]}], ";", " ", "\n", 
       "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"BitAnd", "[", 
            RowBox[{"infinitybits", ",", " ", "utest"}], "]"}], " ", "==", 
           " ", "infinitybits"}], " ", "&&", " ", "\n", "       ", 
          RowBox[{
           RowBox[{"esize", "[", "utest", "]"}], " ", "<", " ", "esizemax"}], 
          " ", "&&", " ", 
          RowBox[{"nequQ", "[", 
           RowBox[{
            RowBox[{"intersectu", "[", 
             RowBox[{"ub", ",", " ", "\n", "         ", 
              RowBox[{"{", "nbortemp", "}"}]}], "]"}], ",", " ", 
            RowBox[{"{", "nbortemp", "}"}]}], "]"}]}], ",", " ", "\n", 
         "      ", 
         RowBox[{"utest", " ", "=", " ", 
          RowBox[{
           RowBox[{"promotee", "[", 
            RowBox[{"exact", "[", "utest", "]"}], "]"}], " ", "+", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"inexQ", "[", "utest", "]"}], ",", " ", "\n", 
             "         ", "ubitmask", ",", " ", "0"}], "]"}]}]}]}], "]"}], 
       ";", " ", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"sameuQ", "[", 
           RowBox[{
            RowBox[{"intersectu", "[", 
             RowBox[{"ub", ",", " ", 
              RowBox[{"{", "utest", "}"}]}], "]"}], ",", " ", "\n", 
            "        ", 
            RowBox[{"{", "utest", "}"}]}], "]"}], " ", "&&", " ", 
          RowBox[{"utest", " ", "=!=", " ", "posinfu"}]}], ",", " ", "\n", 
         "      ", 
         RowBox[{
          RowBox[{"list1", " ", "=", " ", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"list1", ",", " ", "utest"}], "]"}]}], ";", " ", "\n", 
          "       ", 
          RowBox[{"utest", " ", "=", " ", 
           RowBox[{"nborhi", "[", 
            RowBox[{"utest", ",", " ", "minpower"}], "]"}]}], ";", " ", "\n", 
          "       ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"BitAnd", "[", 
               RowBox[{"infinitybits", ",", " ", "utest"}], "]"}], " ", "==", 
              " ", "infinitybits"}], " ", "&&", " ", "\n", "         ", 
             RowBox[{
              RowBox[{"esize", "[", "utest", "]"}], " ", "<", " ", 
              "esizemax"}], " ", "&&", " ", 
             RowBox[{"nequQ", "[", 
              RowBox[{
               RowBox[{"intersectu", "[", 
                RowBox[{"ub", ",", " ", "\n", "           ", 
                 RowBox[{"{", "utest", "}"}]}], "]"}], ",", " ", 
               RowBox[{"{", "utest", "}"}]}], "]"}]}], ",", " ", 
            RowBox[{"utest", " ", "=", " ", 
             RowBox[{
              RowBox[{"promotee", "[", 
               RowBox[{"exact", "[", "utest", "]"}], "]"}], " ", "+", " ", 
              "\n", "          ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"inexQ", "[", "utest", "]"}], ",", " ", "ubitmask", 
                ",", " ", "0"}], "]"}]}]}]}], "]"}]}]}], "]"}], ";", " ", 
       "\n", "     ", 
       RowBox[{"utest", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ub", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], " ", "===", " ", "posinfu"}], 
          ",", " ", "posinfu", ",", " ", "\n", "       ", 
          RowBox[{"nborlo", "[", 
           RowBox[{
            RowBox[{"nborhi", "[", 
             RowBox[{
              RowBox[{"ub", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], ",", " ", "minpower"}], 
             "]"}], ",", " ", "minpower"}], "]"}]}], "]"}]}], ";", " ", "\n", 
       "     ", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"gtuQ", "[", 
           RowBox[{
            RowBox[{"{", "utest", "}"}], ",", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "list1", "]"}], " ", "==", " ", "0"}], 
              ",", " ", "\n", "         ", 
              RowBox[{"{", 
               RowBox[{"x2u", "[", 
                RowBox[{
                 RowBox[{"u2g", "[", "ub", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "}"}], ",", 
              " ", 
              RowBox[{"{", 
               RowBox[{"list1", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}], "}"}]}], "]"}]}], "]"}], 
          " ", "&&", " ", "\n", "       ", 
          RowBox[{"utest", " ", "!=", " ", "neginfu"}]}], ",", " ", 
         RowBox[{
          RowBox[{"PrependTo", "[", 
           RowBox[{"list2", ",", " ", "utest"}], "]"}], ";", " ", "\n", 
          "       ", 
          RowBox[{"utest", " ", "=", " ", 
           RowBox[{"nborlo", "[", 
            RowBox[{"utest", ",", " ", "minpower"}], "]"}]}]}]}], "]"}], ";", 
       " ", 
       RowBox[{"Join", "[", 
        RowBox[{"list1", ",", " ", "list2"}], "]"}]}]}], "]"}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"uboxlistinexact", "[", 
   RowBox[{
    RowBox[{"ub_", " ", "/;", " ", 
     RowBox[{"uboundQ", "[", "ub", "]"}]}], ",", " ", "minpower_Integer"}], 
   "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"set", " ", "=", " ", 
       RowBox[{"uboxlist", "[", 
        RowBox[{"ub", ",", " ", "minpower"}], "]"}]}], ",", " ", 
      RowBox[{"temp", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ",", " ", "i"}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"i", " ", "<=", " ", 
        RowBox[{"Length", "[", "set", "]"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"inexQ", "[", 
          RowBox[{"set", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", " ", "\n", "      ", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"temp", ",", " ", 
           RowBox[{"set", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}], "]"}], ";", 
     " ", "temp"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ubox2D", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xu_", ",", " ", "yu_"}], "}"}], ",", " ", "r_"}], "]"}], " ", ":=",
   " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"xlo", " ", "=", " ", 
       RowBox[{
        RowBox[{"u2g", "[", "xu", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"xhi", " ", "=", " ", 
       RowBox[{
        RowBox[{"u2g", "[", "xu", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", " ", 
      RowBox[{"ylo", " ", "=", " ", 
       RowBox[{
        RowBox[{"u2g", "[", "yu", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"yhi", " ", "=", " ", 
       RowBox[{
        RowBox[{"u2g", "[", "yu", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", " ", "\n", 
    "   ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"EdgeForm", "[", 
       RowBox[{"{", 
        RowBox[{"White", ",", " ", 
         RowBox[{"Thickness", "[", "0.0008", "]"}]}], "}"}], "]"}], ",", " ", 
      "\n", "    ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"inexQ", "[", "xu", "]"}], " ", "&&", " ", 
         RowBox[{"inexQ", "[", "yu", "]"}]}], ",", " ", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xlo", " ", "+", " ", "r"}], ",", " ", 
            RowBox[{"ylo", " ", "+", " ", "r"}]}], "}"}], ",", " ", "\n", 
          "      ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xhi", " ", "-", " ", "r"}], ",", " ", 
            RowBox[{"yhi", " ", "-", " ", "r"}]}], "}"}], ",", " ", 
          RowBox[{"RoundingRadius", " ", "->", " ", "r"}]}], "]"}], ",", " ", 
        "\n", "     ", 
        RowBox[{
         RowBox[{"exQ", "[", "xu", "]"}], " ", "&&", " ", 
         RowBox[{"inexQ", "[", "yu", "]"}]}], ",", " ", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xlo", " ", "-", " ", "r"}], ",", " ", 
            RowBox[{"ylo", " ", "+", " ", "r"}]}], "}"}], ",", " ", "\n", 
          "      ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xlo", " ", "+", " ", "r"}], ",", " ", 
            RowBox[{"yhi", " ", "-", " ", "r"}]}], "}"}], ",", " ", 
          RowBox[{"RoundingRadius", " ", "->", " ", "r"}]}], "]"}], ",", " ", 
        "\n", "     ", 
        RowBox[{
         RowBox[{"inexQ", "[", "xu", "]"}], " ", "&&", " ", 
         RowBox[{"exQ", "[", "yu", "]"}]}], ",", " ", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xlo", " ", "+", " ", "r"}], ",", " ", 
            RowBox[{"ylo", " ", "-", " ", "r"}]}], "}"}], ",", " ", "\n", 
          "      ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xhi", " ", "-", " ", "r"}], ",", " ", 
            RowBox[{"ylo", " ", "+", " ", "r"}]}], "}"}], ",", " ", 
          RowBox[{"RoundingRadius", " ", "->", " ", "r"}]}], "]"}], ",", " ", 
        "True", ",", " ", "\n", "     ", 
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"xlo", ",", " ", "ylo"}], "}"}], ",", " ", "r"}], "]"}]}], 
       "]"}]}], "}"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"splitub", "[", 
   RowBox[{"ub_", " ", "/;", " ", 
    RowBox[{"uboundQ", "[", "ub", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "b1", ",", " ", "b2", ",", " ", "g1", ",", " ", "g2", ",", " ", "gm"}], 
     "}"}], ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"g1", ",", " ", "g2"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"b1", ",", " ", "b2"}], "}"}]}], "}"}], " ", "=", " ", 
      RowBox[{"u2g", "[", "ub", "]"}]}], ";", " ", "\n", "    ", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"g1", ",", " ", "g2"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"b1", ",", " ", "b2"}], "}"}]}], "}"}], " ", "===", " ", 
        "\n", "      ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Indeterminate", ",", " ", "Indeterminate"}], "}"}], ",", 
          " ", 
          RowBox[{"{", 
           RowBox[{"True", ",", " ", "True"}], "}"}]}], "}"}]}], ",", " ", 
       RowBox[{"{", "ub", "}"}], ",", " ", "\n", "      ", 
       RowBox[{
        RowBox[{"!", "b1"}], " ", "&&", "  ", 
        RowBox[{"!", "b2"}]}], ",", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"g1", " ", "==", " ", "g2"}], ",", " ", 
         RowBox[{"{", "ub", "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ub", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", " ", "\n", "       ", 
           RowBox[{"g2u", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"g1", ",", " ", "g2"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], "]"}], ",",
            " ", 
           RowBox[{"{", 
            RowBox[{"ub", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], "}"}]}], "}"}]}], "]"}], ",", 
       " ", 
       RowBox[{"b1", " ", "&&", "  ", 
        RowBox[{"!", "b2"}]}], ",", " ", "\n", "     ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"g2u", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"g1", ",", " ", "g2"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], "]"}], ",", 
         " ", 
         RowBox[{"{", 
          RowBox[{"ub", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "}"}]}], "}"}], ",", "  ", 
       RowBox[{
        RowBox[{"!", "b1"}], " ", "&&", " ", "b2"}], ",", " ", "\n", "     ", 
       
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ub", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", " ", 
         RowBox[{"g2u", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"g1", ",", " ", "g2"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], "]"}]}], 
        "}"}], ",", " ", "\n", "     ", 
       RowBox[{"g1", " ", "==", " ", 
        RowBox[{"-", "Infinity"}]}], ",", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"g2", " ", "==", " ", 
          RowBox[{"-", "maxreal"}]}], ",", " ", 
         RowBox[{"{", "ub", "}"}], ",", " ", "\n", "      ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"negbigu", " ", "+", " ", "ubitmask"}], "}"}], ",", " ", 
           RowBox[{"{", "negbigu", "}"}], ",", " ", "\n", "       ", 
           RowBox[{"g2u", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "maxreal"}], ",", " ", "g2"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], "]"}]}], 
          "}"}]}], "]"}], ",", " ", 
       RowBox[{"g2", " ", "==", " ", "Infinity"}], ",", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"g1", " ", "==", " ", "maxreal"}], ",", " ", 
         RowBox[{"{", "ub", "}"}], ",", " ", "\n", "      ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"g2u", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"g1", ",", " ", "maxreal"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], "]"}], ",",
            " ", 
           RowBox[{"{", "maxrealu", "}"}], ",", " ", "\n", "       ", 
           RowBox[{"{", 
            RowBox[{"maxrealu", " ", "+", " ", "ubitmask"}], "}"}]}], "}"}]}],
         "]"}], ",", " ", 
       RowBox[{
        RowBox[{"gm", " ", "=", " ", 
         RowBox[{"u2g", "[", 
          RowBox[{"x2u", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"g1", " ", "+", " ", "g2"}], ")"}], "/", "2"}], "]"}], 
          "]"}]}], ";", " ", "\n", "      ", 
        RowBox[{
         RowBox[{"gm", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", ">", " ", "g1"}]}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"g2u", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"g1", ",", " ", 
              RowBox[{"gm", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], "]"}], ",", 
         " ", "\n", "      ", 
         RowBox[{"{", 
          RowBox[{"x2u", "[", 
           RowBox[{"gm", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "}"}], ",", " ", 
         RowBox[{"g2u", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"gm", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", "g2"}], 
             "}"}], ",", " ", "\n", "        ", 
            RowBox[{"{", 
             RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], "]"}]}], 
        "}"}], ",", " ", 
       RowBox[{
        RowBox[{"gm", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "<", " ", "g2"}], ",", 
       " ", "\n", "     ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"g2u", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"g1", ",", " ", 
              RowBox[{"gm", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], "]"}], ",", 
         " ", "\n", "      ", 
         RowBox[{"{", 
          RowBox[{"x2u", "[", 
           RowBox[{"gm", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}], "}"}], ",", " ", 
         RowBox[{"g2u", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"gm", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", " ", "g2"}], 
             "}"}], ",", " ", "\n", "        ", 
            RowBox[{"{", 
             RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], "]"}]}], 
        "}"}], ",", " ", "True", ",", " ", 
       RowBox[{"{", "ub", "}"}]}], "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ubox3DtoCuboid", "[", "ub_", "]"}], " ", ":=", " ", 
  RowBox[{"Cuboid", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"u2g", "[", 
        RowBox[{"ub", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"u2g", "[", 
        RowBox[{"ub", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
      RowBox[{
       RowBox[{"u2g", "[", 
        RowBox[{"ub", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"u2g", "[", 
        RowBox[{"ub", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", " ", 
      RowBox[{
       RowBox[{"u2g", "[", 
        RowBox[{"ub", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"u2g", "[", 
        RowBox[{"ub", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ubound3DtoCuboid", "[", "ub_", "]"}], " ", ":=", " ", 
  RowBox[{"Cuboid", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"u2g", "[", 
        RowBox[{"ub", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"u2g", "[", 
        RowBox[{"ub", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
      RowBox[{
       RowBox[{"u2g", "[", 
        RowBox[{"ub", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"u2g", "[", 
        RowBox[{"ub", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", " ", 
      RowBox[{
       RowBox[{"u2g", "[", 
        RowBox[{"ub", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"u2g", "[", 
        RowBox[{"ub", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"gel2D", "[", 
   RowBox[{
   "xlo_", ",", " ", "xhi_", ",", " ", "ylo_", ",", " ", "yhi_", ",", " ", 
    "r_", ",", " ", "color_", ",", " ", "dropshadow_"}], "]"}], " ", ":=", 
  " ", "\n", "  ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ylo", " ", "=!=", " ", "NaN"}], " ", "&&", " ", 
     RowBox[{"yhi", " ", "=!=", " ", "NaN"}]}], ",", " ", "\n", "   ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x1", " ", "=", " ", 
         RowBox[{"xlo", " ", "+", " ", 
          RowBox[{"2", "*", "r", "*", 
           RowBox[{"Boole", "[", 
            RowBox[{"xlo", " ", "<", " ", 
             RowBox[{"xhi", " ", "-", " ", 
              RowBox[{"4", "*", "r"}]}]}], "]"}]}]}]}], ",", " ", "\n", 
        "     ", 
        RowBox[{"x2", " ", "=", " ", 
         RowBox[{"xhi", " ", "-", " ", 
          RowBox[{"2", "*", "r", "*", 
           RowBox[{"Boole", "[", 
            RowBox[{"xlo", " ", "<", " ", 
             RowBox[{"xhi", " ", "-", " ", 
              RowBox[{"4", "*", "r"}]}]}], "]"}]}]}]}], ",", " ", "\n", 
        "     ", 
        RowBox[{"y1", " ", "=", " ", 
         RowBox[{"ylo", " ", "+", " ", 
          RowBox[{"2", "*", "r", "*", 
           RowBox[{"Boole", "[", 
            RowBox[{"ylo", " ", "<", " ", 
             RowBox[{"yhi", " ", "-", " ", 
              RowBox[{"4", "*", "r"}]}]}], "]"}]}]}]}], ",", " ", "\n", 
        "     ", 
        RowBox[{"y2", " ", "=", " ", 
         RowBox[{"yhi", " ", "-", " ", 
          RowBox[{"2", "*", "r", "*", 
           RowBox[{"Boole", "[", 
            RowBox[{"ylo", " ", "<", " ", 
             RowBox[{"yhi", " ", "-", " ", 
              RowBox[{"4", "*", "r"}]}]}], "]"}]}]}]}]}], "}"}], ",", " ", 
      "\n", "    ", 
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{"dropshadow", ",", " ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Blend", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"White", ",", " ", "Gray"}], "}"}], ",", " ", "\n",
                   "          ", 
                  RowBox[{"1.3", "*", "t"}]}], "]"}], ",", " ", 
                RowBox[{"Rectangle", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"x1", " ", "-", " ", "r", " ", "+", " ", 
                    RowBox[{"r", "*", "t"}]}], ",", " ", 
                    RowBox[{"y1", " ", "+", " ", 
                    RowBox[{"r", "*", "t"}], " ", "-", " ", "r", " ", "-", 
                    " ", "\n", "            ", 
                    RowBox[{"0.5", "*", "r"}]}]}], "}"}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"x2", " ", "+", " ", "r", " ", "-", " ", 
                    RowBox[{"r", "*", "t"}]}], ",", " ", 
                    RowBox[{"y2", " ", "+", " ", "r", " ", "-", " ", 
                    RowBox[{"r", "*", "t"}], " ", "-", " ", 
                    RowBox[{"0.5", "*", "r"}]}]}], "}"}], ",", " ", "\n", 
                  "          ", 
                  RowBox[{"RoundingRadius", " ", "->", " ", 
                   RowBox[{"r", " ", "-", " ", 
                    RowBox[{"r", "*", "t"}]}]}]}], "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{
               "t", ",", " ", "0", ",", " ", "0.5", ",", " ", "0.03125"}], 
               "}"}]}], "]"}]}], "]"}], ",", " ", "\n", "      ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Blend", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"color", ",", " ", 
                  RowBox[{"Blend", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"color", ",", " ", "White"}], "}"}], ",", " ", 
                    "0.5"}], "]"}]}], "}"}], ",", " ", "t"}], "]"}], ",", " ",
               "\n", "        ", 
              RowBox[{"Rectangle", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"x1", " ", "-", " ", "r", " ", "+", " ", 
                   RowBox[{"r", "*", "t"}]}], ",", " ", 
                  RowBox[{"y1", " ", "-", " ", "r", " ", "+", " ", 
                   RowBox[{"0.2", "*", "r", "*", "t"}]}]}], "}"}], ",", " ", 
                "\n", "         ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"x2", " ", "+", " ", "r", " ", "-", " ", 
                   RowBox[{"r", "*", "t"}]}], ",", " ", 
                  RowBox[{"y2", " ", "+", " ", "r", " ", "-", " ", 
                   RowBox[{"1.8", "*", "r", "*", "t"}]}]}], "}"}], ",", " ", 
                RowBox[{
                "RoundingRadius", " ", "->", " ", "\n", "          ", 
                 RowBox[{"r", "*", 
                  RowBox[{"(", 
                   RowBox[{"1", " ", "-", " ", "t"}], ")"}]}]}]}], "]"}]}], 
             "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"t", ",", " ", "0", ",", " ", "1", ",", " ", "0.03125"}],
              "}"}]}], "]"}], ",", " ", "\n", "      ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Blend", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Blend", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"color", ",", " ", "White"}], "}"}], ",", " ", 
                    "0.25"}], "]"}], ",", " ", "White"}], "}"}], ",", " ", 
                "t"}], "]"}], ",", " ", "\n", "        ", 
              RowBox[{"Rectangle", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"x1", " ", "-", " ", "r", " ", "+", " ", 
                   RowBox[{"0.55", "*", "r"}], " ", "+", " ", 
                   RowBox[{"0.45", "*", "r", "*", "t"}]}], ",", " ", 
                  RowBox[{"y2", " ", "+", " ", 
                   RowBox[{"0.81", "*", "r", "*", "t"}]}]}], "}"}], ",", " ", 
                "\n", "         ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"x2", " ", "+", " ", "r", " ", "-", " ", 
                   RowBox[{"0.55", "*", "r"}], " ", "-", " ", 
                   RowBox[{"0.45", "*", "r", "*", "t"}]}], ",", " ", 
                  RowBox[{"y2", " ", "+", " ", 
                   RowBox[{"0.9", "*", "r"}], " ", "-", " ", 
                   RowBox[{"0.09", "*", "t", "*", "r"}]}]}], "}"}], ",", " ", 
                "\n", "         ", 
                RowBox[{"RoundingRadius", " ", "->", " ", 
                 RowBox[{"0.45", "*", "r", "*", 
                  RowBox[{"(", 
                   RowBox[{"1", " ", "-", " ", "t"}], ")"}]}]}]}], "]"}]}], 
             "}"}], ",", " ", "\n", "       ", 
            RowBox[{"{", 
             RowBox[{"t", ",", " ", "0", ",", " ", "1", ",", " ", "0.03125"}],
              "}"}]}], "]"}]}], "}"}], ",", " ", 
        RowBox[{"ImageSize", " ", "->", " ", "200"}]}], "]"}]}], "]"}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"showbox2D", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xu_", ",", " ", "yu_"}], "}"}], ",", " ", "r_", ",", " ", 
    "color_"}], "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", " ", "=", " ", 
       RowBox[{
        RowBox[{"u2g", "[", "xu", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
      RowBox[{"y", " ", "=", " ", 
       RowBox[{
        RowBox[{"u2g", "[", "yu", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{"gel2D", "[", 
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
      RowBox[{"x", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
      RowBox[{"y", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
      RowBox[{"y", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", " ", "r", ",", " ", "color", ",", 
      " ", "False"}], "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"showbound2D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xub_", ",", " ", "yub_"}], "}"}], ",", " ", "color_"}], "]"}],
     " ", ":=", " ", "\n", "   ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xlo", ",", " ", "xhi", ",", " ", "ylo", ",", " ", "yhi"}], 
       "}"}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xlo", ",", " ", "xhi"}], "}"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"u2g", "[", "xub", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", "\n", "     ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ylo", ",", " ", "yhi"}], "}"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"u2g", "[", "yub", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
       RowBox[{"Graphics", "[", "\n", "      ", 
        RowBox[{"{", 
         RowBox[{"color", ",", " ", 
          RowBox[{"Rectangle", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xlo", ",", " ", "ylo"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"xhi", ",", " ", "yhi"}], "}"}]}], "]"}]}], "}"}], 
        "]"}]}]}], "]"}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{"coalescepass", "[", "set_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "gset", ",", " ", "g", ",", " ", "g1", ",", " ", "g2", ",", " ", "ndim", 
      ",", " ", "udim", ",", " ", "\n", "    ", "width", ",", " ", "i", ",", 
      " ", "j"}], "}"}], ",", " ", 
    RowBox[{
     RowBox[{"ndim", " ", "=", " ", 
      RowBox[{"Length", "[", 
       RowBox[{"set", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", " ", "\n", "    ", 
     RowBox[{"gset", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"u2g", "[", 
         RowBox[{"set", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "set", "]"}]}], "}"}], ",", " ", "\n", 
        "      ", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "1", ",", " ", "ndim"}], "}"}]}], "]"}]}], 
     ";", " ", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"j", " ", "<=", " ", "ndim"}], ",", " ", 
       RowBox[{"j", "++"}], ",", " ", "\n", "     ", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"i", " ", "<=", " ", 
          RowBox[{"Length", "[", "gset", "]"}]}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", 
         RowBox[{
          RowBox[{"g", " ", "=", " ", 
           RowBox[{"gset", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", " ", "\n", "       ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"g", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}], " ", "==", " ", 
             RowBox[{"{", 
              RowBox[{"open", ",", " ", "open"}], "}"}]}], ",", " ", "\n", 
            "        ", 
            RowBox[{
             RowBox[{"width", " ", "=", " ", 
              RowBox[{
               RowBox[{"g", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "1", ",", "2"}], "]"}], "]"}], " ", "-", 
               " ", 
               RowBox[{"g", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "1", ",", "1"}], "]"}], "]"}]}]}], ";", 
             " ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"g", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1", ",", "1"}], "]"}], "]"}], " ", ">=", 
                " ", "0"}], ",", " ", "\n", "          ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"EvenQ", "[", 
                   RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1", ",", "1"}], "]"}], "]"}], "/", 
                    "width"}], "]"}], " ", "&&", " ", "\n", "            ", 
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"g2u", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1", ",", "2"}], "]"}], "]"}], " ", "-",
                     " ", "width"}], ",", " ", 
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1", ",", "2"}], "]"}], "]"}], " ", "+",
                     " ", "\n", "                  ", "width"}]}], "}"}], ",",
                     " ", 
                    RowBox[{"{", 
                    RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], "]"}],
                     "]"}], " ", "==", " ", "1"}]}], ",", " ", "\n", 
                 "           ", 
                 RowBox[{
                  RowBox[{"g1", " ", "=", " ", 
                   RowBox[{"Insert", "[", 
                    RowBox[{
                    RowBox[{"Delete", "[", 
                    RowBox[{"g", ",", " ", "j"}], "]"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1", ",", "2"}], "]"}], "]"}], ",", " ", 
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1", ",", "2"}], "]"}], "]"}]}], "}"}], 
                    ",", " ", "\n", "               ", 
                    RowBox[{"{", 
                    RowBox[{"closed", ",", " ", "closed"}], "}"}]}], "}"}], 
                    ",", " ", "j"}], "]"}]}], ";", " ", 
                  RowBox[{"g2", " ", "=", " ", 
                   RowBox[{"Insert", "[", 
                    RowBox[{
                    RowBox[{"Delete", "[", 
                    RowBox[{"g", ",", " ", "j"}], "]"}], ",", " ", "\n", 
                    "              ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1", ",", "1"}], "]"}], "]"}], " ", "+",
                     " ", "width"}], ",", " ", 
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1", ",", "2"}], "]"}], "]"}], " ", "+",
                     " ", "width"}]}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    "open", ",", " ", "\n", "                ", "open"}], 
                    "}"}]}], "}"}], ",", " ", "j"}], "]"}]}], ";", " ", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"gset", ",", " ", "g1"}], "]"}], " ", "&&", " ", 
                    "\n", "              ", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"gset", ",", " ", "g2"}], "]"}]}], ",", " ", 
                    RowBox[{"gset", " ", "=", " ", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"Complement", "[", 
                    RowBox[{"gset", ",", " ", "\n", "                ", 
                    RowBox[{"{", 
                    RowBox[{"g", ",", " ", "g1", ",", " ", "g2"}], "}"}]}], 
                    "]"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"Insert", "[", 
                    RowBox[{
                    RowBox[{"Delete", "[", 
                    RowBox[{"g", ",", " ", "j"}], "]"}], ",", " ", "\n", 
                    "                 ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1", ",", "1"}], "]"}], "]"}], ",", " ", 
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1", ",", "2"}], "]"}], "]"}], " ", "+",
                     " ", "width"}]}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    "open", ",", " ", "\n", "                   ", "open"}], 
                    "}"}]}], "}"}], ",", " ", "j"}], "]"}], "}"}]}], 
                    "]"}]}]}], "]"}]}]}], "]"}], ",", " ", "\n", "          ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"EvenQ", "[", 
                   RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1", ",", "2"}], "]"}], "]"}], "/", 
                    "width"}], "]"}], " ", "&&", " ", "\n", "            ", 
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"g2u", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1", ",", "1"}], "]"}], "]"}], " ", "-",
                     " ", "width"}], ",", " ", 
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1", ",", "1"}], "]"}], "]"}], " ", "+",
                     " ", "\n", "                  ", "width"}]}], "}"}], ",",
                     " ", 
                    RowBox[{"{", 
                    RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], "]"}],
                     "]"}], " ", "==", " ", "1"}]}], ",", " ", "\n", 
                 "           ", 
                 RowBox[{
                  RowBox[{"g1", " ", "=", " ", 
                   RowBox[{"Insert", "[", 
                    RowBox[{
                    RowBox[{"Delete", "[", 
                    RowBox[{"g", ",", " ", "j"}], "]"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1", ",", "1"}], "]"}], "]"}], ",", " ", 
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1", ",", "1"}], "]"}], "]"}]}], "}"}], 
                    ",", " ", "\n", "               ", 
                    RowBox[{"{", 
                    RowBox[{"closed", ",", " ", "closed"}], "}"}]}], "}"}], 
                    ",", " ", "j"}], "]"}]}], ";", " ", 
                  RowBox[{"g2", " ", "=", " ", 
                   RowBox[{"Insert", "[", 
                    RowBox[{
                    RowBox[{"Delete", "[", 
                    RowBox[{"g", ",", " ", "j"}], "]"}], ",", " ", "\n", 
                    "              ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1", ",", "1"}], "]"}], "]"}], " ", "-",
                     " ", "width"}], ",", " ", 
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1", ",", "2"}], "]"}], "]"}], " ", "-",
                     " ", "width"}]}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    "open", ",", " ", "\n", "                ", "open"}], 
                    "}"}]}], "}"}], ",", " ", "j"}], "]"}]}], ";", " ", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"gset", ",", " ", "g1"}], "]"}], " ", "&&", " ", 
                    "\n", "              ", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"gset", ",", " ", "g2"}], "]"}]}], ",", " ", 
                    RowBox[{"gset", " ", "=", " ", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"Complement", "[", 
                    RowBox[{"gset", ",", " ", "\n", "                ", 
                    RowBox[{"{", 
                    RowBox[{"g", ",", " ", "g1", ",", " ", "g2"}], "}"}]}], 
                    "]"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"Insert", "[", 
                    RowBox[{
                    RowBox[{"Delete", "[", 
                    RowBox[{"g", ",", " ", "j"}], "]"}], ",", " ", "\n", 
                    "                 ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1", ",", "1"}], "]"}], "]"}], " ", "-",
                     " ", "width"}], ",", " ", 
                    RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1", ",", "2"}], "]"}], "]"}]}], "}"}], 
                    ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    "open", ",", " ", "\n", "                   ", "open"}], 
                    "}"}]}], "}"}], ",", " ", "j"}], "]"}], "}"}]}], 
                    "]"}]}]}], "]"}]}]}], "]"}]}], "]"}]}]}], "]"}]}]}], 
        "]"}]}], "]"}], ";", " ", "\n", "    ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"g2u", "[", 
         RowBox[{"gset", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "1", ",", " ", 
         RowBox[{"Length", "[", "gset", "]"}]}], "}"}], ",", " ", "\n", 
       "     ", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", "1", ",", " ", "ndim"}], "}"}]}], "]"}]}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"coalesce", "[", "set_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newset", " ", "=", " ", "set"}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"coalescepass", "[", "newset", "]"}], " ", "!=", " ", 
        "newset"}], ",", " ", "\n", "     ", 
       RowBox[{"newset", " ", "=", " ", 
        RowBox[{"coalescepass", "[", "newset", "]"}]}]}], "]"}], ";", " ", 
     "newset"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"coalesce1D", "[", 
   RowBox[{"ubset_List", ",", " ", 
    RowBox[{"ub_", " ", "/;", " ", 
     RowBox[{"uQ", "[", "ub", "]"}]}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", " ", 
      RowBox[{"newset", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"ut", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"uboundQ", "[", "ub", "]"}], ",", " ", "ub", ",", " ", 
         RowBox[{"{", "ub", "}"}]}], "]"}]}]}], "}"}], ",", " ", "\n", "   ", 
    
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ubset", " ", "==", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"{", "ub", "}"}], ",", " ", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"i", " ", "<=", " ", 
          RowBox[{"Length", "[", "ubset", "]"}]}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", "\n", "      ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ubset", "[", 
              RowBox[{"[", "i", "]"}], "]"}], " ", "\[TildeTilde]", " ", 
             "ut"}], " ", "||", " ", 
            RowBox[{
             RowBox[{"nborlo", "[", 
              RowBox[{
               RowBox[{"ubset", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", " ", "\n", 
               "          ", 
               RowBox[{"-", "Infinity"}]}], "]"}], " ", "\[TildeTilde]", " ", 
             "ut"}], " ", "||", " ", 
            RowBox[{
             RowBox[{"nborhi", "[", 
              RowBox[{
               RowBox[{"ubset", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", 
                  RowBox[{"-", "1"}]}], "]"}], "]"}], ",", " ", "\n", 
               "          ", 
               RowBox[{"-", "Infinity"}]}], "]"}], " ", "\[TildeTilde]", " ", 
             "ut"}]}], ",", " ", 
           RowBox[{"ut", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"minub", "[", 
                RowBox[{
                 RowBox[{"ubset", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", " ", "ut"}], "]"}], 
               "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\n", "         ", 
              RowBox[{
               RowBox[{"maxub", "[", 
                RowBox[{
                 RowBox[{"ubset", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", " ", "ut"}], "]"}], 
               "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}]}], ",", " ", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"newset", ",", " ", "\n", "        ", 
             RowBox[{"ubset", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}], "]"}], ";", 
       " ", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"newset", ",", " ", "ut"}], "]"}], ";", " ", "newset"}]}], 
     "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"boxbound2D", "[", 
   RowBox[{
    RowBox[{"xub_", " ", "/;", " ", 
     RowBox[{"uboundQ", "[", "xub", "]"}]}], ",", " ", "minpowerx_", ",", " ",
     "\n", "   ", 
    RowBox[{"yub_", " ", "/;", " ", 
     RowBox[{"uboundQ", "[", "yub", "]"}]}], ",", " ", "minpowery_"}], "]"}], 
  " ", ":=", " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list", ",", " ", "left", ",", " ", "right", ",", " ", "bottom", ",", 
      " ", "top"}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{"list", " ", "=", " ", 
      RowBox[{"uboxlist", "[", 
       RowBox[{"yub", ",", " ", "minpowery"}], "]"}]}], ";", " ", "\n", 
     "    ", 
     RowBox[{"left", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xub", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
          RowBox[{"list", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], ";", " ", 
     "\n", "    ", 
     RowBox[{"right", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xub", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], ",", " ", 
          RowBox[{"list", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", " ", "\n", "      ", 
        
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], ";", " ", 
     
     RowBox[{"list", " ", "=", " ", 
      RowBox[{"uboxlist", "[", 
       RowBox[{"xub", ",", " ", "minpowerx"}], "]"}]}], ";", " ", "\n", 
     "    ", 
     RowBox[{"bottom", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
          RowBox[{"yub", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", " ", "\n", "      ", 
        
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], ";", " ", 
     "\n", "    ", 
     RowBox[{"top", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
          RowBox[{"yub", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], ";", " ", 
     "\n", "    ", 
     RowBox[{"Union", "[", 
      RowBox[{
      "left", ",", " ", "right", ",", " ", "bottom", ",", " ", "top"}], 
      "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"minub", "[", 
   RowBox[{
    RowBox[{"xub_", " ", "/;", " ", 
     RowBox[{"uboundQ", "[", "xub", "]"}]}], ",", " ", 
    RowBox[{"yub_", " ", "/;", " ", 
     RowBox[{"uboundQ", "[", "yub", "]"}]}]}], "]"}], " ", ":=", " ", "\n", 
  "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"xg", " ", "=", " ", 
       RowBox[{"u2g", "[", "xub", "]"}]}], ",", " ", 
      RowBox[{"yg", " ", "=", " ", 
       RowBox[{"u2g", "[", "yub", "]"}]}]}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"xg", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "<", " ", 
        RowBox[{"yg", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "||", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"xg", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "==", " ", 
          RowBox[{"yg", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "&&", " ", "\n", 
         "       ", 
         RowBox[{"!", 
          RowBox[{"xg", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], ")"}]}], ",", " ", 
      "xub", ",", " ", "yub"}], "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"maxub", "[", 
   RowBox[{
    RowBox[{"xub_", " ", "/;", " ", 
     RowBox[{"uboundQ", "[", "xub", "]"}]}], ",", " ", 
    RowBox[{"yub_", " ", "/;", " ", 
     RowBox[{"uboundQ", "[", "yub", "]"}]}]}], "]"}], " ", ":=", " ", "\n", 
  "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"xg", " ", "=", " ", 
       RowBox[{"u2g", "[", "xub", "]"}]}], ",", " ", 
      RowBox[{"yg", " ", "=", " ", 
       RowBox[{"u2g", "[", "yub", "]"}]}]}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"xg", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", ">", " ", 
        RowBox[{"yg", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", "||", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"xg", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "==", " ", 
          RowBox[{"yg", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", "&&", " ", "\n", 
         "       ", 
         RowBox[{"!", 
          RowBox[{"xg", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ")"}]}], ",", " ", 
      "xub", ",", " ", "yub"}], "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"findnbors", "[", 
   RowBox[{"set_", ",", " ", "minpowers_"}], "]"}], " ", ":=", " ", "\n", 
  "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "nbors", ",", " ", "s", ",", " ", 
      RowBox[{"tempset", " ", "=", " ", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"i", " ", "<=", " ", 
        RowBox[{"Length", "[", "set", "]"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", " ", 
       RowBox[{
        RowBox[{"s", " ", "=", " ", 
         RowBox[{"set", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", " ", "\n", "      ", 
        RowBox[{"tempset", " ", "=", " ", 
         RowBox[{"Union", "[", 
          RowBox[{"tempset", ",", " ", 
           RowBox[{"Tuples", "[", "\n", "         ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"nborlo", "[", 
                 RowBox[{
                  RowBox[{"s", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", " ", 
                  RowBox[{"minpowers", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", " ", 
                RowBox[{"s", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", " ", "\n", 
                "           ", 
                RowBox[{"nborhi", "[", 
                 RowBox[{
                  RowBox[{"s", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", " ", 
                  RowBox[{"minpowers", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], "}"}], ",", " ",
               "\n", "          ", 
              RowBox[{"{", 
               RowBox[{"j", ",", " ", "1", ",", " ", 
                RowBox[{"Length", "[", "s", "]"}]}], "}"}]}], "]"}], "]"}]}], 
          "]"}]}]}]}], "]"}], ";", " ", 
     RowBox[{"Complement", "[", 
      RowBox[{"tempset", ",", " ", "set"}], "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"width", "[", 
   RowBox[{"u_", " ", "/;", " ", 
    RowBox[{
     RowBox[{"unumQ", "[", "u", "]"}], " ", "||", " ", 
     RowBox[{"uboundQ", "[", "u", "]"}]}]}], "]"}], " ", ":=", " ", "\n", 
  "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"glo", ",", " ", "ghi"}], "}"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"glo", ",", " ", "ghi"}], "}"}], " ", "=", " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"unumQ", "[", "u", "]"}], ",", " ", 
        RowBox[{
         RowBox[{"u2g", "[", "u", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\n", "      ", 
        RowBox[{
         RowBox[{"u2g", "[", "u", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", " ", 
     RowBox[{"ghi", " ", "-", " ", "glo"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"volume", "[", "set_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"Length", "[", "set", "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"ndim", " ", "=", " ", 
       RowBox[{"Length", "[", 
        RowBox[{"set", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], "}"}], ",", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Product", "[", 
       RowBox[{
        RowBox[{"width", "[", 
         RowBox[{"set", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ",", " ", "\n", 
        "     ", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "1", ",", " ", "ndim"}], "}"}]}], "]"}], ",", 
      " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"spacestepbounds", "[", 
   RowBox[{"ubox_", ",", " ", "r_"}], "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x2u", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u2g", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"ubox", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "}"}], " ", "\[CircleMinus]", 
            " ", 
            RowBox[{"{", 
             RowBox[{"x2u", "[", "r", "]"}], "}"}]}], "]"}], " ", "+", " ", 
          "\n", "       ", 
          RowBox[{"smallsubnormal", "/", "2"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], ",", " ", "\n", "    ", 
      RowBox[{"x2u", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u2g", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"ubox", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "}"}], " ", "\[CirclePlus]", 
            " ", 
            RowBox[{"{", 
             RowBox[{"x2u", "[", "r", "]"}], "}"}]}], "]"}], " ", "-", " ", 
          "\n", "       ", 
          RowBox[{"smallsubnormal", "/", "2"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "1", ",", " ", 
      RowBox[{"Length", "[", "ubox", "]"}]}], "}"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"spacestep", "[", 
   RowBox[{"ubox_", ",", " ", "r_", ",", " ", "minpower_"}], "]"}], " ", ":=",
   " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"bounds", " ", "=", " ", 
      RowBox[{"spacestepbounds", "[", 
       RowBox[{"ubox", ",", " ", "r"}], "]"}]}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{"Tuples", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"uboxlist", "[", 
         RowBox[{
          RowBox[{"bounds", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", " ", "minpower"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", " ", ";;", " ", 
          RowBox[{"-", "1"}]}], "]"}], "]"}], ",", " ", "\n", "     ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "1", ",", " ", 
         RowBox[{"Length", "[", "bounds", "]"}]}], "}"}]}], "]"}], "]"}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"setintersectQ", "[", 
   RowBox[{"ub_", ",", " ", "set_"}], "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"intQ", " ", "=", " ", "False"}], ",", " ", 
      RowBox[{"ndim", " ", "=", " ", 
       RowBox[{"Length", "[", "ub", "]"}]}], ",", " ", "n"}], "}"}], ",", " ",
     "\n", "   ", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"i", " ", "<=", " ", 
        RowBox[{"Length", "[", "set", "]"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", " ", "\n", "     ", 
       RowBox[{
        RowBox[{"n", " ", "=", " ", "0"}], ";", " ", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", " ", "=", " ", "1"}], ",", " ", 
           RowBox[{"j", " ", "<=", " ", "ndim"}], ",", " ", 
           RowBox[{"j", "++"}], ",", " ", "\n", "        ", 
           RowBox[{"n", " ", "+=", " ", 
            RowBox[{"Boole", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ub", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "}"}], " ", "\[TildeTilde]", 
              " ", 
              RowBox[{"{", 
               RowBox[{"set", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "}"}]}], "]"}]}]}], 
          "]"}], "*", "\n", "       ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"n", " ", "==", " ", "ndim"}], ",", " ", 
           RowBox[{"intQ", " ", "=", " ", "True"}]}], "]"}]}]}]}], "]"}], ";",
      " ", "intQ"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"gsetintersectQ", "[", 
   RowBox[{"gs_", ",", " ", "gset_"}], "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"intQ", " ", "=", " ", "False"}], ",", " ", "n", ",", " ", 
      RowBox[{"ndim", " ", "=", " ", 
       RowBox[{"Length", "[", "gs", "]"}]}]}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"i", " ", "<=", " ", 
        RowBox[{"Length", "[", "gset", "]"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", " ", "\n", "     ", 
       RowBox[{
        RowBox[{"n", " ", "=", " ", "0"}], ";", " ", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", " ", "=", " ", "1"}], ",", " ", 
          RowBox[{"j", " ", "<=", " ", "ndim"}], ",", " ", 
          RowBox[{"j", "++"}], ",", " ", "\n", "       ", 
          RowBox[{"n", " ", "+=", " ", 
           RowBox[{"Boole", "[", 
            RowBox[{"nneqgQ", "[", 
             RowBox[{
              RowBox[{"gs", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", " ", 
              RowBox[{"gset", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}], "]"}]}]}], 
         "]"}], ";", " ", "\n", "      ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", " ", "==", " ", "ndim"}], ",", " ", 
          RowBox[{"intQ", " ", "=", " ", "True"}]}], "]"}]}]}], "]"}], ";", 
     " ", "intQ"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"hollowout", "[", "set_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "gnbors", ",", " ", "gset", ",", " ", "i", ",", " ", "j", ",", " ", 
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"Length", "[", "set", "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"ndim", " ", "=", " ", 
       RowBox[{"Length", "[", 
        RowBox[{"set", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", " ", "nbors", ",", " ",
       "nnbors", ",", " ", 
      RowBox[{"boundary", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ",", " ", "ub"}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{"gset", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"u2g", "[", 
         RowBox[{"set", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", "n"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "1", ",", " ", "ndim"}], "}"}]}], "]"}]}], 
     ";", " ", "\n", "    ", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"i", " ", "<=", " ", "n"}], ",", " ", 
       RowBox[{"i", "++"}], ",", " ", 
       RowBox[{
        RowBox[{"ub", " ", "=", " ", 
         RowBox[{"set", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", " ", "\n", "      ", 
        RowBox[{"nbors", " ", "=", " ", 
         RowBox[{"findnbors", "[", 
          RowBox[{
           RowBox[{"{", "ub", "}"}], ",", " ", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", " ", 
             RowBox[{"{", "ndim", "}"}]}], "]"}]}], "]"}]}], ";", " ", "\n", 
        "      ", 
        RowBox[{"nnbors", " ", "=", " ", 
         RowBox[{"Length", "[", "nbors", "]"}]}], ";", " ", 
        RowBox[{"gnbors", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"u2g", "[", 
            RowBox[{"nbors", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ",", " ", "\n", 
           "        ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "1", ",", " ", "nnbors"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "1", ",", " ", "ndim"}], "}"}]}], "]"}]}], 
        ";", " ", 
        RowBox[{"j", " ", "=", " ", "1"}], ";", " ", "\n", "      ", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"j", " ", "<=", " ", "nnbors"}], " ", "&&", " ", 
           RowBox[{"gsetintersectQ", "[", 
            RowBox[{
             RowBox[{"gnbors", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", " ", "gset"}], "]"}]}], 
          ",", " ", "\n", "       ", 
          RowBox[{"j", "++"}]}], "]"}], ";", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", " ", "<", " ", "nnbors"}], ",", " ", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"boundary", ",", " ", 
            RowBox[{"{", "ub", "}"}]}], "]"}]}], "]"}]}]}], "]"}], ";", " ", 
     "\n", "    ", "boundary"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"glistQ", "[", "g_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"q", " ", "=", " ", "True"}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "g", "]"}], " ", "==", " ", "List"}], ",", " ", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"i", " ", "<=", " ", 
          RowBox[{"Length", "[", "g", "]"}]}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", "\n", "      ", 
         RowBox[{"If", "[", " ", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"gQ", "[", 
             RowBox[{"g", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", " ", 
           RowBox[{"q", " ", "=", " ", "False"}]}], "]"}]}], "]"}], ",", " ", 
       
       RowBox[{"q", " ", "=", " ", "False"}]}], "]"}], ";", " ", "q"}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"glistNaNQ", "[", "g_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"q", " ", "=", " ", "False"}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"i", " ", "<=", " ", 
        RowBox[{"1", "*", 
         RowBox[{"Length", "[", "g", "]"}]}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}], " ", "===", " ",
            "NaN"}], " ", "||", " ", 
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], " ", "===", " ",
            "NaN"}]}], ",", " ", 
         RowBox[{"q", " ", "=", " ", "True"}]}], "]"}]}], "]"}], ";", " ", 
     "q"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ulistQ", "[", "u_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", " ", 
      RowBox[{"q", " ", "=", " ", "True"}]}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "u", "]"}], " ", "==", " ", "List"}], ",", " ", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"i", " ", "<=", " ", 
          RowBox[{"Length", "[", "u", "]"}]}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", "\n", "      ", 
         RowBox[{"If", "[", " ", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"uQ", "[", 
             RowBox[{"u", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", " ", 
           RowBox[{"q", " ", "=", " ", "False"}]}], "]"}]}], "]"}], ",", " ", 
       
       RowBox[{"q", " ", "=", " ", "False"}]}], "]"}], ";", " ", "q"}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ulistNaNQ", "[", "u_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", " ", 
      RowBox[{"q", " ", "=", " ", "False"}]}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"i", " ", "<=", " ", 
        RowBox[{"1", "*", 
         RowBox[{"Length", "[", "u", "]"}]}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"u", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", "==", " ", "qNaNu"}], " ", "||",
           " ", 
          RowBox[{
           RowBox[{"u", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", "==", " ", "sNaNu"}]}], ",", 
         " ", 
         RowBox[{"q", " ", "=", " ", "True"}]}], "]"}]}], "]"}], ";", " ", 
     "q"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"polyTg", "[", 
   RowBox[{"coeffsg_", ",", " ", "xg_", ",", " ", "x0g_"}], "]"}], " ", ":=", 
  " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"bi", ",", " ", "i", ",", " ", "j", ",", " ", 
      RowBox[{"k", " ", "=", " ", 
       RowBox[{"Length", "[", "coeffsg", "]"}]}], ",", " ", 
      RowBox[{"coeffstg", " ", "=", " ", "coeffsg"}], ",", " ", "\n", "    ", 
      "pg", ",", " ", "xmg"}], "}"}], ",", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"x0g", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "==", " ", 
        RowBox[{"-", "Infinity"}]}], " ", "||", " ", "\n", "     ", 
       RowBox[{
        RowBox[{"x0g", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "==", " ", 
        "Infinity"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "Infinity"}], ",", " ", "Infinity"}], "}"}], ",", " ", 
        "\n", "     ", 
        RowBox[{"{", 
         RowBox[{"closed", ",", " ", "closed"}], "}"}]}], "}"}], ",", " ", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", " ", "=", " ", "0"}], ",", " ", 
         RowBox[{"j", " ", "<=", " ", 
          RowBox[{"k", " ", "-", " ", "1"}]}], ",", " ", 
         RowBox[{"j", "++"}], ",", " ", "\n", "      ", 
         RowBox[{
          RowBox[{"bi", " ", "=", " ", 
           RowBox[{"Binomial", "[", 
            RowBox[{
             RowBox[{"k", " ", "-", " ", "1"}], ",", " ", "j"}], "]"}]}], ";",
           " ", 
          RowBox[{"pg", " ", "=", " ", 
           RowBox[{"timesg", "[", 
            RowBox[{
             RowBox[{"coeffsg", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], ",", " ", "\n", "         ", 
             
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"bi", ",", " ", "bi"}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"closed", ",", " ", "closed"}], "}"}]}], "}"}]}], 
            "]"}]}], ";", " ", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", " ", "=", " ", 
             RowBox[{"k", " ", "-", " ", "2"}]}], ",", " ", 
            RowBox[{"i", " ", ">=", " ", "j"}], ",", " ", "\n", "        ", 
            RowBox[{"i", "--"}], ",", " ", 
            RowBox[{
             RowBox[{"bi", " ", "=", " ", 
              RowBox[{"Binomial", "[", 
               RowBox[{"i", ",", " ", "j"}], "]"}]}], ";", " ", "\n", 
             "         ", 
             RowBox[{"pg", " ", "=", " ", 
              RowBox[{"plusg", "[", 
               RowBox[{
                RowBox[{"timesg", "[", 
                 RowBox[{
                  RowBox[{"coeffsg", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", " ", "+", " ", "1"}], "]"}], "]"}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"bi", ",", " ", "bi"}], "}"}], ",", " ", "\n", 
                    "             ", 
                    RowBox[{"{", 
                    RowBox[{"closed", ",", " ", "closed"}], "}"}]}], "}"}]}], 
                 "]"}], ",", " ", 
                RowBox[{"timesg", "[", 
                 RowBox[{"x0g", ",", " ", "pg"}], "]"}]}], "]"}]}]}]}], "]"}],
           ";", " ", "\n", "       ", 
          RowBox[{
           RowBox[{"coeffstg", "[", 
            RowBox[{"[", 
             RowBox[{"j", " ", "+", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
           "pg"}]}]}], "]"}], ";", " ", 
       RowBox[{"xmg", " ", "=", " ", 
        RowBox[{"minusg", "[", 
         RowBox[{"xg", ",", " ", "x0g"}], "]"}]}], ";", " ", "\n", "     ", 
       RowBox[{"pg", " ", "=", " ", 
        RowBox[{"coeffstg", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], ";", " ", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", 
          RowBox[{"k", " ", "-", " ", "1"}]}], ",", " ", 
         RowBox[{"i", " ", ">=", " ", "1"}], ",", " ", 
         RowBox[{"i", "--"}], ",", " ", "\n", "      ", 
         RowBox[{"pg", " ", "=", " ", 
          RowBox[{"plusg", "[", 
           RowBox[{
            RowBox[{"timesg", "[", 
             RowBox[{"pg", ",", " ", "xmg"}], "]"}], ",", " ", 
            RowBox[{"coeffstg", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "]"}], ";", " ", 
       "pg"}]}], "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"polyinexactg", "[", 
   RowBox[{"coeffsg_", ",", " ", "xg_"}], "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"intersectg", "[", 
   RowBox[{
    RowBox[{"polyTg", "[", 
     RowBox[{"coeffsg", ",", " ", "xg", ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xg", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
          RowBox[{"xg", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}], ",", " ", "\n", 
        "     ", 
        RowBox[{"{", 
         RowBox[{"closed", ",", " ", "closed"}], "}"}]}], "}"}]}], "]"}], ",",
     " ", 
    RowBox[{"polyTg", "[", 
     RowBox[{"coeffsg", ",", " ", "xg", ",", " ", "\n", "    ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xg", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", " ", 
          RowBox[{"xg", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"closed", ",", " ", "closed"}], "}"}]}], "}"}]}], "]"}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"polyexactg", "[", 
   RowBox[{"coeffsg_", ",", " ", "xg_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", " ", 
      RowBox[{"k", " ", "=", " ", 
       RowBox[{"Length", "[", "coeffsg", "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"pg", " ", "=", " ", 
       RowBox[{"coeffsg", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}]}]}], "}"}], ",", " ", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", 
        RowBox[{"k", " ", "-", " ", "1"}]}], ",", " ", 
       RowBox[{"i", " ", ">=", " ", "1"}], ",", " ", 
       RowBox[{"i", "--"}], ",", " ", "\n", "     ", 
       RowBox[{"pg", " ", "=", " ", 
        RowBox[{"plusg", "[", 
         RowBox[{
          RowBox[{"coeffsg", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
          RowBox[{"timesg", "[", 
           RowBox[{"pg", ",", " ", "xg"}], "]"}]}], "]"}]}]}], "]"}], ";", 
     " ", "pg"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"bisect", "[", 
   RowBox[{"g_", " ", "/;", " ", 
    RowBox[{"gQ", "[", "g", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"gL", " ", "=", " ", 
       RowBox[{"g", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", " ", "gM", ",", " ", 
      "\n", "    ", 
      RowBox[{"gR", " ", "=", " ", 
       RowBox[{"g", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", " ", "m"}], "}"}], ",",
     " ", 
    RowBox[{
     RowBox[{"gM", " ", "=", " ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gL", " ", "<", " ", "0"}], " ", "&&", " ", 
         RowBox[{"gR", " ", ">", " ", "0"}]}], ",", " ", "0", ",", " ", "\n", 
        "      ", 
        RowBox[{
         RowBox[{"gL", " ", "==", " ", 
          RowBox[{"-", "Infinity"}]}], " ", "&&", " ", 
         RowBox[{"gR", " ", ">", " ", 
          RowBox[{"-", "maxreal"}]}]}], ",", " ", 
        RowBox[{"-", "maxreal"}], ",", " ", "\n", "      ", 
        RowBox[{
         RowBox[{"gL", " ", "<", " ", "maxreal"}], " ", "&&", " ", 
         RowBox[{"gR", " ", "==", " ", "Infinity"}]}], ",", " ", "maxreal", 
        ",", " ", "\n", "      ", 
        RowBox[{
         RowBox[{"m", " ", "=", " ", 
          RowBox[{"2", "^", 
           RowBox[{"Floor", "[", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", " ", 
              RowBox[{"gR", " ", "-", " ", "gL"}]}], "]"}], "]"}]}]}], ";", 
         " ", 
         RowBox[{"IntegerQ", "[", 
          RowBox[{"gL", "/", "m"}], "]"}]}], ",", " ", "\n", "      ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"gR", " ", "-", " ", "gL"}], " ", "==", " ", "m"}], ",", 
          " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"gL", " ", "+", " ", "gR"}], ")"}], "/", "2"}], ",", " ", 
          
          RowBox[{"m", "*", 
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"gL", "/", "m"}], " ", "+", " ", "1"}], "]"}]}]}], "]"}],
         ",", " ", "True", ",", " ", "\n", "      ", 
        RowBox[{"m", "*", 
         RowBox[{"Ceiling", "[", 
          RowBox[{"gL", "/", "m"}], "]"}]}]}], "]"}]}], ";", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"gL", ",", " ", "gM"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", "open"}], 
          "}"}]}], "}"}], ",", " ", "\n", "     ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"gM", ",", " ", "gR"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"open", ",", " ", 
           RowBox[{"g", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}]}], "}"}]}], 
      "}"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"polyg", "[", 
   RowBox[{
    RowBox[{"coeffsg_", " ", "/;", " ", 
     RowBox[{"glistQ", "[", "coeffsg", "]"}]}], ",", " ", 
    RowBox[{"xg_", " ", "/;", " ", 
     RowBox[{"gQ", "[", "xg", "]"}]}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gL", ",", " ", "gR", ",", " ", "gM", ",", " ", 
      RowBox[{"k", " ", "=", " ", 
       RowBox[{"Length", "[", "coeffsg", "]"}]}], ",", " ", "min", ",", " ", 
      "minQ", ",", " ", "max", ",", " ", "\n", "    ", "maxQ", ",", " ", "pg",
       ",", " ", "trials"}], "}"}], ",", " ", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"xg", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "===", " ", "NaN"}], 
       " ", "||", " ", "\n", "     ", 
       RowBox[{
        RowBox[{"xg", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "===", " ", "NaN"}], 
       " ", "||", " ", 
       RowBox[{"glistNaNQ", "[", "coeffsg", "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"NaN", ",", " ", "NaN"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"open", ",", " ", "open"}], "}"}]}], "}"}], ",", " ", 
      RowBox[{"k", " ", "==", " ", "1"}], ",", " ", 
      RowBox[{"coeffsg", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
      RowBox[{"k", " ", "==", " ", "2"}], ",", " ", "\n", "    ", 
      RowBox[{"fmag", "[", 
       RowBox[{
        RowBox[{"coeffsg", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", " ", "xg", ",", " ", 
        RowBox[{"coeffsg", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"xg", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "==", " ", 
       RowBox[{"xg", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", " ", 
      RowBox[{"polyexactg", "[", 
       RowBox[{"coeffsg", ",", " ", "xg"}], "]"}], ",", " ", "True", ",", " ",
       "\n", "    ", 
      RowBox[{
       RowBox[{"trials", " ", "=", " ", 
        RowBox[{"{", "xg", "}"}]}], ";", " ", 
       RowBox[{"gL", " ", "=", " ", 
        RowBox[{"polyexactg", "[", 
         RowBox[{"coeffsg", ",", " ", "\n", "       ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xg", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
              RowBox[{"xg", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"closed", ",", " ", "closed"}], "}"}]}], "}"}]}], 
         "]"}]}], ";", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"xg", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{"gL", "[", 
           RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"open", ",", " ", "open"}], "}"}]}]}], "]"}], ";", " ", 
       "\n", "     ", 
       RowBox[{"gR", " ", "=", " ", 
        RowBox[{"polyexactg", "[", 
         RowBox[{"coeffsg", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xg", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", " ", 
              RowBox[{"xg", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], ",", " ", 
            "\n", "        ", 
            RowBox[{"{", 
             RowBox[{"closed", ",", " ", "closed"}], "}"}]}], "}"}]}], 
         "]"}]}], ";", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"xg", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", " ", "\n", "      ", 
         RowBox[{
          RowBox[{"gR", "[", 
           RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"open", ",", " ", "open"}], "}"}]}]}], "]"}], ";", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"gL", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "<", " ", 
           RowBox[{"gR", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "||", " ", "\n", 
          "       ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"gL", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "==", " ", 
             RowBox[{"gR", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "&&", "  ", 
            RowBox[{"!", 
             RowBox[{"gL", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], ")"}]}], ",", " ", 
         "\n", "      ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"min", ",", " ", "minQ"}], "}"}], " ", "=", " ", 
          RowBox[{
           RowBox[{"Transpose", "[", "gL", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"min", ",", " ", "minQ"}], "}"}], " ", "=", " ", "\n", 
          "       ", 
          RowBox[{
           RowBox[{"Transpose", "[", "gR", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"gL", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", ">", " ", 
           RowBox[{"gR", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", "||", " ", "\n", 
          "       ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"gL", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "==", " ", 
             RowBox[{"gR", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", "&&", "  ", 
            RowBox[{"!", 
             RowBox[{"gL", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ")"}]}], ",", " ", 
         "\n", "      ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"max", ",", " ", "maxQ"}], "}"}], " ", "=", " ", 
          RowBox[{
           RowBox[{"Transpose", "[", "gL", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"max", ",", " ", "maxQ"}], "}"}], " ", "=", " ", "\n", 
          "       ", 
          RowBox[{
           RowBox[{"Transpose", "[", "gR", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ";", " ", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "trials", "]"}], " ", ">=", " ", "1"}], ",", 
         " ", "\n", "      ", 
         RowBox[{
          RowBox[{"pg", " ", "=", " ", 
           RowBox[{"polyinexactg", "[", 
            RowBox[{"coeffsg", ",", " ", 
             RowBox[{"trials", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", " ", "\n", 
          "       ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"intersectg", "[", 
              RowBox[{
               RowBox[{"u2g", "[", 
                RowBox[{"g2u", "[", "pg", "]"}], "]"}], ",", " ", "\n", 
               "          ", 
               RowBox[{"u2g", "[", 
                RowBox[{"g2u", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"min", ",", " ", "max"}], "}"}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"minQ", ",", " ", "maxQ"}], "}"}]}], "}"}], "]"}],
                 "]"}]}], "]"}], " ", "===", " ", "\n", "         ", 
             RowBox[{"u2g", "[", 
              RowBox[{"g2u", "[", "pg", "]"}], "]"}]}], ",", " ", 
            RowBox[{"trials", " ", "=", " ", 
             RowBox[{"Rest", "[", "trials", "]"}]}], ",", " ", "\n", 
            "        ", 
            RowBox[{
             RowBox[{"trials", " ", "=", " ", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"bisect", "[", 
                 RowBox[{"trials", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", " ", 
                RowBox[{"Rest", "[", "trials", "]"}]}], "]"}]}], ";", " ", 
             "\n", "         ", 
             RowBox[{"gM", " ", "=", " ", 
              RowBox[{"polyexactg", "[", 
               RowBox[{"coeffsg", ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"trials", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], ",", " ",
                     "\n", "             ", 
                    RowBox[{"trials", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], "}"}], 
                  ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"closed", ",", " ", "closed"}], "}"}]}], "}"}]}], 
               "]"}]}], ";", " ", "\n", "         ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"gM", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "<", " ", 
                 "min"}], " ", "||", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"gM", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "==", " ", 
                   "min"}], " ", "&&", " ", "\n", "             ", 
                  RowBox[{"!", 
                   RowBox[{"gM", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], ")"}]}], ",", 
               " ", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"min", ",", " ", "minQ"}], "}"}], " ", "=", " ", 
                RowBox[{
                 RowBox[{"Transpose", "[", "gM", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";", " ", "\n", 
             "         ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"gM", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", ">", " ", 
                 "max"}], " ", "||", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"gM", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "==", " ", 
                   "max"}], " ", "&&", " ", "\n", "             ", 
                  RowBox[{"!", 
                   RowBox[{"gM", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ")"}]}], ",", 
               " ", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"max", ",", " ", "maxQ"}], "}"}], " ", "=", " ", 
                RowBox[{
                 RowBox[{"Transpose", "[", "gM", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ";", " ", "\n", 
             "         ", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"min", ",", " ", "max"}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"minQ", ",", " ", "maxQ"}], "}"}]}], "}"}], " ", "=",
               " ", "\n", "          ", 
              RowBox[{"u2g", "[", 
               RowBox[{"g2u", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"min", ",", " ", "max"}], "}"}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"minQ", ",", " ", "maxQ"}], "}"}]}], "}"}], "]"}], 
               "]"}]}]}]}], "]"}]}]}], "]"}], ";", " ", "\n", "     ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"min", ",", " ", "max"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"minQ", ",", " ", "maxQ"}], "}"}]}], "}"}]}]}], "]"}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"polyu", "[", 
   RowBox[{
    RowBox[{"coeffsu_", " ", "/;", " ", 
     RowBox[{"ulistQ", "[", "coeffsu", "]"}]}], ",", " ", 
    RowBox[{"u_", " ", "/;", " ", 
     RowBox[{"uQ", "[", "u", "]"}]}]}], "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"coeffsg", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"u2g", "[", 
         RowBox[{"coeffsu", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", " ", "\n", "      ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "coeffsu", "]"}]}], "}"}]}], "]"}]}], "}"}], 
    ",", " ", 
    RowBox[{"g2u", "[", 
     RowBox[{"polyg", "[", 
      RowBox[{"coeffsg", ",", " ", 
       RowBox[{"u2g", "[", "u", "]"}]}], "]"}], "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ubinsert", "[", 
   RowBox[{"ubset_", ",", " ", 
    RowBox[{"ub_", " ", "/;", " ", 
     RowBox[{"uboundQ", "[", "ub", "]"}]}]}], "]"}], " ", ":=", " ", "\n", 
  "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "j", ",", " ", 
      RowBox[{"k", " ", "=", " ", 
       RowBox[{"Length", "[", "ubset", "]"}]}], ",", " ", 
      RowBox[{"lefttouch", " ", "=", " ", "False"}], ",", " ", "\n", "    ", 
      RowBox[{"righttouch", " ", "=", " ", "False"}], ",", " ", 
      RowBox[{"newset", " ", "=", " ", "ubset"}]}], "}"}], ",", " ", "\n", 
    "   ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"k", " ", "==", " ", "0"}], ",", " ", 
      RowBox[{"{", "ub", "}"}], ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"j", " ", "=", " ", "k"}], ";", " ", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"j", " ", ">", " ", "0"}], " ", "&&", " ", 
            RowBox[{"gtuQ", "[", 
             RowBox[{
              RowBox[{"newset", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", " ", "ub"}], "]"}]}], ",",
            " ", 
           RowBox[{"j", "--"}]}], "]"}], ";"}], " ", ")"}], ";", " ", "\n", 
       "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"j", " ", ">", " ", "0"}], ",", " ", 
         RowBox[{"lefttouch", " ", "=", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"nborhi", "[", 
             RowBox[{
              RowBox[{"newset", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", 
                 RowBox[{"-", "1"}]}], "]"}], "]"}], ",", " ", "\n", 
              "          ", 
              RowBox[{"-", "Infinity"}]}], "]"}], "}"}], " ", "\[TildeTilde]",
            " ", "ub"}]}]}], "]"}], ";", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"j", " ", "<", " ", "k"}], ",", " ", 
         RowBox[{"righttouch", " ", "=", " ", "\n", "       ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"nborlo", "[", 
             RowBox[{
              RowBox[{"newset", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"j", " ", "+", " ", "1"}], ",", "1"}], "]"}], "]"}], 
              ",", " ", 
              RowBox[{"-", "Infinity"}]}], "]"}], "}"}], " ", "\[TildeTilde]",
            " ", "ub"}]}]}], "]"}], ";", " ", "\n", "     ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"lefttouch", " ", "&&", " ", "righttouch"}], ",", " ", "\n", 
         "      ", 
         RowBox[{
          RowBox[{"newset", " ", "=", " ", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Drop", "[", 
              RowBox[{"newset", ",", " ", 
               RowBox[{"{", 
                RowBox[{"j", ",", " ", "k"}], "}"}]}], "]"}], ",", " ", "\n", 
             "         ", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"newset", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", " ", 
                RowBox[{"newset", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"j", " ", "+", " ", "1"}], ",", 
                   RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}], "}"}], ",", 
             " ", "\n", "         ", 
             RowBox[{"Drop", "[", 
              RowBox[{"newset", ",", " ", 
               RowBox[{"{", 
                RowBox[{"1", ",", " ", 
                 RowBox[{"j", " ", "+", " ", "1"}]}], "}"}]}], "]"}]}], 
            "]"}]}], ";"}], " ", ",", " ", 
         RowBox[{"lefttouch", " ", "&&", " ", "\n", "        ", 
          RowBox[{"!", "righttouch"}]}], ",", " ", 
         RowBox[{
          RowBox[{"newset", " ", "=", " ", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Drop", "[", 
              RowBox[{"newset", ",", " ", 
               RowBox[{"{", 
                RowBox[{"j", ",", " ", "k"}], "}"}]}], "]"}], ",", " ", "\n", 
             "         ", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"newset", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", " ", 
                RowBox[{"ub", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], "}"}], ",", " ", 
             
             RowBox[{"Drop", "[", 
              RowBox[{"newset", ",", " ", 
               RowBox[{"{", 
                RowBox[{"1", ",", " ", "j"}], "}"}]}], "]"}]}], "]"}]}], 
          ";"}], " ", ",", " ", "\n", "       ", 
         RowBox[{
          RowBox[{"!", "lefttouch"}], " ", "&&", " ", "righttouch"}], ",", 
         " ", "\n", "      ", 
         RowBox[{
          RowBox[{"newset", " ", "=", " ", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Drop", "[", 
              RowBox[{"newset", ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"j", " ", "+", " ", "1"}], ",", " ", "k"}], "}"}]}], 
              "]"}], ",", " ", "\n", "         ", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"ub", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}], ",", " ", 
                RowBox[{"newset", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"j", " ", "+", " ", "1"}], ",", 
                   RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}], "}"}], ",", 
             " ", 
             RowBox[{"Drop", "[", 
              RowBox[{"newset", ",", " ", "\n", "          ", 
               RowBox[{"{", 
                RowBox[{"1", ",", " ", 
                 RowBox[{"j", " ", "+", " ", "1"}]}], "}"}]}], "]"}]}], 
            "]"}]}], ";"}], " ", ",", " ", "True", ",", " ", "\n", "      ", 
         RowBox[{
          RowBox[{"newset", " ", "=", " ", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"j", " ", "+", " ", "1"}], " ", ">", " ", "k"}], ",", 
               " ", "newset", ",", " ", 
               RowBox[{"Drop", "[", 
                RowBox[{"newset", ",", " ", "\n", "           ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"j", " ", "+", " ", "1"}], ",", " ", "k"}], 
                  "}"}]}], "]"}]}], "]"}], ",", " ", 
             RowBox[{"{", "ub", "}"}], ",", " ", 
             RowBox[{"Drop", "[", 
              RowBox[{"newset", ",", " ", 
               RowBox[{"{", 
                RowBox[{"1", ",", " ", "j"}], "}"}]}], "]"}]}], "]"}]}], 
          ";"}]}], " ", "]"}], ";", " ", "\n", "     ", "newset"}]}], "]"}]}],
    "]"}]}], "\n", 
 RowBox[{
  RowBox[{"solveforub", "[", "domain_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "new", ",", " ", 
      RowBox[{"sols", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ",", " ", "temp", ",", " ", "\n", "    ", 
      RowBox[{"trials", " ", "=", " ", "domain"}], ",", " ", "ub"}], "}"}], 
    ",", " ", 
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "trials", "]"}], " ", ">", " ", "0"}], ",", 
       " ", "\n", "     ", 
       RowBox[{
        RowBox[{"new", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", " ", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
          RowBox[{"i", " ", "<=", " ", 
           RowBox[{"Length", "[", "trials", "]"}]}], ",", " ", 
          RowBox[{"i", "++"}], ",", " ", "\n", "       ", 
          RowBox[{
           RowBox[{"ub", " ", "=", " ", 
            RowBox[{"trials", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"conditionQ", "[", "ub", "]"}], ",", " ", "\n", 
             "         ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"temp", " ", "=", " ", 
                 RowBox[{"splitub", "[", "ub", "]"}]}], ";"}], " ", ")"}], 
              ";", " ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "temp", "]"}], " ", "==", " ", "1"}], 
                ",", " ", "\n", "           ", 
                RowBox[{"sols", " ", "=", " ", 
                 RowBox[{"ubinsert", "[", 
                  RowBox[{"sols", ",", " ", 
                   RowBox[{"temp", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ",", " ", "\n",
                 "           ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"new", " ", "=", " ", 
                    RowBox[{"Join", "[", 
                    RowBox[{"temp", ",", " ", "new"}], "]"}]}], ";"}], " ", 
                  ")"}], ";"}]}], " ", "]"}]}]}], "]"}]}]}], "]"}], ";", " ", 
        
        RowBox[{"trials", " ", "=", " ", "new"}]}]}], "]"}], ";", " ", 
     "sols"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"accub", "[", 
   RowBox[{"{", 
    RowBox[{"xub_", ",", " ", "yub_"}], "}"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "i", ",", " ", "j", ",", " ", "x", ",", " ", "y", ",", " ", "a", ",", 
      " ", "b", ",", " ", "s", ",", " ", "\n", "    ", 
      RowBox[{"amin", " ", "=", " ", "Infinity"}], ",", " ", 
      RowBox[{"amax", " ", "=", " ", 
       RowBox[{"-", "Infinity"}]}], ",", " ", 
      RowBox[{"bmin", " ", "=", " ", "Infinity"}], ",", " ", "\n", "    ", 
      RowBox[{"bmax", " ", "=", " ", 
       RowBox[{"-", "Infinity"}]}], ",", " ", 
      RowBox[{"tests", " ", "=", " ", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", " ", "y"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"u2g", "[", "xub", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
        RowBox[{
         RowBox[{"u2g", "[", "yub", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";", " ", "\n", "    ", 
     RowBox[{"tests", " ", "=", " ", 
      RowBox[{"Tuples", "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", " ", "y"}], "}"}], "]"}]}], ";", " ", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"i", " ", "<=", " ", "2"}], ",", " ", 
       RowBox[{"i", "++"}], ",", " ", "\n", "     ", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"j", " ", "<=", " ", "2"}], ",", " ", 
         RowBox[{"j", "++"}], ",", " ", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"s", " ", "=", " ", "1"}], ",", " ", 
           RowBox[{"s", " ", ">=", " ", 
            RowBox[{"-", "1"}]}], ",", " ", 
           RowBox[{"s", " ", "-=", " ", "2"}], ",", " ", "\n", "       ", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", 
               RowBox[{"s", "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"y", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "/", 
                  RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], " ", "<", " ", 
               RowBox[{"x", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", "\n", "         ", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"tests", ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"s", "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"y", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", " ", 
                  RowBox[{"y", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
            ";", " ", "\n", "        ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", 
               RowBox[{"s", "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"x", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "/", 
                  RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], " ", "<", " ", 
               RowBox[{"y", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", "\n", "         ", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"tests", ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"x", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
                  RowBox[{"s", "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}]}], "}"}]}], 
               "]"}]}], "]"}], ";", " ", "\n", "        ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", 
               RowBox[{"s", "*", 
                RowBox[{"y", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "*", 
                RowBox[{"Sqrt", "[", "2", "]"}]}], " ", "<", " ", 
               RowBox[{"x", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", "\n", "         ", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"tests", ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"s", "*", 
                   RowBox[{"y", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "*", 
                   RowBox[{"Sqrt", "[", "2", "]"}]}], ",", " ", 
                  RowBox[{"y", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
            ";", " ", "\n", "        ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", 
               RowBox[{"s", "*", 
                RowBox[{"x", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "*", 
                RowBox[{"Sqrt", "[", "2", "]"}]}], " ", "<", " ", 
               RowBox[{"y", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", "\n", "         ", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"tests", ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"x", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
                  RowBox[{"s", "*", 
                   RowBox[{"x", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "*", 
                   RowBox[{"Sqrt", "[", "2", "]"}]}]}], "}"}]}], "]"}]}], 
             "]"}]}]}], "]"}]}], "]"}]}], "]"}], ";", " ", "\n", "    ", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"i", " ", "<=", " ", 
        RowBox[{"Length", "[", "tests", "]"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", " ", "\n", "     ", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", " ", "b"}], "}"}], " ", "=", " ", 
         RowBox[{"acc", "[", 
          RowBox[{"tests", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"amin", ",", " ", "amax"}], "}"}], " ", "=", " ", "\n", 
         "       ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{"a", ",", " ", "amin"}], "]"}], ",", " ", 
           RowBox[{"Max", "[", 
            RowBox[{"a", ",", " ", "amax"}], "]"}]}], "}"}]}], ";", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"bmin", ",", " ", "bmax"}], "}"}], " ", "=", " ", "\n", 
         "       ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{"b", ",", " ", "bmin"}], "]"}], ",", " ", 
           RowBox[{"Max", "[", 
            RowBox[{"b", ",", " ", "bmax"}], "]"}]}], "}"}]}]}]}], "]"}], ";",
      " ", "\n", "    ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"amin", " ", "==", " ", "0"}], " ", "&&", " ", 
        RowBox[{"inexQ", "[", 
         RowBox[{"xub", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "&&", " ", 
        RowBox[{"inexQ", "[", 
         RowBox[{"xub", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}], ",", " ", "\n", "     ", 
       RowBox[{"amin", " ", "+=", " ", 
        RowBox[{"smallsubnormal", "/", "2"}]}]}], "]"}], ";", " ", "\n", 
     "    ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"bmin", " ", "==", " ", "0"}], " ", "&&", " ", 
        RowBox[{"inexQ", "[", 
         RowBox[{"yub", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "&&", " ", 
        RowBox[{"inexQ", "[", 
         RowBox[{"yub", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}], ",", " ", "\n", "     ", 
       RowBox[{"bmin", " ", "+=", " ", 
        RowBox[{"smallsubnormal", "/", "2"}]}]}], "]"}], ";", " ", "\n", 
     "    ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"amax", " ", "==", " ", "0"}], " ", "&&", " ", 
        RowBox[{"inexQ", "[", 
         RowBox[{"xub", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "&&", " ", 
        RowBox[{"inexQ", "[", 
         RowBox[{"xub", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}], ",", " ", "\n", "     ", 
       RowBox[{"amax", " ", "-=", " ", 
        RowBox[{"smallsubnormal", "/", "2"}]}]}], "]"}], ";", " ", "\n", 
     "    ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"bmax", " ", "==", " ", "0"}], " ", "&&", " ", 
        RowBox[{"inexQ", "[", 
         RowBox[{"yub", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "&&", " ", 
        RowBox[{"inexQ", "[", 
         RowBox[{"yub", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}], ",", " ", "\n", "     ", 
       RowBox[{"bmax", " ", "-=", " ", 
        RowBox[{"smallsubnormal", "/", "2"}]}]}], "]"}], ";", " ", "\n", 
     "    ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x2u", "[", "amin", "]"}], ",", " ", 
         RowBox[{"x2u", "[", "amax", "]"}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x2u", "[", "bmin", "]"}], ",", " ", "\n", "      ", 
         RowBox[{"x2u", "[", "bmax", "]"}]}], "}"}]}], "}"}]}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"guessu", "[", 
   RowBox[{"x_", " ", "/;", " ", 
    RowBox[{
     RowBox[{"uQ", "[", "x", "]"}], " ", "||", " ", 
     RowBox[{"gQ", "[", "x", "]"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", " ", "b", ",", " ", "g", ",", " ", "gu"}], "}"}], ",", 
    " ", "\n", "   ", 
    RowBox[{
     RowBox[{"g", " ", "=", " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"uQ", "[", "x", "]"}], ",", " ", 
        RowBox[{"u2g", "[", "x", "]"}], ",", " ", 
        RowBox[{"u2g", "[", 
         RowBox[{"g2u", "[", "x", "]"}], "]"}]}], "]"}]}], ";", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", " ", "b"}], "}"}], " ", "=", " ", 
      RowBox[{"g", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", "\n", "    ", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"a", " ", "===", " ", "NaN"}], " ", "||", " ", 
        RowBox[{"b", " ", "===", " ", "NaN"}]}], ",", " ", "qNaNu", ",", " ", 
       
       RowBox[{"a", " ", "==", " ", "b"}], ",", " ", 
       RowBox[{"x2u", "[", "a", "]"}], ",", " ", "\n", "     ", 
       RowBox[{
        RowBox[{"a", " ", "==", " ", 
         RowBox[{"-", "Infinity"}]}], " ", "&&", " ", 
        RowBox[{"b", " ", "==", " ", "Infinity"}]}], ",", " ", 
       RowBox[{"x2u", "[", "0", "]"}], ",", " ", "True", ",", " ", "\n", 
       "     ", 
       RowBox[{
        RowBox[{"gu", " ", "=", " ", 
         RowBox[{"x2u", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a", " ", "+", " ", "b"}], ")"}], "/", "2"}], "]"}]}], 
        ";", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"exQ", "[", "gu", "]"}], ",", " ", "gu", ",", " ", "\n", 
          "       ", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"BitAnd", "[", 
               RowBox[{"ulpu", ",", " ", "gu"}], "]"}], " ", "==", " ", "0"}],
              ",", " ", 
             RowBox[{"gu", " ", "=", " ", 
              RowBox[{"gu", " ", "-", " ", "ubitmask"}]}], ",", " ", "\n", 
             "         ", 
             RowBox[{"gu", " ", "=", " ", 
              RowBox[{"gu", " ", "+", " ", "ubitmask"}]}]}], "]"}], ";", " ", 
           
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"fsize", "[", "gu", "]"}], " ", "==", " ", "1"}], ",", 
             " ", "gu", ",", " ", "\n", "         ", 
             RowBox[{
              RowBox[{"BitShiftRight", "[", 
               RowBox[{
                RowBox[{"BitAnd", "[", 
                 RowBox[{
                  RowBox[{"floatmask", "[", "gu", "]"}], ",", " ", "gu"}], 
                 "]"}], ",", " ", "1"}], "]"}], " ", "+", " ", "\n", 
              "          ", 
              RowBox[{"BitAnd", "[", 
               RowBox[{"efsizemask", ",", " ", "gu"}], "]"}], " ", "-", " ", 
              "1"}]}], "]"}]}]}], "]"}]}]}], "]"}]}]}], "]"}]}]}], "Input",
 CellMargins->{{49, Inherited}, {1, 1}},
 InitializationCell->True,
 CellChangeTimes->{{3.5976958099373293`*^9, 3.597695955767931*^9}, {
   3.597696833449402*^9, 3.5976968446299887`*^9}, {3.597697069473584*^9, 
   3.5976971589154243`*^9}, {3.597697224909829*^9, 3.597697279629113*^9}, {
   3.5976973103543777`*^9, 3.597697323625346*^9}, {3.597697362240232*^9, 
   3.597697398436123*^9}, {3.597697438265224*^9, 3.597697488774225*^9}, {
   3.597697603273212*^9, 3.597697605937132*^9}, {3.5976977025696487`*^9, 
   3.597697706026922*^9}, {3.59769792075701*^9, 3.597697937038663*^9}, {
   3.5977762627276278`*^9, 3.597776285928898*^9}, 3.597776359396861*^9, {
   3.597776417570751*^9, 3.597776432836018*^9}, {3.597776746640239*^9, 
   3.5977767507268476`*^9}, {3.598014571650226*^9, 3.598014590315401*^9}, {
   3.5994811967188473`*^9, 3.599481197132647*^9}, 3.5998517516562023`*^9, {
   3.600179277942041*^9, 3.600179482976729*^9}, 3.603320462101651*^9, {
   3.603411184855798*^9, 3.603411229406357*^9}, {3.603411399626895*^9, 
   3.603411407597744*^9}, {3.60341550464825*^9, 3.603415528838421*^9}, 
   3.604056276862027*^9, {3.6043261886335382`*^9, 3.6043261898426733`*^9}, 
   3.604336685212072*^9, {3.6044185866271553`*^9, 3.604418587988509*^9}, {
   3.604503482451619*^9, 3.604503483544044*^9}, {3.60450357326105*^9, 
   3.604503586958527*^9}, {3.604520655736071*^9, 3.604520656975197*^9}, {
   3.604591569842341*^9, 3.6045915755497017`*^9}, {3.6045918208542337`*^9, 
   3.60459184261489*^9}, {3.604666879674808*^9, 3.6046668805933533`*^9}, {
   3.6046855761451807`*^9, 3.604685645010165*^9}, {3.6046856867967157`*^9, 
   3.604685707328291*^9}, {3.60468585786488*^9, 3.604685861492653*^9}, {
   3.604686330385666*^9, 3.604686444263685*^9}, {3.6046865206445627`*^9, 
   3.604686532509901*^9}, {3.604686857206109*^9, 3.604686860054008*^9}, {
   3.604686896093343*^9, 3.604686907475502*^9}, {3.604686958887898*^9, 
   3.604686963612947*^9}, {3.604687131247023*^9, 3.604687135306019*^9}, {
   3.604751925750133*^9, 3.604751927178096*^9}, {3.6050108058279*^9, 
   3.605010808785841*^9}, {3.605045457342491*^9, 3.605045465224684*^9}, {
   3.605094590708828*^9, 3.605094592377616*^9}, {3.605095415223381*^9, 
   3.6050954160445147`*^9}, {3.605124324246029*^9, 3.605124325961299*^9}, {
   3.605124480488859*^9, 3.605124480874053*^9}, {3.605125457978444*^9, 
   3.605125460353622*^9}, {3.605187625146166*^9, 3.605187660252552*^9}, {
   3.605187842932446*^9, 3.605187895674843*^9}, {3.605368365454031*^9, 
   3.6053683726232767`*^9}, {3.6056541865264177`*^9, 3.60565418923637*^9}, 
   3.6056543397926407`*^9, {3.605654430433793*^9, 3.605654578755246*^9}, {
   3.605654752048513*^9, 3.605654816577523*^9}, {3.605654856087483*^9, 
   3.6056548613155622`*^9}, {3.605654894188671*^9, 3.605654909486768*^9}, {
   3.605654963911779*^9, 3.605654967899617*^9}, {3.605655228464868*^9, 
   3.605655232285729*^9}, {3.6057153768860693`*^9, 3.605715379049172*^9}, 
   3.605717009478923*^9, {3.605721150709525*^9, 3.6057211521362457`*^9}, {
   3.606503779489015*^9, 3.606503798173559*^9}, {3.6065038988928833`*^9, 
   3.606503932461443*^9}, {3.606566514571494*^9, 3.606566516686824*^9}, {
   3.606674593907366*^9, 3.6066745974230347`*^9}, {3.607189768766015*^9, 
   3.607189769910845*^9}, {3.6072680737946463`*^9, 3.607268075048189*^9}, {
   3.6073472993706913`*^9, 3.607347316542824*^9}, {3.607347350630279*^9, 
   3.60734736444543*^9}, {3.607380750298209*^9, 3.60738075224014*^9}, {
   3.607433169447605*^9, 3.607433183419607*^9}, {3.60745750152977*^9, 
   3.607457503047138*^9}, 3.607719534817171*^9, {3.607774916864558*^9, 
   3.607774935064733*^9}, {3.608125934118959*^9, 3.608125935482555*^9}, {
   3.608151636120832*^9, 3.608151636981532*^9}, {3.6081521402231007`*^9, 
   3.608152141533711*^9}, {3.608493497117399*^9, 3.608493574229596*^9}, {
   3.608493629029714*^9, 3.608493698303852*^9}, {3.608555113461837*^9, 
   3.60855511386449*^9}, {3.60865247097536*^9, 3.608652555591466*^9}, {
   3.608652639244137*^9, 3.6086527254145193`*^9}, {3.608652771505556*^9, 
   3.608652796190501*^9}, {3.608653064174271*^9, 3.608653066931101*^9}, 
   3.6086538136639357`*^9, {3.608654045320537*^9, 3.608654074424069*^9}, {
   3.609182880338707*^9, 3.6091829422978277`*^9}, {3.609246181900494*^9, 
   3.609246207659978*^9}, {3.60924629315694*^9, 3.609246294235076*^9}, 
   3.6092464507131357`*^9, {3.609246495277104*^9, 3.609246593162719*^9}, {
   3.609246847122067*^9, 3.609246871841473*^9}, {3.60924696828493*^9, 
   3.609246969277253*^9}, {3.609276034237473*^9, 3.6092760369285316`*^9}, {
   3.6092765718056803`*^9, 3.609276578373947*^9}, {3.6092766480419407`*^9, 
   3.6092766491481657`*^9}, 3.609282179778225*^9, {3.609506128249673*^9, 
   3.609506129416985*^9}, {3.609511364681108*^9, 3.609511371935772*^9}, 
   3.609511412456106*^9, {3.6095244159169416`*^9, 3.609524417253327*^9}, {
   3.609587297330311*^9, 3.609587320045684*^9}, {3.6095875165579023`*^9, 
   3.609587519216799*^9}, {3.6096351914808292`*^9, 3.609635192844522*^9}, {
   3.6096700764440928`*^9, 3.609670077746284*^9}, {3.609678628382758*^9, 
   3.609678630252602*^9}, {3.609705608201195*^9, 3.609705609113388*^9}, {
   3.6097643763663197`*^9, 3.60976438066451*^9}, {3.609889349756092*^9, 
   3.609889350210252*^9}, {3.609895018069322*^9, 3.6098950185471163`*^9}, {
   3.610017244917841*^9, 3.610017288645793*^9}, {3.61001761750414*^9, 
   3.610017618414611*^9}, {3.610019564015362*^9, 3.610019564956553*^9}, {
   3.614808352639247*^9, 3.614808353061212*^9}, 3.6148198990290747`*^9, {
   3.614875673740773*^9, 3.614875676530698*^9}, {3.6148757181333723`*^9, 
   3.614875722969026*^9}, 3.614878985119224*^9, {3.6148790547448997`*^9, 
   3.614879055455572*^9}, 3.61488273970864*^9, {3.614882859569977*^9, 
   3.614882860886859*^9}, 3.614882894664467*^9, 3.614882950852641*^9, {
   3.614883026654097*^9, 3.6148830351842937`*^9}, {3.614887740797943*^9, 
   3.614887743514019*^9}, {3.6149389188475323`*^9, 3.6149389527419252`*^9}, {
   3.615533966049438*^9, 3.615533967133569*^9}, {3.6162742866537733`*^9, 
   3.616274287236598*^9}, {3.616362991377479*^9, 3.616362992532712*^9}, {
   3.61645419410081*^9, 3.616454200534967*^9}, 3.6165115176597958`*^9, {
   3.616627091141384*^9, 3.616627091598083*^9}, {3.6166280552930613`*^9, 
   3.6166280620510178`*^9}, 3.616935753742484*^9, {3.61697654453377*^9, 
   3.616976545873095*^9}, {3.616976590966572*^9, 3.6169766164934597`*^9}, 
   3.616976702470334*^9, {3.6169767387057953`*^9, 3.616976871955429*^9}, {
   3.616976978693242*^9, 3.6169771214870863`*^9}, {3.616977196076816*^9, 
   3.616977204770501*^9}, {3.6169772778250504`*^9, 3.61697741228821*^9}, {
   3.616977504503986*^9, 3.6169776877132998`*^9}, {3.616977768461803*^9, 
   3.616977835594149*^9}, {3.616979276767221*^9, 3.616979769224681*^9}, {
   3.617006796146542*^9, 3.617006849339313*^9}, {3.6170068817497253`*^9, 
   3.6170069086834383`*^9}, {3.617006946138649*^9, 3.617007101824719*^9}, {
   3.6170640241565332`*^9, 3.617064025232169*^9}, {3.617120043044022*^9, 
   3.617120045552047*^9}, {3.617120115047872*^9, 3.617120194580267*^9}, {
   3.639250156822136*^9, 3.6392501579731474`*^9}, {3.639250236043947*^9, 
   3.6392502366939535`*^9}, {3.639251045787886*^9, 3.639251045867887*^9}, {
   3.6392511215046625`*^9, 3.639251145474907*^9}, {3.639307707697789*^9, 
   3.6393077087478*^9}, {3.639307746474184*^9, 3.639307747194191*^9}, {
   3.6393078397751303`*^9, 3.6393078406251388`*^9}, {3.6393078929756722`*^9, 
   3.639307917534922*^9}, {3.639308070006472*^9, 3.6393080700764728`*^9}, {
   3.6393081395561757`*^9, 3.639308139586176*^9}, {3.6393081816276073`*^9, 
   3.6393081816576076`*^9}, {3.6393095082725763`*^9, 
   3.6393095605091057`*^9}, {3.6393095944694543`*^9, 
   3.6393096338378553`*^9}, {3.6393096855613785`*^9, 3.639309732183857*^9}, {
   3.6393134366628995`*^9, 3.6393134369929028`*^9}, 3.642794026500247*^9, {
   3.642794099204185*^9, 3.642794114003457*^9}, {3.642794335886647*^9, 
   3.642794336014841*^9}},
 FormatType->"InputForm"],

Cell[BoxData[
 RowBox[{"setenv", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "3"}], "}"}], "]"}]], "Input",
 CellFrame->{{0, 0}, {0, 3}},
 CellChangeTimes->{{3.637413014941533*^9, 3.637413053989936*^9}, {
   3.637413112237523*^9, 3.6374131126775274`*^9}, {3.6374132675680943`*^9, 
   3.637413268498103*^9}, {3.6374133029104495`*^9, 3.637413336907793*^9}, 
   3.6391649801606874`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"autoN", "[", "NaN", "]"}], "\[IndentingNewLine]", 
 RowBox[{"autoN", "[", "Infinity", "]"}], "\[IndentingNewLine]", 
 RowBox[{"autoN", "[", "0.0", "]"}], "\[IndentingNewLine]", 
 RowBox[{"autoN", "[", 
  RowBox[{"1", "/", "16"}], "]"}]}], "Input",
 CellChangeTimes->{{3.641242170926773*^9, 3.641242308390427*^9}, {
  3.641242345924972*^9, 3.641242375203198*^9}, {3.64124279126744*^9, 
  3.641242797595248*^9}}],

Cell[BoxData["Indeterminate"], "Output",
 CellChangeTimes->{{3.641242219110106*^9, 3.6412422562780027`*^9}, {
   3.641242288140469*^9, 3.641242309910345*^9}, {3.641242353562621*^9, 
   3.641242378860835*^9}, 3.641242800507125*^9, 3.6427942798130503`*^9}],

Cell[BoxData["\[Infinity]"], "Output",
 CellChangeTimes->{{3.641242219110106*^9, 3.6412422562780027`*^9}, {
   3.641242288140469*^9, 3.641242309910345*^9}, {3.641242353562621*^9, 
   3.641242378860835*^9}, 3.641242800507125*^9, 3.642794279820354*^9}],

Cell[BoxData["0.`"], "Output",
 CellChangeTimes->{{3.641242219110106*^9, 3.6412422562780027`*^9}, {
   3.641242288140469*^9, 3.641242309910345*^9}, {3.641242353562621*^9, 
   3.641242378860835*^9}, 3.641242800507125*^9, 3.642794279826844*^9}],

Cell[BoxData[
 TemplateBox[{"0","\".\"","\"0625\""},
  "RowDefault"]], "Output",
 CellChangeTimes->{{3.641242219110106*^9, 3.6412422562780027`*^9}, {
   3.641242288140469*^9, 3.641242309910345*^9}, {3.641242353562621*^9, 
   3.641242378860835*^9}, 3.641242800507125*^9, 3.642794279833721*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"uview", "[", 
  RowBox[{"x2u", "[", "17", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6374133387878113`*^9, 3.637413344399868*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     ItemBox[
      StyleBox["0", "Input",
       StripOnInput->False,
       LineColor->RGBColor[1, 0, 0],
       FrontFaceColor->RGBColor[1, 0, 0],
       BackFaceColor->RGBColor[1, 0, 0],
       GraphicsColor->RGBColor[1, 0, 0],
       FontColor->RGBColor[1, 0, 0]],
      Alignment->"Left",
      Frame->True,
      StripOnInput->False], 
     ItemBox[
      StyleBox["\<\"111\"\>", "Input",
       StripOnInput->False,
       LineColor->RGBColor[0.25, 0.5, 1],
       FrontFaceColor->RGBColor[0.25, 0.5, 1],
       BackFaceColor->RGBColor[0.25, 0.5, 1],
       GraphicsColor->RGBColor[0.25, 0.5, 1],
       FontColor->RGBColor[0.25, 0.5, 1]],
      Frame->True,
      StripOnInput->False], "\<\"\[ThinSpace]\"\>", 
     ItemBox[
      StyleBox["\<\"0001\"\>", "Input",
       StripOnInput->False],
      Frame->"True",
      StripOnInput->False], 
     ItemBox[
      StyleBox["0", "Input",
       StripOnInput->False,
       LineColor->RGBColor[1, 0, 1],
       FrontFaceColor->RGBColor[1, 0, 1],
       BackFaceColor->RGBColor[1, 0, 1],
       GraphicsColor->RGBColor[1, 0, 1],
       FontWeight->Plain,
       FontSlant->Plain,
       FontVariations->{"Underline"->False},
       FontColor->RGBColor[1, 0, 1]],
      Frame->"True",
      StripOnInput->False], 
     ItemBox[
      StyleBox["\<\"10\"\>", "Input",
       StripOnInput->False,
       LineColor->RGBColor[0, 0.75, 0],
       FrontFaceColor->RGBColor[0, 0.75, 0],
       BackFaceColor->RGBColor[0, 0.75, 0],
       GraphicsColor->RGBColor[0, 0.75, 0],
       FontWeight->Plain,
       FontSlant->Plain,
       FontVariations->{"Underline"->False},
       FontColor->RGBColor[0, 0.75, 0]],
      Frame->True,
      StripOnInput->False], 
     ItemBox[
      StyleBox["\<\"011\"\>", "Input",
       StripOnInput->False,
       FontWeight->Plain,
       FontSlant->Plain,
       FontVariations->{"Underline"->False},
       FontColor->GrayLevel[0.5]],
      Frame->True,
      StripOnInput->False], "\<\"\[ThinSpace]\"\>", 
     TemplateBox[{
      ItemBox["\" \"", StripOnInput -> False],ItemBox[
       "\" \"", StripOnInput -> False]},
      "RowDefault"]},
    {
     StyleBox["\<\"+\"\>",
      StripOnInput->False,
      LineColor->RGBColor[1, 0, 0],
      FrontFaceColor->RGBColor[1, 0, 0],
      BackFaceColor->RGBColor[1, 0, 0],
      GraphicsColor->RGBColor[1, 0, 0],
      FontColor->RGBColor[1, 0, 0]], 
     StyleBox[
      InterpretationBox["\<\"\\!\\(\\*TemplateBox[List[\\\"2\\\", \\\"4\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\[Times]\"\>",
       StringForm["``\[Times]", 
        Superscript[2, 4]],
       Editable->False],
      StripOnInput->False,
      LineColor->RGBColor[0.25, 0.5, 1],
      FrontFaceColor->RGBColor[0.25, 0.5, 1],
      BackFaceColor->RGBColor[0.25, 0.5, 1],
      GraphicsColor->RGBColor[0.25, 0.5, 1],
      FontColor->RGBColor[0.25, 0.5, 1]], 
     InterpretationBox["\<\"\[NegativeThickSpace]\\!\\(1\\)+\
\[NegativeThickSpace]\[NegativeThickSpace]\"\>",
      StringForm[
      "\[NegativeThickSpace]``+\[NegativeThickSpace]\[NegativeThickSpace]", 1],
      Editable->False], 
     TagBox[
      FractionBox["1", "16"],
      DisplayForm], 
     StyleBox["\<\"\[DownArrow]\"\>",
      StripOnInput->False,
      LineColor->RGBColor[1, 0, 1],
      FrontFaceColor->RGBColor[1, 0, 1],
      BackFaceColor->RGBColor[1, 0, 1],
      GraphicsColor->RGBColor[1, 0, 1],
      FontColor->RGBColor[1, 0, 1]], 
     StyleBox["3",
      StripOnInput->False,
      LineColor->RGBColor[0, 0.75, 0],
      FrontFaceColor->RGBColor[0, 0.75, 0],
      BackFaceColor->RGBColor[0, 0.75, 0],
      GraphicsColor->RGBColor[0, 0.75, 0],
      FontColor->RGBColor[0, 0.75, 0]], 
     StyleBox["4",
      StripOnInput->False,
      LineColor->GrayLevel[0.5],
      FrontFaceColor->GrayLevel[0.5],
      BackFaceColor->GrayLevel[0.5],
      GraphicsColor->GrayLevel[0.5],
      FontColor->GrayLevel[0.5]], "\<\"\[ThinSpace]\"\>", 
     TemplateBox[{"\"= \"","\"17\""},
      "RowDefault"]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
   GridBoxItemStyle->{
    "Columns" -> {{Automatic}}, "RowsIndexed" -> {2 -> {"Text", 12}}, 
     "ItemsIndexed" -> {{1, 9} -> "Text"}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.6374133472998967`*^9, 3.639164994776836*^9, 3.639249337751563*^9, 
   3.6392494113813066`*^9, 3.639249585100313*^9, 3.639249722664714*^9, {
   3.6392497618131104`*^9, 3.6392498409609227`*^9}, 3.639249894931471*^9, 
   3.6392499426159573`*^9, {3.6392500218997617`*^9, 3.639250043304982*^9}, 
   3.6392501701572733`*^9, 3.6392502489640784`*^9, 3.639251049977929*^9, 
   3.6392512570610437`*^9, 3.639307476600202*^9, 3.639307719315908*^9, 
   3.639307754778267*^9, 3.63930784573219*^9, {3.6393078852585936`*^9, 
   3.639307922456973*^9}, 3.6393079558963137`*^9, 3.6393079873866343`*^9, {
   3.6393080809995823`*^9, 3.6393081020027943`*^9}, 3.639308143856224*^9, 
   3.6393091447586575`*^9, 3.639309570623209*^9, 3.639309742405963*^9, 
   3.6393104069263396`*^9, 3.6393122608281927`*^9, 3.6393134436919928`*^9, 
   3.6393135456597404`*^9, 3.641207414370866*^9, 3.6427942801356573`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"n", " ", "=", " ", 
  RowBox[{
   RowBox[{"x2u", "[", "17", "]"}], " ", "\[CirclePlus]", " ", 
   RowBox[{"x2u", "[", "1", "]"}]}]}], "\n", 
 RowBox[{"unumQ", "[", "n", "]"}], "\n", 
 RowBox[{"uboundQ", "[", "n", "]"}], "\n", 
 RowBox[{"gQ", "[", "n", "]"}], "\n", 
 RowBox[{"uview", "[", "n", "]"}]}], "Input",
 CellChangeTimes->{{3.637413443977887*^9, 3.637413451597964*^9}, 
   3.639162081883522*^9, 3.6392511072835197`*^9, 3.639308096017734*^9, {
   3.642794188395321*^9, 3.642794221954925*^9}, 3.642794335569027*^9}],

Cell[BoxData[
 RowBox[{"{", "3666", "}"}]], "Output",
 CellChangeTimes->{
  3.6374134551260014`*^9, 3.6392493379415655`*^9, 3.639249411421307*^9, 
   3.6392495851503134`*^9, 3.6392497227247148`*^9, {3.6392497618531103`*^9, 
   3.639249840990923*^9}, 3.6392498949614706`*^9, 3.639249943245964*^9, {
   3.639250022099764*^9, 3.639250043354983*^9}, 3.639250170187274*^9, 
   3.639250249004079*^9, 3.639251049997929*^9, 3.6392512570910444`*^9, 
   3.6393074766402025`*^9, 3.639307719345908*^9, 3.639307754838268*^9, 
   3.639307845762191*^9, {3.639307885288594*^9, 3.639307922486974*^9}, 
   3.639307955916314*^9, 3.6393079874166346`*^9, {3.6393080810495825`*^9, 
   3.639308102032795*^9}, 3.6393081438862247`*^9, 3.639309144798658*^9, 
   3.6393095706532097`*^9, 3.639309742435963*^9, 3.6393104069583426`*^9, 
   3.6393122608611956`*^9, 3.6393134437219934`*^9, 3.639313545699741*^9, 
   3.641207415263829*^9, 3.6427942809780416`*^9}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{
  3.6374134551260014`*^9, 3.6392493379415655`*^9, 3.639249411421307*^9, 
   3.6392495851503134`*^9, 3.6392497227247148`*^9, {3.6392497618531103`*^9, 
   3.639249840990923*^9}, 3.6392498949614706`*^9, 3.639249943245964*^9, {
   3.639250022099764*^9, 3.639250043354983*^9}, 3.639250170187274*^9, 
   3.639250249004079*^9, 3.639251049997929*^9, 3.6392512570910444`*^9, 
   3.6393074766402025`*^9, 3.639307719345908*^9, 3.639307754838268*^9, 
   3.639307845762191*^9, {3.639307885288594*^9, 3.639307922486974*^9}, 
   3.639307955916314*^9, 3.6393079874166346`*^9, {3.6393080810495825`*^9, 
   3.639308102032795*^9}, 3.6393081438862247`*^9, 3.639309144798658*^9, 
   3.6393095706532097`*^9, 3.639309742435963*^9, 3.6393104069583426`*^9, 
   3.6393122608611956`*^9, 3.6393134437219934`*^9, 3.639313545699741*^9, 
   3.641207415263829*^9, 3.642794280985526*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6374134551260014`*^9, 3.6392493379415655`*^9, 3.639249411421307*^9, 
   3.6392495851503134`*^9, 3.6392497227247148`*^9, {3.6392497618531103`*^9, 
   3.639249840990923*^9}, 3.6392498949614706`*^9, 3.639249943245964*^9, {
   3.639250022099764*^9, 3.639250043354983*^9}, 3.639250170187274*^9, 
   3.639250249004079*^9, 3.639251049997929*^9, 3.6392512570910444`*^9, 
   3.6393074766402025`*^9, 3.639307719345908*^9, 3.639307754838268*^9, 
   3.639307845762191*^9, {3.639307885288594*^9, 3.639307922486974*^9}, 
   3.639307955916314*^9, 3.6393079874166346`*^9, {3.6393080810495825`*^9, 
   3.639308102032795*^9}, 3.6393081438862247`*^9, 3.639309144798658*^9, 
   3.6393095706532097`*^9, 3.639309742435963*^9, 3.6393104069583426`*^9, 
   3.6393122608611956`*^9, 3.6393134437219934`*^9, 3.639313545699741*^9, 
   3.641207415263829*^9, 3.642794280993561*^9}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{
  3.6374134551260014`*^9, 3.6392493379415655`*^9, 3.639249411421307*^9, 
   3.6392495851503134`*^9, 3.6392497227247148`*^9, {3.6392497618531103`*^9, 
   3.639249840990923*^9}, 3.6392498949614706`*^9, 3.639249943245964*^9, {
   3.639250022099764*^9, 3.639250043354983*^9}, 3.639250170187274*^9, 
   3.639250249004079*^9, 3.639251049997929*^9, 3.6392512570910444`*^9, 
   3.6393074766402025`*^9, 3.639307719345908*^9, 3.639307754838268*^9, 
   3.639307845762191*^9, {3.639307885288594*^9, 3.639307922486974*^9}, 
   3.639307955916314*^9, 3.6393079874166346`*^9, {3.6393080810495825`*^9, 
   3.639308102032795*^9}, 3.6393081438862247`*^9, 3.639309144798658*^9, 
   3.6393095706532097`*^9, 3.639309742435963*^9, 3.6393104069583426`*^9, 
   3.6393122608611956`*^9, 3.6393134437219934`*^9, 3.639313545699741*^9, 
   3.641207415263829*^9, 3.6427942810010138`*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     ItemBox[
      StyleBox["0", "Input",
       StripOnInput->False,
       LineColor->RGBColor[1, 0, 0],
       FrontFaceColor->RGBColor[1, 0, 0],
       BackFaceColor->RGBColor[1, 0, 0],
       GraphicsColor->RGBColor[1, 0, 0],
       FontColor->RGBColor[1, 0, 0]],
      Alignment->"Left",
      Frame->True,
      StripOnInput->False], 
     ItemBox[
      StyleBox["\<\"111\"\>", "Input",
       StripOnInput->False,
       LineColor->RGBColor[0.25, 0.5, 1],
       FrontFaceColor->RGBColor[0.25, 0.5, 1],
       BackFaceColor->RGBColor[0.25, 0.5, 1],
       GraphicsColor->RGBColor[0.25, 0.5, 1],
       FontColor->RGBColor[0.25, 0.5, 1]],
      Frame->True,
      StripOnInput->False], "\<\"\[ThinSpace]\"\>", 
     ItemBox[
      StyleBox["\<\"001\"\>", "Input",
       StripOnInput->False],
      Frame->"True",
      StripOnInput->False], 
     ItemBox[
      StyleBox["0", "Input",
       StripOnInput->False,
       LineColor->RGBColor[1, 0, 1],
       FrontFaceColor->RGBColor[1, 0, 1],
       BackFaceColor->RGBColor[1, 0, 1],
       GraphicsColor->RGBColor[1, 0, 1],
       FontWeight->Plain,
       FontSlant->Plain,
       FontVariations->{"Underline"->False},
       FontColor->RGBColor[1, 0, 1]],
      Frame->"True",
      StripOnInput->False], 
     ItemBox[
      StyleBox["\<\"10\"\>", "Input",
       StripOnInput->False,
       LineColor->RGBColor[0, 0.75, 0],
       FrontFaceColor->RGBColor[0, 0.75, 0],
       BackFaceColor->RGBColor[0, 0.75, 0],
       GraphicsColor->RGBColor[0, 0.75, 0],
       FontWeight->Plain,
       FontSlant->Plain,
       FontVariations->{"Underline"->False},
       FontColor->RGBColor[0, 0.75, 0]],
      Frame->True,
      StripOnInput->False], 
     ItemBox[
      StyleBox["\<\"010\"\>", "Input",
       StripOnInput->False,
       FontWeight->Plain,
       FontSlant->Plain,
       FontVariations->{"Underline"->False},
       FontColor->GrayLevel[0.5]],
      Frame->True,
      StripOnInput->False], "\<\"\[ThinSpace]\"\>", 
     TemplateBox[{
      ItemBox["\" \"", StripOnInput -> False],ItemBox[
       "\" \"", StripOnInput -> False]},
      "RowDefault"]},
    {
     StyleBox["\<\"+\"\>",
      StripOnInput->False,
      LineColor->RGBColor[1, 0, 0],
      FrontFaceColor->RGBColor[1, 0, 0],
      BackFaceColor->RGBColor[1, 0, 0],
      GraphicsColor->RGBColor[1, 0, 0],
      FontColor->RGBColor[1, 0, 0]], 
     StyleBox[
      InterpretationBox["\<\"\\!\\(\\*TemplateBox[List[\\\"2\\\", \\\"4\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\[Times]\"\>",
       StringForm["``\[Times]", 
        Superscript[2, 4]],
       Editable->False],
      StripOnInput->False,
      LineColor->RGBColor[0.25, 0.5, 1],
      FrontFaceColor->RGBColor[0.25, 0.5, 1],
      BackFaceColor->RGBColor[0.25, 0.5, 1],
      GraphicsColor->RGBColor[0.25, 0.5, 1],
      FontColor->RGBColor[0.25, 0.5, 1]], 
     InterpretationBox["\<\"\[NegativeThickSpace]\\!\\(1\\)+\
\[NegativeThickSpace]\[NegativeThickSpace]\"\>",
      StringForm[
      "\[NegativeThickSpace]``+\[NegativeThickSpace]\[NegativeThickSpace]", 1],
      Editable->False], 
     TagBox[
      FractionBox["1", "8"],
      DisplayForm], 
     StyleBox["\<\"\[DownArrow]\"\>",
      StripOnInput->False,
      LineColor->RGBColor[1, 0, 1],
      FrontFaceColor->RGBColor[1, 0, 1],
      BackFaceColor->RGBColor[1, 0, 1],
      GraphicsColor->RGBColor[1, 0, 1],
      FontColor->RGBColor[1, 0, 1]], 
     StyleBox["3",
      StripOnInput->False,
      LineColor->RGBColor[0, 0.75, 0],
      FrontFaceColor->RGBColor[0, 0.75, 0],
      BackFaceColor->RGBColor[0, 0.75, 0],
      GraphicsColor->RGBColor[0, 0.75, 0],
      FontColor->RGBColor[0, 0.75, 0]], 
     StyleBox["3",
      StripOnInput->False,
      LineColor->GrayLevel[0.5],
      FrontFaceColor->GrayLevel[0.5],
      BackFaceColor->GrayLevel[0.5],
      GraphicsColor->GrayLevel[0.5],
      FontColor->GrayLevel[0.5]], "\<\"\[ThinSpace]\"\>", 
     TemplateBox[{"\"= \"","\"18\""},
      "RowDefault"]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
   GridBoxItemStyle->{
    "Columns" -> {{Automatic}}, "RowsIndexed" -> {2 -> {"Text", 12}}, 
     "ItemsIndexed" -> {{1, 9} -> "Text"}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.6374134551260014`*^9, 3.6392493379415655`*^9, 3.639249411421307*^9, 
   3.6392495851503134`*^9, 3.6392497227247148`*^9, {3.6392497618531103`*^9, 
   3.639249840990923*^9}, 3.6392498949614706`*^9, 3.639249943245964*^9, {
   3.639250022099764*^9, 3.639250043354983*^9}, 3.639250170187274*^9, 
   3.639250249004079*^9, 3.639251049997929*^9, 3.6392512570910444`*^9, 
   3.6393074766402025`*^9, 3.639307719345908*^9, 3.639307754838268*^9, 
   3.639307845762191*^9, {3.639307885288594*^9, 3.639307922486974*^9}, 
   3.639307955916314*^9, 3.6393079874166346`*^9, {3.6393080810495825`*^9, 
   3.639308102032795*^9}, 3.6393081438862247`*^9, 3.639309144798658*^9, 
   3.6393095706532097`*^9, 3.639309742435963*^9, 3.6393104069583426`*^9, 
   3.6393122608611956`*^9, 3.6393134437219934`*^9, 3.639313545699741*^9, 
   3.641207415263829*^9, 3.642794281011794*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"view", "[", 
  RowBox[{
   RowBox[{"x2u", "[", "17", "]"}], " ", "\[CircleMinus]", " ", 
   RowBox[{"x2u", "[", "1", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.637413480106253*^9, 3.6374134859953127`*^9}, 
   3.6392511072935195`*^9, 3.6393080960277343`*^9, 3.6427944976677723`*^9, 
   3.642794581077586*^9},
 FormatType->"InputForm"],

Cell[BoxData[
 StyleBox["\<\"16\"\>", "Text",
  StripOnInput->False]], "Output",
 CellChangeTimes->{
  3.637413490175355*^9, 3.6392494114313073`*^9, 3.6392495852103143`*^9, 
   3.6392497227447147`*^9, {3.6392497618931108`*^9, 3.639249841030924*^9}, 
   3.6392498950014715`*^9, 3.639249943465966*^9, {3.639250022279765*^9, 
   3.6392500434249835`*^9}, 3.639250170227274*^9, 3.639250249034079*^9, 
   3.63925105004793*^9, 3.639251257131045*^9, 3.6393074766902027`*^9, 
   3.639307719395909*^9, 3.6393077548782682`*^9, 3.6393078458021913`*^9, {
   3.6393078853485947`*^9, 3.639307922516974*^9}, 3.639307955966315*^9, 
   3.639307987456635*^9, {3.639308081099583*^9, 3.639308102072795*^9}, 
   3.6393081439162245`*^9, 3.6393091448486586`*^9, 3.6393095706732097`*^9, 
   3.6393097424759636`*^9, 3.639310406997347*^9, 3.639312260896199*^9, 
   3.6393134437619934`*^9, 3.639313545719741*^9, 3.6412074155416107`*^9, 
   3.642794281148814*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"view", "[", 
  RowBox[{
   RowBox[{"x2u", "[", "17", "]"}], " ", "\[CircleMinus]", " ", 
   RowBox[{"x2u", "[", "1", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6374135032034864`*^9, 3.6374135059735146`*^9}, 
   3.6392511072935195`*^9, 3.6393080960377345`*^9, 3.6427944822496643`*^9, 
   3.6427945823261223`*^9},
 FormatType->"InputForm"],

Cell[BoxData[
 StyleBox["\<\"16\"\>", "Text",
  StripOnInput->False]], "Output",
 CellChangeTimes->{
  3.637413538672844*^9, 3.639249411441307*^9, 3.6392495852303143`*^9, 
   3.639249722764715*^9, {3.6392497619131107`*^9, 3.6392498410609236`*^9}, 
   3.6392498950114717`*^9, 3.6392499436959686`*^9, {3.6392500224597673`*^9, 
   3.6392500434449835`*^9}, 3.6392501702472744`*^9, 3.639250249054079*^9, 
   3.63925105007793*^9, 3.639251257151045*^9, 3.639307476710203*^9, 
   3.639307719425909*^9, 3.6393077548982687`*^9, 3.639307845822191*^9, {
   3.6393078853585944`*^9, 3.639307922536974*^9}, 3.639307955986315*^9, 
   3.639307987476635*^9, {3.6393080811195836`*^9, 3.6393081021027956`*^9}, 
   3.639308143936225*^9, 3.639309144878659*^9, 3.6393095706932096`*^9, 
   3.639309742495964*^9, 3.639310407027348*^9, 3.639312260914201*^9, 
   3.639313443781994*^9, 3.6393135457397413`*^9, 3.641207415928912*^9, 
   3.642794281307228*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"view", "[", 
  RowBox[{
   RowBox[{"x2u", "[", "0", "]"}], " ", "\[CircleDot]", " ", 
   RowBox[{"x2u", "[", "0", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.637413557818037*^9, 3.6374135768382287`*^9}, {
   3.6374136439799075`*^9, 3.637413665842139*^9}, {3.639251045867887*^9, 
   3.6392510458778872`*^9}, {3.6393080700864725`*^9, 3.6393080700864725`*^9}, 
   3.642794490269471*^9},
 FormatType->"InputForm"],

Cell[BoxData[
 StyleBox["\<\"NaN\"\>", "Text",
  StripOnInput->False]], "Output",
 CellChangeTimes->{
  3.637413667412154*^9, 3.6392494114513073`*^9, 3.6392495852503147`*^9, 
   3.6392497227747154`*^9, {3.6392497746512427`*^9, 3.639249841070924*^9}, 
   3.6392498950314713`*^9, 3.639249943725969*^9, {3.6392500224797673`*^9, 
   3.639250043464984*^9}, 3.6392501702572746`*^9, 3.6392502490640793`*^9, 
   3.6392510500879297`*^9, 3.6392512571810455`*^9, 3.6393074767202034`*^9, 
   3.6393077194359093`*^9, 3.6393077549182687`*^9, 3.6393078458321915`*^9, {
   3.639307885378595*^9, 3.639307922546974*^9}, 3.639307955996315*^9, 
   3.6393079874966354`*^9, {3.6393080811295834`*^9, 3.6393081021227956`*^9}, 
   3.6393081439462247`*^9, 3.6393091448886585`*^9, 3.63930957070321*^9, 
   3.6393097425059643`*^9, 3.639310407037348*^9, 3.639312260926202*^9, 
   3.639313443791994*^9, 3.6393135457497416`*^9, 3.641207415991049*^9, 
   3.642794281422689*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rump", "[", 
   RowBox[{"x_", ",", " ", "y_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"333.75", "*", 
    RowBox[{"y", "^", "6"}]}], " ", "+", " ", 
   RowBox[{
    RowBox[{"x", "^", "2"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"11", "*", 
       RowBox[{"x", "^", "2"}], "*", 
       RowBox[{"y", "^", "2"}]}], " ", "-", " ", 
      RowBox[{"y", "^", "6"}], " ", "-", " ", 
      RowBox[{"121", "*", 
       RowBox[{"y", "^", "4"}]}], " ", "-", " ", "\n", "     ", "2"}], 
     ")"}]}], " ", "+", " ", 
   RowBox[{"5.5", "*", 
    RowBox[{"y", "^", "8"}]}], " ", "+", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"x", "/", "2"}], ")"}], "*", "y"}]}]}], "\n", 
 RowBox[{"rump", "[", 
  RowBox[{"77617", ",", " ", "33096"}], "]"}], "\n", 
 RowBox[{"SetPrecision", "[", 
  RowBox[{
   RowBox[{"rump", "[", 
    RowBox[{"77617", ",", " ", "33096"}], "]"}], ",", " ", "10"}], 
  "]"}], "\n", 
 RowBox[{"SetPrecision", "[", 
  RowBox[{
   RowBox[{"rump", "[", 
    RowBox[{"77617", ",", " ", "33096"}], "]"}], ",", " ", "15"}], 
  "]"}]}], "Input",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.6374137164186525`*^9, 3.6374137164286523`*^9}, {
   3.637414130082186*^9, 3.6374141608494954`*^9}, {3.6374142788646884`*^9, 
   3.6374142882007823`*^9}, {3.6374144810957403`*^9, 3.637414516811099*^9}, {
   3.637414612467064*^9, 3.6374146755516987`*^9}, {3.637414730744278*^9, 
   3.6374147309442797`*^9}, {3.6374147760687413`*^9, 3.6374148650836477`*^9}, 
   3.642794525621646*^9},
 FormatType->"InputForm"],

Cell[BoxData["1.1805916207174113*^21"], "Output",
 CellChangeTimes->{
  3.6374137257027454`*^9, 3.6374142324402184`*^9, 3.637414297334875*^9, 
   3.63741465086145*^9, 3.637414681234756*^9, 3.637414856553563*^9, 
   3.6392494114613075`*^9, 3.639249585260315*^9, 3.639249722794716*^9, {
   3.6392497746712427`*^9, 3.639249794310444*^9}, 3.639249841080924*^9, 
   3.6392498950414715`*^9, {3.6392500224897676`*^9, 3.639250043474984*^9}, 
   3.639250170277275*^9, 3.6392502490740795`*^9, 3.63925105009793*^9, 
   3.639307476730203*^9, 3.6393077194459095`*^9, 3.639307754928269*^9, 
   3.6393078458421917`*^9, {3.6393078853885946`*^9, 3.6393079225569744`*^9}, 
   3.6393079560163155`*^9, 3.6393079875066357`*^9, {3.6393080811395836`*^9, 
   3.6393081021327953`*^9}, 3.639308143966225*^9, 3.6393091448986588`*^9, 
   3.63930957071321*^9, 3.6393097425259643`*^9, 3.6393104070573483`*^9, 
   3.6393122609392033`*^9, 3.6393134438019943`*^9, 3.6393135457697415`*^9, 
   3.641207416247473*^9, 3.642794281441039*^9, 3.6427945259163227`*^9},
 FormatType->"InputForm"],

Cell[BoxData["1.180591620717411303424`10.*^21"], "Output",
 CellChangeTimes->{
  3.6374137257027454`*^9, 3.6374142324402184`*^9, 3.637414297334875*^9, 
   3.63741465086145*^9, 3.637414681234756*^9, 3.637414856553563*^9, 
   3.6392494114613075`*^9, 3.639249585260315*^9, 3.639249722794716*^9, {
   3.6392497746712427`*^9, 3.639249794310444*^9}, 3.639249841080924*^9, 
   3.6392498950414715`*^9, {3.6392500224897676`*^9, 3.639250043474984*^9}, 
   3.639250170277275*^9, 3.6392502490740795`*^9, 3.63925105009793*^9, 
   3.639307476730203*^9, 3.6393077194459095`*^9, 3.639307754928269*^9, 
   3.6393078458421917`*^9, {3.6393078853885946`*^9, 3.6393079225569744`*^9}, 
   3.6393079560163155`*^9, 3.6393079875066357`*^9, {3.6393080811395836`*^9, 
   3.6393081021327953`*^9}, 3.639308143966225*^9, 3.6393091448986588`*^9, 
   3.63930957071321*^9, 3.6393097425259643`*^9, 3.6393104070573483`*^9, 
   3.6393122609392033`*^9, 3.6393134438019943`*^9, 3.6393135457697415`*^9, 
   3.641207416247473*^9, 3.642794281446677*^9, 3.6427945259484158`*^9},
 FormatType->"InputForm"],

Cell[BoxData["1.180591620717411303424`15.*^21"], "Output",
 CellChangeTimes->{
  3.6374137257027454`*^9, 3.6374142324402184`*^9, 3.637414297334875*^9, 
   3.63741465086145*^9, 3.637414681234756*^9, 3.637414856553563*^9, 
   3.6392494114613075`*^9, 3.639249585260315*^9, 3.639249722794716*^9, {
   3.6392497746712427`*^9, 3.639249794310444*^9}, 3.639249841080924*^9, 
   3.6392498950414715`*^9, {3.6392500224897676`*^9, 3.639250043474984*^9}, 
   3.639250170277275*^9, 3.6392502490740795`*^9, 3.63925105009793*^9, 
   3.639307476730203*^9, 3.6393077194459095`*^9, 3.639307754928269*^9, 
   3.6393078458421917`*^9, {3.6393078853885946`*^9, 3.6393079225569744`*^9}, 
   3.6393079560163155`*^9, 3.6393079875066357`*^9, {3.6393080811395836`*^9, 
   3.6393081021327953`*^9}, 3.639308143966225*^9, 3.6393091448986588`*^9, 
   3.63930957071321*^9, 3.6393097425259643`*^9, 3.6393104070573483`*^9, 
   3.6393122609392033`*^9, 3.6393134438019943`*^9, 3.6393135457697415`*^9, 
   3.641207416247473*^9, 3.6427942814941998`*^9, 3.642794526127502*^9},
 FormatType->"InputForm"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rumpu", "[", 
   RowBox[{"xu_", ",", " ", "yu_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"xsqu", " ", "=", " ", 
       RowBox[{"squareu", "[", "xu", "]"}]}], ",", " ", "\n", "    ", 
      RowBox[{"ysqu", " ", "=", " ", 
       RowBox[{"squareu", "[", "yu", "]"}]}], ",", " ", "y4u", ",", " ", 
      "y6u", ",", " ", "y8u"}], "}"}], ",", " ", "\n", "   ", 
    RowBox[{
     RowBox[{"y4u", " ", "=", " ", 
      RowBox[{"powu", "[", 
       RowBox[{"yu", ",", " ", 
        RowBox[{"x2u", "[", "4", "]"}]}], "]"}]}], ";", " ", 
     RowBox[{"y6u", " ", "=", " ", 
      RowBox[{"powu", "[", 
       RowBox[{"yu", ",", " ", 
        RowBox[{"x2u", "[", "6", "]"}]}], "]"}]}], ";", " ", "\n", "    ", 
     RowBox[{"y8u", " ", "=", " ", 
      RowBox[{"powu", "[", 
       RowBox[{"yu", ",", " ", 
        RowBox[{"x2u", "[", "8", "]"}]}], "]"}]}], ";", " ", "\n", "    ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"x2u", "[", "333.75", "]"}], " ", "\[CircleTimes]", " ", 
           "y6u"}], " ", "\[CirclePlus]", " ", 
          RowBox[{"xsqu", " ", "\[CircleTimes]", " ", "\n", "        ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"x2u", "[", "11", "]"}], " ", "\[CircleTimes]", " ",
                   "xsqu"}], ")"}], " ", "\[CircleTimes]", " ", "ysqu"}], " ",
                "\[CircleMinus]", " ", "y6u"}], " ", "\[CircleMinus]", " ", 
              "\n", "          ", 
              RowBox[{
               RowBox[{"x2u", "[", "121", "]"}], " ", "\[CircleTimes]", " ", 
               "y4u"}]}], " ", "\[CircleMinus]", " ", 
             RowBox[{"x2u", "[", "2", "]"}]}], ")"}]}]}], ")"}], " ", 
        "\[CirclePlus]", " ", "\n", "      ", 
        RowBox[{
         RowBox[{"x2u", "[", "5.5", "]"}], " ", "\[CircleTimes]", " ", 
         "y8u"}]}], ")"}], " ", "\[CirclePlus]", " ", 
      RowBox[{"xu", " ", "\[CircleDot]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x2u", "[", "2", "]"}], " ", "\[CircleTimes]", " ", "yu"}], 
        ")"}]}]}]}]}], "]"}]}], "\n", 
 RowBox[{"setenv", "[", 
  RowBox[{"{", 
   RowBox[{"3", ",", " ", "7"}], "}"}], "]"}], "\n", 
 RowBox[{"realwidthtolerance", " ", "=", " ", "0.005"}], "\n", 
 RowBox[{"view", "[", 
  RowBox[{"rumpu", "[", 
   RowBox[{
    RowBox[{"x2u", "[", "77617", "]"}], ",", " ", 
    RowBox[{"x2u", "[", "33096", "]"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.637413764671141*^9, 3.6374140242070303`*^9}, {
   3.637414178446672*^9, 3.6374142068549604`*^9}, {3.6374143475153933`*^9, 
   3.6374143702076225`*^9}, {3.637414931773322*^9, 3.637414939293397*^9}, {
   3.639251121534663*^9, 3.6392511215446634`*^9}, {3.6393077478961983`*^9, 
   3.6393077486262054`*^9}, {3.639307949547249*^9, 3.639307981793577*^9}, 
   3.6427945368552227`*^9, {3.64279458415868*^9, 3.6427945914778957`*^9}},
 FormatType->"InputForm"],

Cell[BoxData["0.005`"], "Output",
 CellChangeTimes->{
  3.6374140625404153`*^9, {3.6374143535084553`*^9, 3.6374143721196423`*^9}, 
   3.6392493124792967`*^9, 3.639249411481308*^9, 3.6392495852803144`*^9, {
   3.639249774691243*^9, 3.639249794320444*^9}, 3.6392498411009245`*^9, 
   3.639249895061472*^9, {3.6392500225197678`*^9, 3.6392500434949846`*^9}, 
   3.639250170287275*^9, 3.6392502490940795`*^9, 3.6392510501179304`*^9, 
   3.6393074767602034`*^9, 3.6393077194659095`*^9, 3.639307754948269*^9, 
   3.639307845872192*^9, {3.639307885408595*^9, 3.639307922596975*^9}, 
   3.6393079560363154`*^9, 3.639307987536636*^9, {3.639308081159584*^9, 
   3.639308102152796*^9}, 3.639308143986225*^9, 3.639309144918659*^9, 
   3.63930957073321*^9, 3.6393097425359645`*^9, 3.6393104070673485`*^9, 
   3.639312260958205*^9, 3.6393134438219943`*^9, 3.6393135457797413`*^9, 
   3.641207416299616*^9, 3.642794281710198*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part \[NoBreak]\\!\\(2\\)\[NoBreak] of \
\[NoBreak]\\!\\(demotee[\\(\\({680564733841876926926749214863536423934, 2047}\
\\)\\)]\\)\[NoBreak] does not exist. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partw\\\", \
ButtonNote -> \\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.639307987886639*^9, {3.6393080815295877`*^9, 3.6393081025048003`*^9}, 
   3.6393081443462286`*^9, 3.639309145288663*^9, 3.6393095711032143`*^9, 
   3.6393097429059677`*^9, 3.639310407427352*^9, 3.6393122613392415`*^9, 
   3.639313444171998*^9, 3.639313546149745*^9, 3.641207416545725*^9, 
   3.642794281885106*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part \[NoBreak]\\!\\(2\\)\[NoBreak] of \
\[NoBreak]\\!\\(demotee[\\(\\({\[Infinity], \\(\\(-1\\)\\)}\\)\\)]\\)\
\[NoBreak] does not exist. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partw\\\", ButtonNote -> \
\\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.639307987886639*^9, {3.6393080815295877`*^9, 3.6393081025048003`*^9}, 
   3.6393081443462286`*^9, 3.639309145288663*^9, 3.6393095711032143`*^9, 
   3.6393097429059677`*^9, 3.639310407427352*^9, 3.6393122613392415`*^9, 
   3.639313444171998*^9, 3.639313546149745*^9, 3.641207416545725*^9, 
   3.642794281999198*^9}],

Cell[BoxData[
 TemplateBox[{StyleBox["\"(\"", "Text", StripOnInput -> False],TemplateBox[{
     StyleBox[
      TemplateBox[{"\"\[Dash]\"", 
        TemplateBox[{
         "0", "\".\"", 
          "\"82739605994682136814116509547981629199961134421172911652857538768\
50972371173219686748927237385231592270429246127605438232421875\""}, 
         "RowDefault"]}, "RowDefault"], "Text", StripOnInput -> False], 
     StyleBox["\", \"", "Text", StripOnInput -> False]}, "RowDefault"],
   StyleBox[
    TemplateBox[{"\"\[Dash]\"", 
      TemplateBox[{
       "0", "\".\"", 
        "\"8273960599468213681411650954798162919966726083346733977586535463420\
4162292277530478296250493475127996134688146412372589111328125\""}, 
       "RowDefault"]}, "RowDefault"], "Text", StripOnInput -> False],StyleBox[
   "\")\"", "Text", StripOnInput -> False]},
  "RowDefault"]], "Output",
 CellChangeTimes->{
  3.6374140625404153`*^9, {3.6374143535084553`*^9, 3.6374143721196423`*^9}, 
   3.6392493124792967`*^9, 3.639249411481308*^9, 3.6392495852803144`*^9, {
   3.639249774691243*^9, 3.639249794320444*^9}, 3.6392498411009245`*^9, 
   3.639249895061472*^9, {3.6392500225197678`*^9, 3.6392500434949846`*^9}, 
   3.639250170287275*^9, 3.6392502490940795`*^9, 3.6392510501179304`*^9, 
   3.6393074767602034`*^9, 3.6393077194659095`*^9, 3.639307754948269*^9, 
   3.639307845872192*^9, {3.639307885408595*^9, 3.639307922596975*^9}, 
   3.6393079560363154`*^9, 3.639307987536636*^9, {3.639308081159584*^9, 
   3.639308102152796*^9}, 3.639308143986225*^9, 3.639309144918659*^9, 
   3.63930957073321*^9, 3.6393097425359645`*^9, 3.6393104070673485`*^9, 
   3.639312260958205*^9, 3.6393134438219943`*^9, 3.6393135457797413`*^9, 
   3.641207416299616*^9, 3.642794282004877*^9}]
}, Open  ]]
},
ScreenStyleEnvironment->"Printout",
WindowSize->{741, 836},
WindowMargins->{{69, Automatic}, {43, Automatic}},
PrintingCopies->1,
PrintingStartingPageNumber->1,
PrintingPageRange->{45, 46},
PageHeaders->{{None, 
   Cell[
    TextData[{
      StyleBox[
       CounterBox["Page"], "PageNumber"], 
      StyleBox["   ", "Header"], 
      StyleBox["|", "Header"], 
      StyleBox[" ", "Header"], 
      StyleBox[
       RowBox[{"The", " ", "End", " ", "of", " ", "Error"}], "Header"]}], 
    "Header"], None}, {None, 
   Cell[
    TextData[
     StyleBox[
      RowBox[{
        StyleBox["A", "Header"], 
        StyleBox[" ", "Header"], 
        StyleBox["New", "Header"], 
        StyleBox[" ", "Header"], "Number", " ", "Format", ":", " ", "The", 
        " ", "Unum", "  ", "|", "   ", 
        StyleBox[
         CounterBox["Page"], "PageNumber"]}], "Header"]], "Header"], None}},
PageFooters->{{None, None, None}, {None, None, None}},
PageHeaderLines->{False, False},
PageFooterLines->{False, False},
PrintingOptions->{"FacingPages"->True,
"FirstPageFace"->Right,
"FirstPageFooter"->True,
"FirstPageHeader"->False,
"PageFooterMargins"->{18, 18},
"PageHeaderMargins"->{30, 30},
"PageSize"->{504, 720},
"PrintCellBrackets"->False,
"PrintMultipleHorizontalPages"->False,
"PrintRegistrationMarks"->True,
"PrintingMargins"->{{30, 30}, {55, 54}}},
ShowSelection->True,
Hyphenation->True,
HyphenationOptions->{"HyphenationMinLengths"->{5, 5}},
Magnification:>1.5 Inherited,
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"], 
    CellMargins -> {{24, Inherited}, {Inherited, Inherited}}], 
   Cell[
    StyleData["Title"], CellMargins -> {{37, Inherited}, {10, 30}}, 
    FontFamily -> "Palatino", FontColor -> RGBColor[0.666667, 0, 0]], 
   Cell[
    StyleData["Subtitle"], CellMargins -> {{37, Inherited}, {20, 2}}, 
    FontFamily -> "Palatino"], 
   Cell[
    StyleData["Section"], CellMargins -> {{41, Inherited}, {8, 34}}, 
    TextJustification -> 0., FontFamily -> "Palatino", FontSize -> 24, 
    FontWeight -> "Plain", FontSlant -> "Plain", FontColor -> 
    RGBColor[0.666667, 0, 0]], 
   Cell[
    StyleData["Text"], CellMargins -> {{49, Inherited}, {7, 7}}], 
   Cell[
    StyleData["Subsection"], TextJustification -> 0., FontFamily -> 
    "Palatino", FontColor -> RGBColor[0.666667, 0, 0]], 
   Cell[
    StyleData["Subsubsection"], CellMargins -> {{49, Inherited}, {2, 10}}, 
    TextJustification -> 0., FontFamily -> "Palatino", FontSize -> 18, 
    FontWeight -> "Plain", FontSlant -> "Plain", FontColor -> 
    RGBColor[0.666667, 0, 0]], 
   Cell[
    StyleData["Program"], Evaluatable -> True, TextJustification -> 0., 
    FontWeight -> "Bold", Background -> RGBColor[0.88, 1, 0.88]]}, Visible -> 
  False, FrontEndVersion -> "9.0 for Linux x86 (64-bit) (February 7, 2013)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 331722, 8344, 18757, "Input",
 InitializationCell->True],
Cell[332282, 8366, 151182, 3811, 8149, "Input",
 InitializationCell->True],
Cell[483467, 12179, 382, 8, 42, "Input"],
Cell[CellGroupData[{
Cell[483874, 12191, 435, 8, 99, "Input"],
Cell[484312, 12201, 254, 3, 29, "Output"],
Cell[484569, 12206, 250, 3, 29, "Output"],
Cell[484822, 12211, 242, 3, 29, "Output"],
Cell[485067, 12216, 292, 5, 29, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[485396, 12226, 157, 3, 30, "Input"],
Cell[485556, 12231, 5213, 138, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[490806, 12374, 546, 11, 121, "Input"],
Cell[491355, 12387, 930, 14, 29, "Output"],
Cell[492288, 12403, 907, 13, 29, "Output"],
Cell[493198, 12418, 906, 13, 29, "Output"],
Cell[494107, 12433, 909, 13, 29, "Output"],
Cell[495019, 12448, 5180, 138, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[500236, 12591, 362, 8, 30, "Input"],
Cell[500601, 12601, 934, 15, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[501572, 12621, 366, 8, 30, "Input"],
Cell[501941, 12631, 930, 15, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[502908, 12651, 437, 9, 30, "Input"],
Cell[503348, 12662, 945, 15, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[504330, 12682, 1567, 42, 117, "Input"],
Cell[505900, 12726, 1053, 15, 29, "Output"],
Cell[506956, 12743, 1062, 15, 29, "Output"],
Cell[508021, 12760, 1062, 15, 29, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[509120, 12780, 3157, 74, 222, "Input"],
Cell[512280, 12856, 913, 13, 29, "Output"],
Cell[513196, 12871, 830, 16, 45, "Message"],
Cell[514029, 12889, 812, 16, 24, "Message"],
Cell[514844, 12907, 1748, 31, 158, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
